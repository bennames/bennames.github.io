

<!doctype html>


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>AeroComBAT.Structures &mdash; AeroComBAT 1.0 documentation</title>
    
    <link rel="stylesheet" href="../../_static/bizstyle.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../',
        VERSION:     '1.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    <script type="text/javascript" src="../../_static/bizstyle.js"></script>
    <link rel="top" title="AeroComBAT 1.0 documentation" href="../../index.html" />
    <link rel="up" title="Module code" href="../index.html" />
    <meta name="viewport" content="width=device-width,initial-scale=1.0">
    <!--[if lt IE 9]>
    <script type="text/javascript" src="_static/css3-mediaqueries.js"></script>
    <![endif]-->
  </head>
  <body role="document">
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../index.html">AeroComBAT 1.0 documentation</a> &raquo;</li>
          <li class="nav-item nav-item-1"><a href="../index.html" accesskey="U">Module code</a> &raquo;</li> 
      </ul>
    </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <h1>Source code for AeroComBAT.Structures</h1><div class="highlight"><pre>
<span class="c"># structures.py</span>
<span class="c"># Author: Ben Names</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">This module contains a library of classes devoted to structural analysis.</span>

<span class="sd">The primary purpose of this library is to fascilitate the ROM (reduced order</span>
<span class="sd">modeling) of structures that can simplified to beams. The real power of this</span>
<span class="sd">library comes from it&#39;s the XSect class. This class can create and analyze</span>
<span class="sd">a cross-section, allowing the user to accurately model a nonhomogeneous</span>
<span class="sd">(made of multiple materials) anisotropic (materials that behave anisotropically</span>
<span class="sd">such as composites) complex cross-sections.</span>

<span class="sd">It should be noted that classes are ordered by model complexity. The further</span>
<span class="sd">down the structures.py library, the more complex the objects, often requiring</span>
<span class="sd">multiple of their predecessors. For example, the CQUADX class requires four</span>
<span class="sd">node objects and a material object.</span>

<span class="sd">:SUMARRY OF THE CLASSES:</span>

<span class="sd">- `Node`: Creates a node object with 3D position.</span>
<span class="sd">- `Material`: Creates a material object, generating the 3D constitutive relations.</span>
<span class="sd">- `MicroMechanics`: Class to fascilitate the calculation of composite stiffnesses</span>
<span class="sd">    using micro-mechanical models where fibers are long and continuous.</span>
<span class="sd">- `CQUADX`: Creates a 2D linear quadrilateral element, mainly used to fascilitate\</span>
<span class="sd">    cross-sectional analysis, this class could be modified in future updates</span>
<span class="sd">    such that they could also be used to create plate or laminate element</span>
<span class="sd">    objects as well.</span>
<span class="sd">- `MaterialLib`: Creates a material library object meant to hold many material</span>
<span class="sd">    objects.</span>
<span class="sd">- `Ply`: Creates ply objects which are used in the building of a laminate object.</span>
<span class="sd">- `Laminate`: Creates laminate objects which could be used for CLT (classical</span>
<span class="sd">    lamination theory) analysis as well as to be used in building a beam</span>
<span class="sd">    cross-section.</span>
<span class="sd">- `XSect`: Creates a cross-section object which can be used in the ROM of a beam</span>
<span class="sd">    with a non-homogeneous anisotropic cross-section. Currently only supports</span>
<span class="sd">    simple box beam cross-section (i.e., four laminates joined together to form</span>
<span class="sd">    a box), however outer mold lines can take the shape of airfoil profiles.</span>
<span class="sd">    See the Airfoil class in AircraftParts.py for more info.</span>
<span class="sd">- `TBeam`: Creates a single Timoshenko beam object for FEA.</span>
<span class="sd">- `SuperBeam`: Creates a super beam object. This class is mainly used to automate</span>
<span class="sd">    the creation of many connected TBeam objects to be used late for FEA.</span>
<span class="sd">- `WingSection`: A class which creates and holds many super beams, each of which</span>
<span class="sd">    could have different cross-sections. It also helps to dimensionalize</span>
<span class="sd">    plates for simple closed-form composite buckling load aproximations.</span>


<span class="sd">.. Note:: Currently the inclusion of thermal strains are not supported for any</span>
<span class="sd">    structural model.</span>
<span class="sd">    </span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="n">__docformat__</span> <span class="o">=</span> <span class="s">&#39;restructuredtext&#39;</span>
<span class="c"># =============================================================================</span>
<span class="c"># AeroComBAT MODULES</span>
<span class="c"># =============================================================================</span>
<span class="kn">from</span> <span class="nn">Utilities</span> <span class="kn">import</span> <span class="n">RotationHelper</span>
<span class="kn">from</span> <span class="nn">Aerodynamics</span> <span class="kn">import</span> <span class="n">Airfoil</span>
<span class="c"># =============================================================================</span>
<span class="c"># IMPORT ANACONDA ASSOCIATED MODULES</span>
<span class="c"># =============================================================================</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">scipy</span> <span class="kn">as</span> <span class="nn">sci</span>
<span class="kn">from</span> <span class="nn">tabulate</span> <span class="kn">import</span> <span class="n">tabulate</span>
<span class="kn">import</span> <span class="nn">mayavi.mlab</span> <span class="kn">as</span> <span class="nn">mlab</span>
<span class="c"># =============================================================================</span>
<span class="c"># IMPORT PYTHON MODULES</span>
<span class="c"># =============================================================================</span>
<span class="kn">import</span> <span class="nn">collections</span> <span class="kn">as</span> <span class="nn">coll</span>
<span class="c"># =============================================================================</span>
<span class="c"># DEFINE AeroComBAT STRUCTURES CLASSES</span>
<span class="c"># =============================================================================</span>
<div class="viewcode-block" id="Node"><a class="viewcode-back" href="../../structures.html#AeroComBAT.Structures.Node">[docs]</a><span class="k">class</span> <span class="nc">Node</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Creates a node object.</span>
<span class="sd">    </span>
<span class="sd">    Node objects could be used in any finite element implementation.</span>
<span class="sd">    </span>
<span class="sd">    :Attributes:</span>
<span class="sd">    </span>
<span class="sd">    - `NID (int)`: The integer identifier given to the object.</span>
<span class="sd">    - `x (Array[float])`: An array containing the 3 x-y-z coordinates of the</span>
<span class="sd">        node.</span>
<span class="sd">    - `summary (str)`: A string which is a tabulated respresentation and</span>
<span class="sd">        summary of the important attributes of the object.</span>
<span class="sd">        </span>
<span class="sd">    :Methods:</span>
<span class="sd">    </span>
<span class="sd">    - `printSummary`: This method prints out basic information about the node</span>
<span class="sd">        object, such as it&#39;s node ID and it&#39;s x-y-z coordinates</span>
<span class="sd">        </span>
<span class="sd">    &quot;&quot;&quot;</span>
<div class="viewcode-block" id="Node.__init__"><a class="viewcode-back" href="../../structures.html#AeroComBAT.Structures.Node.__init__">[docs]</a>    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">NID</span><span class="p">,</span><span class="n">x</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Initializes the node object.</span>
<span class="sd">        </span>
<span class="sd">        :Args:</span>
<span class="sd">        </span>
<span class="sd">        - `nid (int)`: The desired integer node ID</span>
<span class="sd">        - `x (Array[float])`: The position of the node in 3D space.</span>
<span class="sd">            </span>
<span class="sd">        :Returns:</span>
<span class="sd">        </span>
<span class="sd">        - None</span>
<span class="sd">        </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c"># Verify that a correct NID was given</span>
        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">NID</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">int</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">NID</span> <span class="o">=</span> <span class="n">NID</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s">&#39;The node ID given was not an integer.&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">==</span><span class="mi">3</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s">&quot;An array of length 3 is required to create a &quot;</span><span class="o">+</span>
                <span class="s">&quot;node object.&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">x</span>
        <span class="c"># Initialize the summary info:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">summary</span> <span class="o">=</span> <span class="n">tabulate</span><span class="p">(([[</span><span class="bp">self</span><span class="o">.</span><span class="n">NID</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">x</span><span class="p">]]),(</span><span class="s">&#39;NID&#39;</span><span class="p">,</span><span class="s">&#39;Coordinates&#39;</span><span class="p">))</span></div>
<div class="viewcode-block" id="Node.printSummary"><a class="viewcode-back" href="../../structures.html#AeroComBAT.Structures.Node.printSummary">[docs]</a>    <span class="k">def</span> <span class="nf">printSummary</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Prints basic information about the node.</span>
<span class="sd">        </span>
<span class="sd">        The printSummary method prints out basic node attributes in an organized</span>
<span class="sd">        fashion. This includes the node ID and x-y-z global coordinates.</span>
<span class="sd">        </span>
<span class="sd">        :Args:</span>
<span class="sd">        </span>
<span class="sd">        - None</span>
<span class="sd">            </span>
<span class="sd">        :Returns:</span>
<span class="sd">        </span>
<span class="sd">        - A printed table including the node ID and it&#39;s coordinates</span>
<span class="sd">            </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">print</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">summary</span><span class="p">)</span>
</div></div>
<div class="viewcode-block" id="Material"><a class="viewcode-back" href="../../structures.html#AeroComBAT.Structures.Material">[docs]</a><span class="k">class</span> <span class="nc">Material</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;creates a linear elastic material object.</span>
<span class="sd">    </span>
<span class="sd">    This class creates a material object which can be stored within a</span>
<span class="sd">    material library object. The material can be in general orthotropic.</span>
<span class="sd">    </span>
<span class="sd">    :Attributes:</span>
<span class="sd">    </span>
<span class="sd">    - `name (str)`: A name for the material.</span>
<span class="sd">    - `MID (int)`: An integer identifier for the material.</span>
<span class="sd">    - `matType (str)`: A string expressing what type of material it is.</span>
<span class="sd">        Currently, the supported materials are isotropic, transversely</span>
<span class="sd">        isotropic, and orthotropic.</span>
<span class="sd">    - `summary (str)`: A string which is a tabulated respresentation and</span>
<span class="sd">        summary of the important attributes of the object.</span>
<span class="sd">    - `t (float)`: A single float which represents the thickness of a ply if</span>
<span class="sd">        the material is to be used in a composite.</span>
<span class="sd">    - `rho (float)`: A single float which represents the density of the</span>
<span class="sd">        materials.</span>
<span class="sd">    - `Smat (6x6 numpy Array[float])`: A numpy array representing the</span>
<span class="sd">        compliance matrix in the fiber coordinate system.*</span>
<span class="sd">    - `Cmat (6x6 numpy Array[float])`: A numpy array representing the</span>
<span class="sd">        stiffness matrix in the fiber coordinate system.*</span>
<span class="sd">        </span>
<span class="sd">    :Methods:</span>
<span class="sd">    </span>
<span class="sd">    - `printSummary`: This method prints out basic information about the</span>
<span class="sd">        material, including the type, the material constants, material</span>
<span class="sd">        thickness, as well as the tabulated stiffness or compliance</span>
<span class="sd">        matricies if requested.</span>
<span class="sd">        </span>
<span class="sd">    .. Note:: The CQUADX element assumes that the fibers are oriented along</span>
<span class="sd">        the (1,0,0) in the global coordinate system.</span>
<span class="sd">        </span>
<span class="sd">    &quot;&quot;&quot;</span> <span class="c"># why is thickness defined in material and not ply?</span>
<div class="viewcode-block" id="Material.__init__"><a class="viewcode-back" href="../../structures.html#AeroComBAT.Structures.Material.__init__">[docs]</a>    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">MID</span><span class="p">,</span><span class="n">name</span><span class="p">,</span><span class="n">matType</span><span class="p">,</span><span class="n">mat_constants</span><span class="p">,</span><span class="n">mat_t</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Creates a material object</span>
<span class="sd">        </span>
<span class="sd">        The main purpose of this class is assembling the constitutive</span>
<span class="sd">        relations. Regardless of the analysis</span>
<span class="sd">            </span>
<span class="sd">        </span>
<span class="sd">        :Args:</span>
<span class="sd">        </span>
<span class="sd">        - `MID (int)`: Material ID.</span>
<span class="sd">        - `name (str)`: Name of the material.</span>
<span class="sd">        - `matType (str)`: The type of the material. Supported material types</span>
<span class="sd">            are &quot;iso&quot;, &quot;trans_iso&quot;, and &quot;ortho&quot;.</span>
<span class="sd">        - `mat_constants (1xX Array[Float])`: The requisite number of material</span>
<span class="sd">            constants required for any structural analysis. Note, this</span>
<span class="sd">            array includes the material density. For example, an isotropic</span>
<span class="sd">            material needs 2 elastic material constants, so the total</span>
<span class="sd">            length of mat_constants would be 3, 2 elastic constants and the</span>
<span class="sd">            density.</span>
<span class="sd">        - `mat_t (float)`: The thickness of 1-ply of the material</span>
<span class="sd">        - `th (1x3 Array[float])`: The angles about which the material can be</span>
<span class="sd">            rotated when it is initialized. In degrees.</span>
<span class="sd">            </span>
<span class="sd">        </span>
<span class="sd">        :Returns:</span>
<span class="sd">        </span>
<span class="sd">        - None</span>
<span class="sd">            </span>
<span class="sd">        .. Note:: While this class supports material direction rotations, it is more</span>
<span class="sd">            robust to simply let the CQUADX and Mesher class handle all material</span>
<span class="sd">            rotations.</span>
<span class="sd">            </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c"># Initialize rotation of the material in the global CSYS</span>
        <span class="n">th</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s">&#39;th&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
        <span class="c"># Initialize Material Name</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">name</span>
        <span class="c"># Material identification</span>
        <span class="c"># Error checking to verify ID is of type int</span>
        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">MID</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">int</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">MID</span> <span class="o">=</span> <span class="n">MID</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s">&#39;The material ID given was not an integer&#39;</span><span class="p">)</span> <span class="c">#repeats</span>
        <span class="c"># Material Type(string) - isotropic, transversely isotropic, otrthotropic</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">matType</span> <span class="o">=</span> <span class="n">matType</span>
        <span class="c"># Material Constants(array if floats) - depends on matType</span>
        <span class="n">saved_mat_const</span> <span class="o">=</span> <span class="p">[]</span>
        
        <span class="c"># ISOTROPIC MATERIAL</span>
        <span class="k">if</span> <span class="n">matType</span><span class="o">==</span><span class="s">&#39;iso&#39;</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">mat_constants</span><span class="p">)</span><span class="o">==</span><span class="mi">3</span><span class="p">:</span>
            <span class="c"># mat_constants expected = [E, nu, rho]</span>
            <span class="n">E</span> <span class="o">=</span> <span class="n">mat_constants</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">nu</span> <span class="o">=</span> <span class="n">mat_constants</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
            <span class="n">rho</span> <span class="o">=</span> <span class="n">mat_constants</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
            <span class="n">G</span> <span class="o">=</span> <span class="n">E</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">nu</span><span class="p">))</span>
            <span class="n">saved_mat_const</span> <span class="o">=</span> <span class="p">[</span><span class="n">E</span><span class="p">,</span> <span class="n">E</span><span class="p">,</span> <span class="n">E</span><span class="p">,</span> <span class="n">nu</span><span class="p">,</span> <span class="n">nu</span><span class="p">,</span> <span class="n">nu</span><span class="p">,</span> <span class="n">G</span><span class="p">,</span> <span class="n">G</span><span class="p">,</span> <span class="n">G</span><span class="p">,</span> <span class="n">rho</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">summary</span> <span class="o">=</span> <span class="n">tabulate</span><span class="p">([[</span><span class="n">MID</span><span class="p">,</span><span class="s">&#39;iso&#39;</span><span class="p">,</span><span class="n">E</span><span class="p">,</span><span class="n">nu</span><span class="p">,</span><span class="n">G</span><span class="p">,</span><span class="n">rho</span><span class="p">]],</span>\
            <span class="p">(</span><span class="s">&#39;MID&#39;</span><span class="p">,</span><span class="s">&#39;Type&#39;</span><span class="p">,</span><span class="s">&#39;E(Pa)&#39;</span><span class="p">,</span><span class="s">&#39;nu&#39;</span><span class="p">,</span><span class="s">&#39;G(Pa)&#39;</span><span class="p">,</span><span class="s">&#39;rho, kg/m^3&#39;</span><span class="p">),</span><span class="n">tablefmt</span><span class="o">=</span><span class="s">&quot;fancy_grid&quot;</span><span class="p">)</span>
        
        <span class="c"># TRANSVERSELY ISOTROPIC MATERIAL</span>
        <span class="k">elif</span> <span class="n">matType</span><span class="o">==</span><span class="s">&#39;trans_iso&#39;</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">mat_constants</span><span class="p">)</span><span class="o">==</span><span class="mi">6</span><span class="p">:</span>
            <span class="c"># mat_constants expected = [E1, E2, nu_23, nu_12, G_12, rho]</span>
            <span class="n">E1</span> <span class="o">=</span> <span class="n">mat_constants</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">E2</span> <span class="o">=</span> <span class="n">mat_constants</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
            <span class="n">nu_23</span> <span class="o">=</span> <span class="n">mat_constants</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
            <span class="n">nu_12</span> <span class="o">=</span> <span class="n">mat_constants</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>
            <span class="n">G_12</span> <span class="o">=</span> <span class="n">mat_constants</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span>
            <span class="n">G_23</span> <span class="o">=</span> <span class="n">E2</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">nu_23</span><span class="p">))</span>
            <span class="n">rho</span> <span class="o">=</span> <span class="n">mat_constants</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span>
            <span class="n">saved_mat_const</span> <span class="o">=</span> <span class="p">[</span><span class="n">E1</span><span class="p">,</span> <span class="n">E2</span><span class="p">,</span> <span class="n">E2</span><span class="p">,</span> <span class="n">nu_23</span><span class="p">,</span> <span class="n">nu_12</span><span class="p">,</span> <span class="n">nu_12</span><span class="p">,</span> <span class="n">G_23</span><span class="p">,</span> <span class="n">G_12</span><span class="p">,</span> <span class="n">G_12</span><span class="p">,</span> <span class="n">rho</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">summary</span> <span class="o">=</span> <span class="n">tabulate</span><span class="p">([[</span><span class="n">MID</span><span class="p">,</span><span class="s">&#39;trans_iso&#39;</span><span class="p">,</span><span class="n">E1</span><span class="p">,</span><span class="n">E2</span><span class="p">,</span><span class="n">nu_23</span><span class="p">,</span><span class="n">nu_12</span><span class="p">,</span><span class="n">G_23</span><span class="p">,</span><span class="n">G_12</span><span class="p">,</span><span class="n">rho</span><span class="p">]],</span>\
            <span class="p">(</span><span class="s">&#39;MID&#39;</span><span class="p">,</span><span class="s">&#39;Type&#39;</span><span class="p">,</span><span class="s">&#39;E1(Pa)&#39;</span><span class="p">,</span><span class="s">&#39;E2(Pa)&#39;</span><span class="p">,</span><span class="s">&#39;nu_23&#39;</span><span class="p">,</span><span class="s">&#39;nu_12&#39;</span><span class="p">,</span><span class="s">&#39;G_23(Pa)&#39;</span><span class="p">,</span><span class="s">&#39;G_12(Pa)&#39;</span><span class="p">,</span>\
            <span class="s">&#39;rho, kg/m^3&#39;</span><span class="p">),</span><span class="n">tablefmt</span><span class="o">=</span><span class="s">&quot;fancy_grid&quot;</span><span class="p">)</span>
        
        <span class="c"># ORTHOTROPIC MATERIAL</span>
        <span class="k">elif</span> <span class="n">matType</span><span class="o">==</span><span class="s">&#39;ortho&#39;</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">mat_constants</span><span class="p">)</span><span class="o">==</span><span class="mi">10</span><span class="p">:</span>
            <span class="c"># mat_constants expected = [E1,E2,E3,nu_23,nu_13,nu_12,G_23,G_13,G_12,rho]</span>
            <span class="n">saved_mat_const</span> <span class="o">=</span> <span class="n">mat_constants</span> <span class="c">#re-order</span>
            <span class="n">E1</span> <span class="o">=</span> <span class="n">mat_constants</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">E2</span> <span class="o">=</span> <span class="n">mat_constants</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
            <span class="n">E3</span> <span class="o">=</span> <span class="n">mat_constants</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
            <span class="n">nu_23</span> <span class="o">=</span> <span class="n">mat_constants</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>
            <span class="n">nu_13</span> <span class="o">=</span> <span class="n">mat_constants</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span>
            <span class="n">nu_12</span> <span class="o">=</span> <span class="n">mat_constants</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span>
            <span class="n">G_23</span> <span class="o">=</span> <span class="n">mat_constants</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span>
            <span class="n">G_13</span> <span class="o">=</span> <span class="n">mat_constants</span><span class="p">[</span><span class="mi">7</span><span class="p">]</span>
            <span class="n">G_12</span> <span class="o">=</span> <span class="n">mat_constants</span><span class="p">[</span><span class="mi">8</span><span class="p">]</span>
            <span class="n">rho</span> <span class="o">=</span> <span class="n">mat_constants</span><span class="p">[</span><span class="mi">9</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">summary</span> <span class="o">=</span> <span class="n">tabulate</span><span class="p">([[</span><span class="n">MID</span><span class="p">,</span><span class="s">&#39;ortho&#39;</span><span class="p">,</span><span class="n">E1</span><span class="p">,</span><span class="n">E2</span><span class="p">,</span><span class="n">E3</span><span class="p">,</span><span class="n">nu_23</span><span class="p">,</span><span class="n">nu_13</span><span class="p">,</span><span class="n">nu_12</span><span class="p">,</span><span class="n">G_23</span><span class="p">,</span><span class="n">G_13</span><span class="p">,</span><span class="n">G_12</span><span class="p">,</span><span class="n">rho</span><span class="p">]],</span>\
            <span class="p">(</span><span class="s">&#39;MID&#39;</span><span class="p">,</span><span class="s">&#39;Type&#39;</span><span class="p">,</span><span class="s">&#39;E1(Pa)&#39;</span><span class="p">,</span><span class="s">&#39;E2(Pa)&#39;</span><span class="p">,</span><span class="s">&#39;E3(Pa)&#39;</span><span class="p">,</span><span class="s">&#39;nu_23&#39;</span><span class="p">,</span><span class="s">&#39;nu_13&#39;</span><span class="p">,</span><span class="s">&#39;nu_12&#39;</span><span class="p">,</span>\
            <span class="s">&#39;G_23(Pa)&#39;</span><span class="p">,</span><span class="s">&#39;G_13(Pa)&#39;</span><span class="p">,</span><span class="s">&#39;G_12(Pa)&#39;</span><span class="p">,</span><span class="s">&#39;rho, kg/m^3&#39;</span><span class="p">),</span><span class="n">tablefmt</span><span class="o">=</span><span class="s">&quot;fancy_grid&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s">&#39;Material </span><span class="si">%s</span><span class="s"> was not entered correctly. Possible&#39;</span>\
            <span class="o">+</span><span class="s">&#39;material types include &quot;iso&quot;, &quot;trans_iso&quot;, or &quot;ortho.&quot; In&#39;</span>\
            <span class="o">+</span><span class="s">&#39;addition, mat_constants must then be of length 3,6, or 10&#39;</span>\
            <span class="o">+</span><span class="s">&#39;respectively. Refer to documentation for more clarification.&#39;</span><span class="p">)</span>
        <span class="c"># Store material constants such that:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">E1</span> <span class="o">=</span> <span class="n">saved_mat_const</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">E2</span> <span class="o">=</span> <span class="n">saved_mat_const</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">E3</span> <span class="o">=</span> <span class="n">saved_mat_const</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">nu_23</span> <span class="o">=</span> <span class="n">saved_mat_const</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">nu_13</span> <span class="o">=</span> <span class="n">saved_mat_const</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">nu_12</span> <span class="o">=</span> <span class="n">saved_mat_const</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">G_23</span> <span class="o">=</span> <span class="n">saved_mat_const</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">G_13</span> <span class="o">=</span> <span class="n">saved_mat_const</span><span class="p">[</span><span class="mi">7</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">G_12</span> <span class="o">=</span> <span class="n">saved_mat_const</span><span class="p">[</span><span class="mi">8</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">rho</span> <span class="o">=</span> <span class="n">saved_mat_const</span><span class="p">[</span><span class="mi">9</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">t</span> <span class="o">=</span> <span class="n">mat_t</span>
        
        <span class="c"># Initialize the compliance matrix in the local fiber 123 CSYS:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Smat</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mf">1.</span><span class="o">/</span><span class="bp">self</span><span class="o">.</span><span class="n">E1</span><span class="p">,</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">nu_12</span><span class="o">/</span><span class="bp">self</span><span class="o">.</span><span class="n">E1</span><span class="p">,</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">nu_13</span><span class="o">/</span><span class="bp">self</span><span class="o">.</span><span class="n">E1</span><span class="p">,</span><span class="mf">0.</span><span class="p">,</span><span class="mf">0.</span><span class="p">,</span><span class="mf">0.</span><span class="p">],</span>\
                                     <span class="p">[</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">nu_12</span><span class="o">/</span><span class="bp">self</span><span class="o">.</span><span class="n">E1</span><span class="p">,</span><span class="mf">1.</span><span class="o">/</span><span class="bp">self</span><span class="o">.</span><span class="n">E2</span><span class="p">,</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">nu_23</span><span class="o">/</span><span class="bp">self</span><span class="o">.</span><span class="n">E2</span><span class="p">,</span><span class="mf">0.</span><span class="p">,</span><span class="mf">0.</span><span class="p">,</span><span class="mf">0.</span><span class="p">],</span>\
                                     <span class="p">[</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">nu_13</span><span class="o">/</span><span class="bp">self</span><span class="o">.</span><span class="n">E1</span><span class="p">,</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">nu_23</span><span class="o">/</span><span class="bp">self</span><span class="o">.</span><span class="n">E2</span><span class="p">,</span><span class="mf">1.</span><span class="o">/</span><span class="bp">self</span><span class="o">.</span><span class="n">E3</span><span class="p">,</span><span class="mf">0.</span><span class="p">,</span><span class="mf">0.</span><span class="p">,</span><span class="mf">0.</span><span class="p">],</span>\
                                     <span class="p">[</span><span class="mf">0.</span><span class="p">,</span><span class="mf">0.</span><span class="p">,</span><span class="mf">0.</span><span class="p">,</span><span class="mf">1.</span><span class="o">/</span><span class="bp">self</span><span class="o">.</span><span class="n">G_23</span><span class="p">,</span><span class="mf">0.</span><span class="p">,</span><span class="mf">0.</span><span class="p">],</span>\
                                     <span class="p">[</span><span class="mf">0.</span><span class="p">,</span><span class="mf">0.</span><span class="p">,</span><span class="mf">0.</span><span class="p">,</span><span class="mf">0.</span><span class="p">,</span><span class="mf">1.</span><span class="o">/</span><span class="bp">self</span><span class="o">.</span><span class="n">G_13</span><span class="p">,</span><span class="mf">0.</span><span class="p">],</span>\
                                     <span class="p">[</span><span class="mf">0.</span><span class="p">,</span><span class="mf">0.</span><span class="p">,</span><span class="mf">0.</span><span class="p">,</span><span class="mf">0.</span><span class="p">,</span><span class="mf">0.</span><span class="p">,</span><span class="mf">1.</span><span class="o">/</span><span class="bp">self</span><span class="o">.</span><span class="n">G_12</span><span class="p">]])</span>
        <span class="c"># Rotate the compliance matrix to the local x-sect csys if the material</span>
        <span class="c"># is to be used for cross-sectional analysis:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Smat</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">returnComplMat</span><span class="p">(</span><span class="n">th</span><span class="p">)</span>
        <span class="c"># Solve for the material stiffness matrix</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Cmat</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">inv</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Smat</span><span class="p">)</span></div>
<div class="viewcode-block" id="Material.printSummary"><a class="viewcode-back" href="../../structures.html#AeroComBAT.Structures.Material.printSummary">[docs]</a>    <span class="k">def</span> <span class="nf">printSummary</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Prints a tabulated summary of the material.</span>
<span class="sd">        </span>
<span class="sd">        This method prints out basic information about the</span>
<span class="sd">        material, including the type, the material constants, material</span>
<span class="sd">        thickness, as well as the tabulated stiffness or compliance</span>
<span class="sd">        matricies if requested.</span>
<span class="sd">        </span>
<span class="sd">        :Args:</span>
<span class="sd">        </span>
<span class="sd">        - `compliance (str)`: A boolean input to signify if the compliance</span>
<span class="sd">            matrix should be printed.</span>
<span class="sd">        - `stiffness (str)`: A boolean input to signify if the stiffness matrix</span>
<span class="sd">            should be printed.</span>
<span class="sd">            </span>
<span class="sd">        :Returns:</span>
<span class="sd">        </span>
<span class="sd">        - String print out containing the material name, as well as material</span>
<span class="sd">            constants and other defining material attributes. If requested</span>
<span class="sd">            this includes the material stiffness and compliance matricies.</span>
<span class="sd">            </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c"># Print Name</span>
        <span class="k">print</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
        <span class="c"># Print string summary attribute</span>
        <span class="k">print</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">summary</span><span class="p">)</span>
        <span class="c"># Print compliance matrix if requested</span>
        <span class="k">if</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s">&#39;compliance&#39;</span><span class="p">,</span><span class="bp">False</span><span class="p">):</span>
            <span class="k">print</span><span class="p">(</span><span class="s">&#39;COMPLIANCE MATRIX&#39;</span><span class="p">)</span>
            <span class="k">print</span><span class="p">(</span><span class="s">&#39;xyz cross-section CSYS:&#39;</span><span class="p">)</span>
            <span class="k">print</span><span class="p">(</span><span class="n">tabulate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Smat</span><span class="p">,</span><span class="n">tablefmt</span><span class="o">=</span><span class="s">&quot;fancy_grid&quot;</span><span class="p">))</span>
        <span class="c"># Print Stiffness matrix if requested</span>
        <span class="k">if</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s">&#39;stiffness&#39;</span><span class="p">,</span><span class="bp">False</span><span class="p">):</span>
            <span class="k">print</span><span class="p">(</span><span class="s">&#39;STIFFNESS MATRIX&#39;</span><span class="p">)</span>
            <span class="k">print</span><span class="p">(</span><span class="s">&#39;xyz cross-section CSYS:&#39;</span><span class="p">)</span>
            <span class="k">print</span><span class="p">(</span><span class="n">tabulate</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">around</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Cmat</span><span class="p">,</span><span class="n">decimals</span><span class="o">=</span><span class="mi">4</span><span class="p">),</span><span class="n">tablefmt</span><span class="o">=</span><span class="s">&quot;fancy_grid&quot;</span><span class="p">))</span>
            </div>
    <span class="k">def</span> <span class="nf">returnComplMat</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">th</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns the material 6x6 compliance matrix.</span>
<span class="sd">        </span>
<span class="sd">        Mainly inteded as a private method although kept public, and</span>
<span class="sd">        fascilitated the transformation of the compliance matrix to another</span>
<span class="sd">        coordinate system.</span>
<span class="sd">        </span>
<span class="sd">        :Args:</span>
<span class="sd">        </span>
<span class="sd">        - `th (1x3 Array[float])`: The angles about which the material can be</span>
<span class="sd">        rotated when it is initialized. In degrees.</span>
<span class="sd">            </span>
<span class="sd">        :Returns:</span>
<span class="sd">        </span>
<span class="sd">        - `Sp`: The transformed compliance matrix.</span>
<span class="sd">            </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c"># Method to return the compliance matrix</span>
        <span class="n">rh</span> <span class="o">=</span> <span class="n">RotationHelper</span><span class="p">()</span>
        <span class="n">Sp</span> <span class="o">=</span> <span class="n">rh</span><span class="o">.</span><span class="n">transformCompl</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Smat</span><span class="p">,</span><span class="n">th</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">Sp</span>
        </div>
<span class="k">class</span> <span class="nc">MicroMechanics</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;An class which calculates properties using micromechanical models.</span>
<span class="sd">    </span>
<span class="sd">    This method while not currently implemented can be used to calculate</span>
<span class="sd">    smeared material properties given the isotropic matrix and transversely</span>
<span class="sd">    isotropic fiber mechanical properties.</span>
<span class="sd">    </span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="nf">genCompProp</span><span class="p">(</span><span class="n">Vf</span><span class="p">,</span><span class="n">E1f</span><span class="p">,</span><span class="n">E2f</span><span class="p">,</span><span class="n">nu12f</span><span class="p">,</span><span class="n">G12f</span><span class="p">,</span><span class="n">E_m</span><span class="p">,</span><span class="n">nu_m</span><span class="p">,</span><span class="n">rhof</span><span class="p">,</span><span class="n">rhom</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Calculates the smeared properties of a composite.</span>
<span class="sd">        </span>
<span class="sd">        Given the fiber and matrix material information, this method assists</span>
<span class="sd">        with calculating the smeared mechanical properties of a composite.</span>
<span class="sd">        The code assumes the fibers are transversely isotropic, and the matrix</span>
<span class="sd">        is isotropic.</span>
<span class="sd">        </span>
<span class="sd">        This class is in beta form currently and is largely unsuported. The</span>
<span class="sd">        methods and formula have been tested, however the class an not been</span>
<span class="sd">        used or implemented with any other piece in the module.</span>
<span class="sd">        </span>
<span class="sd">        :Args:</span>
<span class="sd">        </span>
<span class="sd">        - `Vf (float)`: The fiber volume fraction</span>
<span class="sd">        - `E1f (float)`: The fiber stiffness in the 1-direction</span>
<span class="sd">        - `E2f (float)`: The fiber stiffness in the 2-direction</span>
<span class="sd">        - `nu12f (float)`: The in-plane fiber poisson ratio</span>
<span class="sd">        - `G12f (float)`: The in-plane fiber shear modulus</span>
<span class="sd">        - `E_m (float)`: The matrix stiffness</span>
<span class="sd">        - `nu_m (float)`: The matrix poisson ratio</span>
<span class="sd">        - `rhof (float)`: The fiber density</span>
<span class="sd">        - `rhom (float)`: The matrix density</span>
<span class="sd">        - `thermal (1x3 Array[float])`: Coefficients of thermal expansion</span>
<span class="sd">        - `moisture (1x3 Array[float])`: Coeffiecients of moisture expansion</span>
<span class="sd">            </span>
<span class="sd">        :Returns:</span>
<span class="sd">        </span>
<span class="sd">        - An array containing the transversely isotropic material properties</span>
<span class="sd">            of the smeared material.</span>
<span class="sd">            </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c">#thermal = [a1f, a2f, a_m]</span>
        <span class="n">thermal</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s">&#39;thermal&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
        <span class="c">#moisture = [b1f, b2f, b_m]</span>
        <span class="n">moisture</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s">&#39;moisture&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
        <span class="c">#G_m:</span>
        <span class="n">G_m</span> <span class="o">=</span> <span class="n">E_m</span><span class="o">/</span><span class="p">(</span><span class="mf">2.</span><span class="o">*</span><span class="p">(</span><span class="mf">1.</span><span class="o">+</span><span class="n">nu_m</span><span class="p">))</span>
        <span class="c">#E1:</span>
        <span class="n">E1</span> <span class="o">=</span> <span class="n">E1f</span><span class="o">*</span><span class="n">Vf</span><span class="o">+</span><span class="n">E_m</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">Vf</span><span class="p">)</span>
        <span class="c">#E2:</span>
        <span class="n">E2</span> <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="p">((</span><span class="mi">1</span><span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">Vf</span><span class="p">))</span><span class="o">/</span><span class="n">E_m</span><span class="o">+</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">Vf</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">E2f</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">Vf</span><span class="p">)</span><span class="o">+</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">Vf</span><span class="p">))</span><span class="o">*</span><span class="n">E_m</span><span class="p">))</span>
        <span class="c">#Nu_12:</span>
        <span class="n">nu_12</span> <span class="o">=</span> <span class="n">nu12f</span><span class="o">*</span><span class="n">Vf</span><span class="o">+</span><span class="n">nu_m</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">Vf</span><span class="p">)</span>
        <span class="c">#Nu_23 = ???</span>
        <span class="c">#TODO: Implement micro-mechanical model</span>
        <span class="n">nu_23</span> <span class="o">=</span> <span class="o">.</span><span class="mi">458</span>
        <span class="c">#G_12</span>
        <span class="n">G_12</span> <span class="o">=</span> <span class="n">G_m</span><span class="o">*</span><span class="p">(((</span><span class="n">G_m</span><span class="o">+</span><span class="n">G12f</span><span class="p">)</span><span class="o">-</span><span class="n">Vf</span><span class="o">*</span><span class="p">(</span><span class="n">G_m</span><span class="o">-</span><span class="n">G12f</span><span class="p">))</span><span class="o">/</span><span class="p">((</span><span class="n">G_m</span><span class="o">+</span><span class="n">G12f</span><span class="p">)</span><span class="o">+</span><span class="n">Vf</span><span class="o">*</span><span class="p">(</span><span class="n">G_m</span><span class="o">-</span><span class="n">G12f</span><span class="p">)))</span>
        <span class="c">#Comp Density</span>
        <span class="n">rho</span> <span class="o">=</span> <span class="n">rhof</span><span class="o">*</span><span class="n">Vf</span><span class="o">+</span><span class="n">rhom</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">Vf</span><span class="p">)</span>
        <span class="c">#TODO: Add thermal properties to the output set</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">thermal</span><span class="o">==</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]:</span>
            <span class="n">a1f</span> <span class="o">=</span> <span class="n">thermal</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">a2f</span> <span class="o">=</span> <span class="n">thermal</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
            <span class="n">a_m</span> <span class="o">=</span> <span class="n">thermal</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
            <span class="c">#Alpha_1</span>
            <span class="n">a1</span> <span class="o">=</span> <span class="p">(</span><span class="n">E1f</span><span class="o">*</span><span class="n">a1f</span><span class="o">*</span><span class="n">Vf</span><span class="o">+</span><span class="n">E_m</span><span class="o">*</span><span class="n">a_m</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">Vf</span><span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="n">E1f</span><span class="o">*</span><span class="n">Vf</span><span class="o">+</span><span class="n">E_m</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">Vf</span><span class="p">))</span>
            <span class="c">#Alpha_2</span>
            <span class="n">a2</span> <span class="o">=</span> <span class="p">(</span><span class="n">a2f</span><span class="o">-</span><span class="p">(</span><span class="n">E_m</span><span class="o">/</span><span class="n">E1</span><span class="p">)</span><span class="o">*</span><span class="n">Vf</span><span class="o">*</span><span class="p">(</span><span class="n">a_m</span><span class="o">-</span><span class="n">a1f</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">Vf</span><span class="p">))</span><span class="o">*</span><span class="n">Vf</span><span class="o">+</span><span class="p">(</span><span class="n">a_m</span><span class="o">+</span><span class="p">(</span><span class="n">E1f</span><span class="o">/</span><span class="n">E1</span><span class="p">)</span><span class="o">*</span><span class="n">nu_m</span><span class="o">*</span><span class="p">(</span><span class="n">a_m</span><span class="o">-</span><span class="n">a1f</span><span class="p">)</span><span class="o">*</span><span class="n">Vf</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">Vf</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">moisture</span><span class="o">==</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]:</span>
            <span class="n">b1f</span> <span class="o">=</span> <span class="n">moisture</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">b2f</span> <span class="o">=</span> <span class="n">moisture</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
            <span class="n">b_m</span> <span class="o">=</span> <span class="n">moisture</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
            <span class="c">#Beta_1</span>
            <span class="n">b1</span> <span class="o">=</span> <span class="p">(</span><span class="n">E1f</span><span class="o">*</span><span class="n">b1f</span><span class="o">*</span><span class="n">Vf</span><span class="o">+</span><span class="n">E_m</span><span class="o">*</span><span class="n">b_m</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">Vf</span><span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="n">E1f</span><span class="o">*</span><span class="n">Vf</span><span class="o">+</span><span class="n">E_m</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">Vf</span><span class="p">))</span>
            <span class="c">#Beta_2</span>
            <span class="n">b2</span> <span class="o">=</span> <span class="p">(</span><span class="n">b2f</span><span class="o">-</span><span class="p">(</span><span class="n">E_m</span><span class="o">/</span><span class="n">E1</span><span class="p">)</span><span class="o">*</span><span class="n">Vf</span><span class="o">*</span><span class="p">(</span><span class="n">b_m</span><span class="o">-</span><span class="n">b1f</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">Vf</span><span class="p">))</span><span class="o">*</span><span class="n">Vf</span><span class="o">+</span><span class="p">(</span><span class="n">b_m</span><span class="o">+</span><span class="p">(</span><span class="n">E1f</span><span class="o">/</span><span class="n">E1</span><span class="p">)</span><span class="o">*</span><span class="n">nu_m</span><span class="o">*</span><span class="p">(</span><span class="n">b_m</span><span class="o">-</span><span class="n">b1f</span><span class="p">)</span><span class="o">*</span><span class="n">Vf</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">Vf</span><span class="p">)</span>
        <span class="k">return</span> <span class="p">[</span><span class="n">E1</span><span class="p">,</span> <span class="n">E2</span><span class="p">,</span> <span class="n">nu_12</span><span class="p">,</span> <span class="n">nu_23</span><span class="p">,</span> <span class="n">G_12</span><span class="p">,</span> <span class="n">rho</span><span class="p">]</span>

<span class="c"># 2-D CQUADX class, can be used for cross-sectional analysis</span>
<div class="viewcode-block" id="CQUADX"><a class="viewcode-back" href="../../structures.html#AeroComBAT.Structures.CQUADX">[docs]</a><span class="k">class</span> <span class="nc">CQUADX</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot; Creates a linear, 2D 4 node quadrilateral element object.</span>
<span class="sd">    </span>
<span class="sd">    The main purpose of this class is to assist in the cross-sectional</span>
<span class="sd">    analysis of a beam, however it COULD be modified to serve as an element for</span>
<span class="sd">    2D plate or laminate FE analysis.</span>
<span class="sd">    </span>
<span class="sd">    :Attributes:</span>
<span class="sd">    </span>
<span class="sd">    - `type (str)`: A string designating it a CQUADX element.</span>
<span class="sd">    - `xsect (bool)`: States whether the element is to be used in cross-</span>
<span class="sd">        sectional analysis.</span>
<span class="sd">    - `th (1x3 Array[float])`: Array containing the Euler-angles expressing how</span>
<span class="sd">        the element constitutive relations should be rotated from the</span>
<span class="sd">        material fiber frame to the global CSYS. In degrees.</span>
<span class="sd">    - `EID (int)`: An integer identifier for the CQUADX element.</span>
<span class="sd">    - `MID (int)`: An integer refrencing the material ID used for the</span>
<span class="sd">        constitutive relations.</span>
<span class="sd">    - `NIDs (1x4 Array[int])`: Contains the integer node identifiers for the</span>
<span class="sd">        node objects used to create the element.</span>
<span class="sd">    - `nodes (1x4 Array[obj])`: Contains the properly ordered nodes objects</span>
<span class="sd">        used to create the element.</span>
<span class="sd">    - `xs (1x4 np.array[float])`: Array containing the x-coordinates of the</span>
<span class="sd">        nodes used in the element</span>
<span class="sd">    - `ys (1x4 np.array[float])`: Array containing the y-coordinates of the</span>
<span class="sd">        nodes used in the element</span>
<span class="sd">    - `rho (float)`: Density of the material used in the element.</span>
<span class="sd">    - `mass (float)`: Mass per unit length (or thickness) of the element.</span>
<span class="sd">    - `U (12x1 np.array[float])`: This column vector contains the CQUADXs</span>
<span class="sd">        3 DOF (x-y-z) displacements in the local xsect CSYS due to cross-</span>
<span class="sd">        section warping effects.</span>
<span class="sd">    - `Eps (6x4 np.array[float])`: A matrix containing the 3D strain state</span>
<span class="sd">        within the CQUADX element.</span>
<span class="sd">    - `Sig (6x4 np.array[float])`: A matrix containing the 3D stress state</span>
<span class="sd">        within the CQUADX element.</span>
<span class="sd">        </span>
<span class="sd">    :Methods:</span>
<span class="sd">    </span>
<span class="sd">    - `x`: Calculates the local xsect x-coordinate provided the desired master</span>
<span class="sd">        coordinates eta and xi.</span>
<span class="sd">    - `y`: Calculates the local xsect y-coordinate provided the desired master</span>
<span class="sd">        coordinates eta and xi.</span>
<span class="sd">    - `J`: Calculates the jacobian of the element provided the desired master</span>
<span class="sd">        coordinates eta and xi.</span>
<span class="sd">    - `resetResults`: Initializes the displacement (U), strain (Eps), and</span>
<span class="sd">        stress (Sig) attributes of the element.</span>
<span class="sd">    - `getDeformed`: Provided an analysis has been conducted, this method</span>
<span class="sd">        returns 3 2x2 np.array[float] containing the element warped</span>
<span class="sd">        displacements in the local xsect CSYS.</span>
<span class="sd">    - `getStressState`: Provided an analysis has been conducted, this method</span>
<span class="sd">        returns 3 2x2 np.array[float] containing the element stress at four</span>
<span class="sd">        points. The 3D stress state is processed to return the Von-Mises</span>
<span class="sd">        or Maximum Principal stress state.</span>
<span class="sd">    - `printSummary`: Prints out a tabulated form of the element ID, as well</span>
<span class="sd">        as the node ID&#39;s referenced by the element.</span>
<span class="sd">        </span>
<span class="sd">    &quot;&quot;&quot;</span>
<div class="viewcode-block" id="CQUADX.__init__"><a class="viewcode-back" href="../../structures.html#AeroComBAT.Structures.CQUADX.__init__">[docs]</a>    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">EID</span><span class="p">,</span><span class="n">nodes</span><span class="p">,</span><span class="n">MID</span><span class="p">,</span><span class="n">matLib</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Initializes the element.</span>
<span class="sd">        </span>
<span class="sd">        :Args:</span>
<span class="sd">        </span>
<span class="sd">        - `EID (int)`: An integer identifier for the CQUADX element.</span>
<span class="sd">        - `nodes (1x4 Array[obj])`: Contains the properly ordered nodes objects</span>
<span class="sd">            used to create the element.</span>
<span class="sd">        - `MID (int)`: An integer refrencing the material ID used for the</span>
<span class="sd">            constitutive relations.</span>
<span class="sd">        - `matLib (obj)`: A material library object containing a dictionary</span>
<span class="sd">            with the material corresponding to the provided MID.</span>
<span class="sd">        - `xsect (bool)`: A boolean to determine whether this quad element is</span>
<span class="sd">            to be used for cross-sectional analysis. Defualt value is True.</span>
<span class="sd">        - `th (1x3 Array[float])`: Array containing the Euler-angles expressing</span>
<span class="sd">            how the element constitutive relations should be rotated from</span>
<span class="sd">            the material fiber frame to the global CSYS. In degrees.</span>
<span class="sd">            </span>
<span class="sd">        :Returns:</span>
<span class="sd">        </span>
<span class="sd">        - None</span>
<span class="sd">            </span>
<span class="sd">        .. Note:: The reference coordinate system for cross-sectional analysis is a</span>
<span class="sd">        local coordinate system in which the x and y axes are planer with the</span>
<span class="sd">        element, and the z-axis is perpendicular to the plane of the element.</span>
<span class="sd">        </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c"># Initialize type</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">type</span> <span class="o">=</span> <span class="s">&#39;CQUADX&#39;</span>
        <span class="c"># Used for xsect analysis?</span>
        <span class="n">xsect</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s">&#39;xsect&#39;</span><span class="p">,</span> <span class="bp">True</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">xsect</span> <span class="o">=</span> <span class="n">xsect</span>
        <span class="c"># Initialize Euler-angles for material orientation in the xsect CSYS</span>
        <span class="n">th</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s">&#39;th&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mf">0.</span><span class="p">,</span><span class="mf">0.</span><span class="p">,</span><span class="mf">0.</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">th</span> <span class="o">=</span> <span class="n">th</span>
        <span class="c"># Error checking on EID input</span>
        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">EID</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">int</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">EID</span> <span class="o">=</span> <span class="n">EID</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s">&#39;The element ID given was not an integer&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">len</span><span class="p">(</span><span class="n">nodes</span><span class="p">)</span> <span class="o">==</span> <span class="mi">4</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s">&#39;A CQUADX element requires 4 nodes, </span><span class="si">%d</span><span class="s"> were&#39;</span><span class="o">+</span>
                <span class="s">&#39;supplied in the nodes array&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">nodes</span><span class="p">)))</span>
        <span class="n">nids</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">node</span> <span class="ow">in</span> <span class="n">nodes</span><span class="p">:</span>
            <span class="n">nids</span><span class="o">+=</span> <span class="p">[</span><span class="n">node</span><span class="o">.</span><span class="n">NID</span><span class="p">]</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">len</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">nids</span><span class="p">))</span><span class="o">==</span><span class="mi">4</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s">&#39;The node objects used to create this CQUADX &#39;</span><span class="o">+</span>
                <span class="s">&#39;share at least 1 NID. Make sure that no repeated node &#39;</span><span class="o">+</span>
                <span class="s">&#39;objects were used.&#39;</span><span class="p">)</span>
        <span class="c"># Error checking on MID input</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">MID</span> <span class="ow">in</span> <span class="n">matLib</span><span class="o">.</span><span class="n">matDict</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="k">raise</span> <span class="ne">KeyError</span><span class="p">(</span><span class="s">&#39;The MID provided is not linked with any materials&#39;</span><span class="o">+</span>
                <span class="s">&#39;within the supplied material library.&#39;</span><span class="p">)</span>
        <span class="c"># Initialize the warping displacement, strain and stress results</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">resetResults</span><span class="p">()</span>
        <span class="c"># Store the MID</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">MID</span> <span class="o">=</span> <span class="n">MID</span>
        <span class="c"># Populate the NIDs array with the IDs of the nodes used by the element</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">NIDs</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">nodes</span> <span class="o">=</span> <span class="n">nodes</span>
        <span class="k">for</span> <span class="n">node</span> <span class="ow">in</span> <span class="n">nodes</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">NIDs</span> <span class="o">+=</span> <span class="p">[</span><span class="n">node</span><span class="o">.</span><span class="n">NID</span><span class="p">]</span>
        
        <span class="c"># INITIALIZE THE ELEMENT CONSTITUTIVE MATRIX:</span>
        <span class="c"># Select the element material object from the material dictionary:</span>
        <span class="n">material</span> <span class="o">=</span> <span class="n">matLib</span><span class="o">.</span><span class="n">getMat</span><span class="p">(</span><span class="n">MID</span><span class="p">)</span>
        <span class="c"># Initialize the volume density of the element</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">rho</span> <span class="o">=</span> <span class="n">material</span><span class="o">.</span><span class="n">rho</span>
        <span class="c"># Initialize the mass per unit length (or thickness) of the element</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mass</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="c"># Create a rotation helper to rotate the compliance matrix:</span>
        <span class="n">rh</span> <span class="o">=</span> <span class="n">RotationHelper</span><span class="p">()</span>
        <span class="c"># Rotate the materials compliance matrix as necessary:</span>
        <span class="n">Selem</span> <span class="o">=</span> <span class="n">rh</span><span class="o">.</span><span class="n">transformCompl</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">material</span><span class="o">.</span><span class="n">Smat</span><span class="p">),</span><span class="n">th</span><span class="p">,</span><span class="n">xsect</span><span class="o">=</span><span class="n">xsect</span><span class="p">)</span>
        <span class="c"># Reorder Selem for cross-sectional analysis:</span>
        <span class="c"># Initialize empty compliance matrix</span>
        <span class="n">Sxsect</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">6</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span>
        <span class="c"># Initialize reorganization key</span>
        <span class="n">shuff</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">6</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">6</span><span class="p">):</span>
                <span class="n">Sxsect</span><span class="p">[</span><span class="n">shuff</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">shuff</span><span class="p">[</span><span class="n">j</span><span class="p">]]</span> <span class="o">=</span> <span class="n">Selem</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span>
        <span class="c"># Store the re-ordered material stiffness matrix:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Q</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">inv</span><span class="p">(</span><span class="n">Sxsect</span><span class="p">)</span>
        
        <span class="c"># Initialize Matricies for later use in xsect equilibrium solution:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Ae</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">6</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Re</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">12</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Ee</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">12</span><span class="p">,</span><span class="mi">12</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Ce</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">12</span><span class="p">,</span><span class="mi">12</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Le</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">12</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Me</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">12</span><span class="p">,</span><span class="mi">12</span><span class="p">))</span>
        <span class="c"># Generate X and Y coordinates of the nodes</span>
        <span class="n">xs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
        <span class="n">ys</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">4</span><span class="p">):</span>
            <span class="n">tempxyz</span> <span class="o">=</span> <span class="n">nodes</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">x</span>
            <span class="n">xs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">tempxyz</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">ys</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">tempxyz</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="c"># Save for ease of strain calculation on strain recovery</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">xs</span> <span class="o">=</span> <span class="n">xs</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ys</span> <span class="o">=</span> <span class="n">ys</span>
        <span class="c"># Initialize coordinates for Guass Quadrature Integration</span>
        <span class="n">etas</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">/</span><span class="mi">3</span>
        <span class="n">xis</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">/</span><span class="mi">3</span>
        <span class="c"># Evaluate/sum the cross-section matricies at the Guass points</span>
        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">size</span><span class="p">(</span><span class="n">xis</span><span class="p">)):</span>
            <span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">size</span><span class="p">(</span><span class="n">etas</span><span class="p">)):</span>
                <span class="c">#Get Z Matrix</span>
                <span class="n">Zmat</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Z</span><span class="p">(</span><span class="n">etas</span><span class="p">[</span><span class="n">l</span><span class="p">],</span><span class="n">xis</span><span class="p">[</span><span class="n">k</span><span class="p">])</span>
                <span class="c">#Get BN Matricies</span>
                <span class="n">Jmat</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">J</span><span class="p">(</span><span class="n">etas</span><span class="p">[</span><span class="n">l</span><span class="p">],</span><span class="n">xis</span><span class="p">[</span><span class="n">k</span><span class="p">])</span>
                <span class="c">#Get determinant of the Jacobian Matrix</span>
                <span class="n">Jdet</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">det</span><span class="p">(</span><span class="n">Jmat</span><span class="p">))</span>
                <span class="n">Jmatinv</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">inv</span><span class="p">(</span><span class="n">Jmat</span><span class="p">)</span>
                <span class="n">Bxi</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">6</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span>
                <span class="n">Beta</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">6</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span>
                <span class="n">Bxi</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">Bxi</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">Bxi</span><span class="p">[</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">Jmatinv</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span>
                <span class="n">Bxi</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">Bxi</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">Bxi</span><span class="p">[</span><span class="mi">4</span><span class="p">,</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">Jmatinv</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span>
                <span class="n">Beta</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">Beta</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">Beta</span><span class="p">[</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">Jmatinv</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span>
                <span class="n">Beta</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">Beta</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">Beta</span><span class="p">[</span><span class="mi">4</span><span class="p">,</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">Jmatinv</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span>
                <span class="n">BN</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">Bxi</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">dNdxi</span><span class="p">(</span><span class="n">etas</span><span class="p">[</span><span class="n">l</span><span class="p">]))</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">Beta</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">dNdeta</span><span class="p">(</span><span class="n">xis</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span>
                
                <span class="c">#Get a few last minute matricies</span>
                <span class="n">S</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">6</span><span class="p">,</span><span class="mi">3</span><span class="p">));</span><span class="n">S</span><span class="p">[</span><span class="mi">3</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span><span class="n">S</span><span class="p">[</span><span class="mi">4</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span><span class="n">S</span><span class="p">[</span><span class="mi">5</span><span class="p">,</span><span class="mi">2</span><span class="p">]</span><span class="o">=</span><span class="mi">1</span>
                <span class="n">SZ</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">S</span><span class="p">,</span><span class="n">Zmat</span><span class="p">)</span>
                <span class="n">Nmat</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">N</span><span class="p">(</span><span class="n">etas</span><span class="p">[</span><span class="n">l</span><span class="p">],</span><span class="n">xis</span><span class="p">[</span><span class="n">k</span><span class="p">])</span>
                <span class="n">SN</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">S</span><span class="p">,</span><span class="n">Nmat</span><span class="p">)</span>
                
                <span class="c"># Calculate the mass per unit length of the element</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">mass</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">rho</span><span class="o">*</span><span class="n">Jdet</span>
                
                <span class="c">#Add to Ae Matrix</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">Ae</span> <span class="o">+=</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">SZ</span><span class="o">.</span><span class="n">T</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Q</span><span class="p">,</span><span class="n">SZ</span><span class="p">))</span><span class="o">*</span><span class="n">Jdet</span>
                <span class="c">#Add to Re Matrix</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">Re</span> <span class="o">+=</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">BN</span><span class="o">.</span><span class="n">T</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Q</span><span class="p">,</span><span class="n">SZ</span><span class="p">))</span><span class="o">*</span><span class="n">Jdet</span>
                <span class="c">#Add to Ee Matrix</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">Ee</span> <span class="o">+=</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">BN</span><span class="o">.</span><span class="n">T</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Q</span><span class="p">,</span><span class="n">BN</span><span class="p">))</span><span class="o">*</span><span class="n">Jdet</span>
                <span class="c">#Add to Ce Matrix</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">Ce</span> <span class="o">+=</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">BN</span><span class="o">.</span><span class="n">T</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Q</span><span class="p">,</span><span class="n">SN</span><span class="p">))</span><span class="o">*</span><span class="n">Jdet</span>
                <span class="c">#Add to Le Matrix</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">Le</span> <span class="o">+=</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">SN</span><span class="o">.</span><span class="n">T</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Q</span><span class="p">,</span><span class="n">SZ</span><span class="p">))</span><span class="o">*</span><span class="n">Jdet</span>
                <span class="c">#Add to Me Matrix</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">Me</span> <span class="o">+=</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">SN</span><span class="o">.</span><span class="n">T</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Q</span><span class="p">,</span><span class="n">SN</span><span class="p">))</span><span class="o">*</span><span class="n">Jdet</span></div>
<div class="viewcode-block" id="CQUADX.x"><a class="viewcode-back" href="../../structures.html#AeroComBAT.Structures.CQUADX.x">[docs]</a>    <span class="k">def</span> <span class="nf">x</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">eta</span><span class="p">,</span><span class="n">xi</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Calculate the x-coordinate within the element.</span>
<span class="sd">        </span>
<span class="sd">        Calculates the local xsect x-coordinate provided the desired master</span>
<span class="sd">        coordinates eta and xi.</span>
<span class="sd">        </span>
<span class="sd">        :Args:</span>
<span class="sd">        </span>
<span class="sd">        - `eta (float)`: The eta coordinate in the master coordinate domain.*</span>
<span class="sd">        - `xi (float)`: The xi coordinate in the master coordinate domain.*</span>
<span class="sd">            </span>
<span class="sd">        :Returns:</span>
<span class="sd">        </span>
<span class="sd">        - `x (float)`: The x-coordinate within the element.</span>
<span class="sd">            </span>
<span class="sd">        .. Note:: Xi and eta can both vary between -1 and 1 respectively.</span>
<span class="sd">        </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">xs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">xs</span>
        <span class="k">return</span> <span class="o">.</span><span class="mi">25</span><span class="o">*</span><span class="p">(</span><span class="n">xs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="mf">1.</span><span class="o">-</span><span class="n">xi</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="mf">1.</span><span class="o">-</span><span class="n">eta</span><span class="p">)</span><span class="o">+</span><span class="n">xs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="mf">1.</span><span class="o">+</span><span class="n">xi</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="mf">1.</span><span class="o">-</span><span class="n">eta</span><span class="p">)</span><span class="o">+</span>\
                <span class="n">xs</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="mf">1.</span><span class="o">+</span><span class="n">xi</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="mf">1.</span><span class="o">+</span><span class="n">eta</span><span class="p">)</span><span class="o">+</span><span class="n">xs</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="mf">1.</span><span class="o">-</span><span class="n">xi</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="mf">1.</span><span class="o">+</span><span class="n">eta</span><span class="p">))</span></div>
<div class="viewcode-block" id="CQUADX.y"><a class="viewcode-back" href="../../structures.html#AeroComBAT.Structures.CQUADX.y">[docs]</a>    <span class="k">def</span> <span class="nf">y</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">eta</span><span class="p">,</span><span class="n">xi</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Calculate the y-coordinate within the element.</span>
<span class="sd">        </span>
<span class="sd">        Calculates the local xsect y-coordinate provided the desired master</span>
<span class="sd">        coordinates eta and xi.</span>
<span class="sd">        </span>
<span class="sd">        :Args:</span>
<span class="sd">        </span>
<span class="sd">        - `eta (float)`: The eta coordinate in the master coordinate domain.*</span>
<span class="sd">        - `xi (float)`: The xi coordinate in the master coordinate domain.*</span>
<span class="sd">            </span>
<span class="sd">        :Returns:</span>
<span class="sd">        </span>
<span class="sd">        - `y (float)&#39;: The y-coordinate within the element.</span>
<span class="sd">            </span>
<span class="sd">        .. Note:: Xi and eta can both vary between -1 and 1 respectively.</span>
<span class="sd">        </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">ys</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ys</span>
        <span class="k">return</span> <span class="o">.</span><span class="mi">25</span><span class="o">*</span><span class="p">(</span><span class="n">ys</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="mf">1.</span><span class="o">-</span><span class="n">xi</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="mf">1.</span><span class="o">-</span><span class="n">eta</span><span class="p">)</span><span class="o">+</span><span class="n">ys</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="mf">1.</span><span class="o">+</span><span class="n">xi</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="mf">1.</span><span class="o">-</span><span class="n">eta</span><span class="p">)</span><span class="o">+</span>\
                <span class="n">ys</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="mf">1.</span><span class="o">+</span><span class="n">xi</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="mf">1.</span><span class="o">+</span><span class="n">eta</span><span class="p">)</span><span class="o">+</span><span class="n">ys</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="mf">1.</span><span class="o">-</span><span class="n">xi</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="mf">1.</span><span class="o">+</span><span class="n">eta</span><span class="p">))</span></div>
    <span class="k">def</span> <span class="nf">Z</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">eta</span><span class="p">,</span><span class="n">xi</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Calculates transformation matrix relating stress to force-moments.</span>
<span class="sd">        </span>
<span class="sd">        Intended primarily as a private method but left public, this method</span>
<span class="sd">        calculates the transformation matrix that converts stresses to force</span>
<span class="sd">        and moment resultants.</span>
<span class="sd">        </span>
<span class="sd">        :Args:</span>
<span class="sd">        </span>
<span class="sd">        - `eta (float)`: The eta coordinate in the master coordinate domain.*</span>
<span class="sd">        - `xi (float)`: The xi coordinate in the master coordinate domain.*</span>
<span class="sd">            </span>
<span class="sd">        :Returns:</span>
<span class="sd">        </span>
<span class="sd">        - `Z (3x6 np.array[float])`: The stress-resutlant transformation array.</span>
<span class="sd">            </span>
<span class="sd">        .. Note:: Xi and eta can both vary between -1 and 1 respectively.</span>
<span class="sd">        </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mf">1.</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">y</span><span class="p">(</span><span class="n">eta</span><span class="p">,</span><span class="n">xi</span><span class="p">)],</span>\
                         <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mf">1.</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">x</span><span class="p">(</span><span class="n">eta</span><span class="p">,</span><span class="n">xi</span><span class="p">)],</span>\
                         <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mf">1.</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">y</span><span class="p">(</span><span class="n">eta</span><span class="p">,</span><span class="n">xi</span><span class="p">),</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">x</span><span class="p">(</span><span class="n">eta</span><span class="p">,</span><span class="n">xi</span><span class="p">),</span><span class="mi">0</span><span class="p">]])</span>
<div class="viewcode-block" id="CQUADX.J"><a class="viewcode-back" href="../../structures.html#AeroComBAT.Structures.CQUADX.J">[docs]</a>    <span class="k">def</span> <span class="nf">J</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">eta</span><span class="p">,</span><span class="n">xi</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Calculates the jacobian at a point in the element.</span>
<span class="sd">        </span>
<span class="sd">        This method calculates the jacobian at a local point within the element</span>
<span class="sd">        provided the master coordinates eta and xi.</span>
<span class="sd">        </span>
<span class="sd">        :Args:</span>
<span class="sd">        </span>
<span class="sd">        - `eta (float)`: The eta coordinate in the master coordinate domain.*</span>
<span class="sd">        - `xi (float)`: The xi coordinate in the master coordinate domain.*</span>
<span class="sd">            </span>
<span class="sd">        :Returns:</span>
<span class="sd">        </span>
<span class="sd">        - `Jmat (3x3 np.array[float])`: The stress-resutlant transformation</span>
<span class="sd">            array.</span>
<span class="sd">            </span>
<span class="sd">        .. Note:: Xi and eta can both vary between -1 and 1 respectively.</span>
<span class="sd">        </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">xs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">xs</span>
        <span class="n">ys</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ys</span>
        <span class="n">J11</span> <span class="o">=</span> <span class="mf">0.25</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">xs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">eta</span><span class="p">)</span><span class="o">+</span><span class="n">xs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">eta</span><span class="p">)</span><span class="o">+</span><span class="n">xs</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">eta</span><span class="p">)</span><span class="o">-</span><span class="n">xs</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">eta</span><span class="p">))</span>
        <span class="n">J12</span> <span class="o">=</span> <span class="mf">0.25</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">ys</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">eta</span><span class="p">)</span><span class="o">+</span><span class="n">ys</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">eta</span><span class="p">)</span><span class="o">+</span><span class="n">ys</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">eta</span><span class="p">)</span><span class="o">-</span><span class="n">ys</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">eta</span><span class="p">))</span>
        <span class="n">J21</span> <span class="o">=</span> <span class="mf">0.25</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">xs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">xi</span><span class="p">)</span><span class="o">-</span><span class="n">xs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">xi</span><span class="p">)</span><span class="o">+</span><span class="n">xs</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">xi</span><span class="p">)</span><span class="o">+</span><span class="n">xs</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">xi</span><span class="p">))</span>
        <span class="n">J22</span> <span class="o">=</span> <span class="mf">0.25</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">ys</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">xi</span><span class="p">)</span><span class="o">-</span><span class="n">ys</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">xi</span><span class="p">)</span><span class="o">+</span><span class="n">ys</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">xi</span><span class="p">)</span><span class="o">+</span><span class="n">ys</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">xi</span><span class="p">))</span>
        <span class="n">Jmat</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="n">J11</span><span class="p">,</span><span class="n">J12</span><span class="p">,</span><span class="mi">0</span><span class="p">],[</span><span class="n">J21</span><span class="p">,</span><span class="n">J22</span><span class="p">,</span><span class="mi">0</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]])</span>
        <span class="k">return</span> <span class="n">Jmat</span></div>
    <span class="k">def</span> <span class="nf">N</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">eta</span><span class="p">,</span><span class="n">xi</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Generates the shape-function value weighting matrix.</span>
<span class="sd">        </span>
<span class="sd">        Intended primarily as a private method but left public, this method</span>
<span class="sd">        generates the weighting matrix used to interpolate values within the</span>
<span class="sd">        element. This method however is mainly reserved for the cross-sectional</span>
<span class="sd">        analysis process.</span>
<span class="sd">        </span>
<span class="sd">        :Args:</span>
<span class="sd">        </span>
<span class="sd">        - `eta (float)`: The eta coordinate in the master coordinate domain.*</span>
<span class="sd">        - `xi (float)`: The xi coordinate in the master coordinate domain.*</span>
<span class="sd">            </span>
<span class="sd">        :Returns:</span>
<span class="sd">        </span>
<span class="sd">        - `Nmat (3x12 np.array[float])`: The shape-function value weighting</span>
<span class="sd">            matrix.</span>
<span class="sd">            </span>
<span class="sd">        .. Note:: Xi and eta can both vary between -1 and 1 respectively.</span>
<span class="sd">        </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">Nmat</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">([</span><span class="mi">3</span><span class="p">,</span><span class="mi">12</span><span class="p">])</span>
        <span class="n">N1</span> <span class="o">=</span> <span class="o">.</span><span class="mi">25</span><span class="o">*</span><span class="p">(</span><span class="mf">1.</span><span class="o">-</span><span class="n">xi</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="mf">1.</span><span class="o">-</span><span class="n">eta</span><span class="p">)</span>
        <span class="n">N2</span> <span class="o">=</span> <span class="o">.</span><span class="mi">25</span><span class="o">*</span><span class="p">(</span><span class="mf">1.</span><span class="o">+</span><span class="n">xi</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="mf">1.</span><span class="o">-</span><span class="n">eta</span><span class="p">)</span>
        <span class="n">N3</span> <span class="o">=</span> <span class="o">.</span><span class="mi">25</span><span class="o">*</span><span class="p">(</span><span class="mf">1.</span><span class="o">+</span><span class="n">xi</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="mf">1.</span><span class="o">+</span><span class="n">eta</span><span class="p">)</span>
        <span class="n">N4</span> <span class="o">=</span> <span class="o">.</span><span class="mi">25</span><span class="o">*</span><span class="p">(</span><span class="mf">1.</span><span class="o">-</span><span class="n">xi</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="mf">1.</span><span class="o">+</span><span class="n">eta</span><span class="p">)</span>
        <span class="n">Nmat</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">Nmat</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">Nmat</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">N1</span>
        <span class="n">Nmat</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="n">Nmat</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span><span class="p">]</span> <span class="o">=</span> <span class="n">Nmat</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">5</span><span class="p">]</span> <span class="o">=</span> <span class="n">N2</span>
        <span class="n">Nmat</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">6</span><span class="p">]</span> <span class="o">=</span> <span class="n">Nmat</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">7</span><span class="p">]</span> <span class="o">=</span> <span class="n">Nmat</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">8</span><span class="p">]</span> <span class="o">=</span> <span class="n">N3</span>
        <span class="n">Nmat</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">9</span><span class="p">]</span> <span class="o">=</span> <span class="n">Nmat</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">10</span><span class="p">]</span> <span class="o">=</span> <span class="n">Nmat</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">11</span><span class="p">]</span> <span class="o">=</span> <span class="n">N4</span>
        <span class="k">return</span> <span class="n">Nmat</span>
    <span class="k">def</span> <span class="nf">dNdxi</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">eta</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Generates a gradient of the shape-function value weighting matrix.</span>
<span class="sd">        </span>
<span class="sd">        Intended primarily as a private method but left public, this method</span>
<span class="sd">        generates the gradient of the weighting matrix with respect to xi and</span>
<span class="sd">        is used to interpolate values within the element. This method however</span>
<span class="sd">        is mainly reserved for the cross-sectional analysis process.</span>
<span class="sd">        </span>
<span class="sd">        :Args:</span>
<span class="sd">        </span>
<span class="sd">        - `eta (float)`: The eta coordinate in the master coordinate domain.*</span>
<span class="sd">        - `xi (float)`: The xi coordinate in the master coordinate domain.*</span>
<span class="sd">            </span>
<span class="sd">        :Returns:</span>
<span class="sd">        </span>
<span class="sd">        - `dNdxi_mat (3x12 np.array[float])`: The gradient of the shape-</span>
<span class="sd">            function value weighting matrix with respect to xi.</span>
<span class="sd">            </span>
<span class="sd">        .. Note:: Xi and eta can both vary between -1 and 1 respectively.</span>
<span class="sd">        </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">dNdxi_mat</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">([</span><span class="mi">3</span><span class="p">,</span><span class="mi">12</span><span class="p">])</span>
        <span class="n">dN1dxi</span> <span class="o">=</span> <span class="o">-.</span><span class="mi">25</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">eta</span><span class="p">)</span>
        <span class="n">dN2dxi</span> <span class="o">=</span> <span class="o">.</span><span class="mi">25</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">eta</span><span class="p">)</span>
        <span class="n">dN3dxi</span> <span class="o">=</span> <span class="o">.</span><span class="mi">25</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">eta</span><span class="p">)</span>
        <span class="n">dN4dxi</span> <span class="o">=</span> <span class="o">-.</span><span class="mi">25</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">eta</span><span class="p">)</span>
        <span class="n">dNdxi_mat</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">dNdxi_mat</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">dNdxi_mat</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">dN1dxi</span>
        <span class="n">dNdxi_mat</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="n">dNdxi_mat</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span><span class="p">]</span> <span class="o">=</span> <span class="n">dNdxi_mat</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">5</span><span class="p">]</span> <span class="o">=</span> <span class="n">dN2dxi</span>
        <span class="n">dNdxi_mat</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">6</span><span class="p">]</span> <span class="o">=</span> <span class="n">dNdxi_mat</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">7</span><span class="p">]</span> <span class="o">=</span> <span class="n">dNdxi_mat</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">8</span><span class="p">]</span> <span class="o">=</span> <span class="n">dN3dxi</span>
        <span class="n">dNdxi_mat</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">9</span><span class="p">]</span> <span class="o">=</span> <span class="n">dNdxi_mat</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">10</span><span class="p">]</span> <span class="o">=</span> <span class="n">dNdxi_mat</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">11</span><span class="p">]</span> <span class="o">=</span> <span class="n">dN4dxi</span>
        <span class="k">return</span> <span class="n">dNdxi_mat</span>
    <span class="k">def</span> <span class="nf">dNdeta</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">xi</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Generates a gradient of the shape-function value weighting matrix.</span>
<span class="sd">        </span>
<span class="sd">        Intended primarily as a private method but left public, this method</span>
<span class="sd">        generates the gradient of the weighting matrix with respect to eta and</span>
<span class="sd">        is used to interpolate values within the element. This method however</span>
<span class="sd">        is mainly reserved for the cross-sectional analysis process.</span>
<span class="sd">        </span>
<span class="sd">        :Args:</span>
<span class="sd">        </span>
<span class="sd">        - `eta (float)`: The eta coordinate in the master coordinate domain.*</span>
<span class="sd">        - `xi (float)`: The xi coordinate in the master coordinate domain.*</span>
<span class="sd">            </span>
<span class="sd">        :Returns:</span>
<span class="sd">        </span>
<span class="sd">        - `dNdeta_mat (3x12 np.array[float])`: The gradient of the shape-</span>
<span class="sd">            function value weighting matrix with respect to eta.</span>
<span class="sd">            </span>
<span class="sd">        .. Note:: Xi and eta can both vary between -1 and 1 respectively.</span>
<span class="sd">        </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">dNdeta_mat</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">([</span><span class="mi">3</span><span class="p">,</span><span class="mi">12</span><span class="p">])</span>
        <span class="n">dN1deta</span> <span class="o">=</span> <span class="o">-.</span><span class="mi">25</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">xi</span><span class="p">)</span>
        <span class="n">dN2deta</span> <span class="o">=</span> <span class="o">-.</span><span class="mi">25</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">xi</span><span class="p">)</span>
        <span class="n">dN3deta</span> <span class="o">=</span> <span class="o">.</span><span class="mi">25</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">xi</span><span class="p">)</span>
        <span class="n">dN4deta</span> <span class="o">=</span> <span class="o">.</span><span class="mi">25</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">xi</span><span class="p">)</span>
        <span class="n">dNdeta_mat</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">dNdeta_mat</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">dNdeta_mat</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">dN1deta</span>
        <span class="n">dNdeta_mat</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="n">dNdeta_mat</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span><span class="p">]</span> <span class="o">=</span> <span class="n">dNdeta_mat</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">5</span><span class="p">]</span> <span class="o">=</span> <span class="n">dN2deta</span>
        <span class="n">dNdeta_mat</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">6</span><span class="p">]</span> <span class="o">=</span> <span class="n">dNdeta_mat</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">7</span><span class="p">]</span> <span class="o">=</span> <span class="n">dNdeta_mat</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">8</span><span class="p">]</span> <span class="o">=</span> <span class="n">dN3deta</span>
        <span class="n">dNdeta_mat</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">9</span><span class="p">]</span> <span class="o">=</span> <span class="n">dNdeta_mat</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">10</span><span class="p">]</span> <span class="o">=</span> <span class="n">dNdeta_mat</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">11</span><span class="p">]</span> <span class="o">=</span> <span class="n">dN4deta</span>
        <span class="k">return</span> <span class="n">dNdeta_mat</span>
<div class="viewcode-block" id="CQUADX.resetResults"><a class="viewcode-back" href="../../structures.html#AeroComBAT.Structures.CQUADX.resetResults">[docs]</a>    <span class="k">def</span> <span class="nf">resetResults</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Resets stress, strain and warping displacement results.</span>
<span class="sd">        </span>
<span class="sd">        Method is mainly intended to prevent results for one analysis or</span>
<span class="sd">        sampling location in the matrix to effect the results in another.</span>
<span class="sd">        </span>
<span class="sd">        :Args:</span>
<span class="sd">        </span>
<span class="sd">        - None</span>
<span class="sd">            </span>
<span class="sd">        :Returns:</span>
<span class="sd">        </span>
<span class="sd">        - None</span>
<span class="sd">            </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c"># Initialize array for element warping displacement results</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">U</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">12</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span>
        <span class="c"># Initialize strain vectors</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Eps</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">6</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span>
        <span class="c"># Initialize stress vectors</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Sig</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">6</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span></div>
<div class="viewcode-block" id="CQUADX.getDeformed"><a class="viewcode-back" href="../../structures.html#AeroComBAT.Structures.CQUADX.getDeformed">[docs]</a>    <span class="k">def</span> <span class="nf">getDeformed</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns the warping displacement of the element.</span>
<span class="sd">        </span>
<span class="sd">        Provided an analysis has been conducted, this method</span>
<span class="sd">        returns 3 2x2 np.array[float] containing the element warped</span>
<span class="sd">        displacements in the local xsect CSYS.</span>
<span class="sd">        </span>
<span class="sd">        :Args:</span>
<span class="sd">        </span>
<span class="sd">        - `warpScale (float)`: A multiplicative scaling factor intended to</span>
<span class="sd">            exagerate the warping displacement within the cross-section.</span>
<span class="sd">            </span>
<span class="sd">        :Returns:</span>
<span class="sd">        </span>
<span class="sd">        - `xdef (2x2 np.array[float])`: warped x-coordinates at the four corner</span>
<span class="sd">            points.</span>
<span class="sd">        - `ydef (2x2 np.array[float])`: warped y-coordinates at the four corner</span>
<span class="sd">            points.</span>
<span class="sd">        - `zdef (2x2 np.array[float])`: warped z-coordinates at the four corner</span>
<span class="sd">            points.</span>
<span class="sd">            </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c"># Initialize the scaled value of the </span>
        <span class="n">warpScale</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s">&#39;warpScale&#39;</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
        <span class="c"># Initialize the full warping displacement vector</span>
        <span class="n">utmp</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">U</span>
        <span class="c"># Initialize the local node ordering</span>
        <span class="n">nodeInd</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]])</span>
        <span class="c"># Initialize the blank x-displacement 2x2 array</span>
        <span class="n">xdef</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span>
        <span class="c"># Initialize the blank y-displacement 2x2 array</span>
        <span class="n">ydef</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span>
        <span class="c"># Initialize the blank z-displacement 2x2 array</span>
        <span class="n">zdef</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span>
        <span class="c"># For all four points</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">):</span>
                <span class="c"># Determine the local node index</span>
                <span class="n">tmpInd</span> <span class="o">=</span> <span class="n">nodeInd</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span>
                <span class="c"># Determine the rigid coordinate at the point</span>
                <span class="n">x0</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">nodes</span><span class="p">[</span><span class="n">tmpInd</span><span class="p">]</span><span class="o">.</span><span class="n">x</span>
                <span class="c"># Add the warping displacement and the rigid coordinate</span>
                <span class="n">xdef</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">warpScale</span><span class="o">*</span><span class="n">utmp</span><span class="p">[</span><span class="mi">3</span><span class="o">*</span><span class="n">tmpInd</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="n">x0</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                <span class="n">ydef</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">warpScale</span><span class="o">*</span><span class="n">utmp</span><span class="p">[</span><span class="mi">3</span><span class="o">*</span><span class="n">tmpInd</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="n">x0</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
                <span class="n">zdef</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">warpScale</span><span class="o">*</span><span class="n">utmp</span><span class="p">[</span><span class="mi">3</span><span class="o">*</span><span class="n">tmpInd</span><span class="o">+</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="n">x0</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
        <span class="c"># Return the 3 displacement arrays</span>
        <span class="k">return</span> <span class="n">xdef</span><span class="p">,</span><span class="n">ydef</span><span class="p">,</span><span class="n">zdef</span>
    </div>
<div class="viewcode-block" id="CQUADX.getStressState"><a class="viewcode-back" href="../../structures.html#AeroComBAT.Structures.CQUADX.getStressState">[docs]</a>    <span class="k">def</span> <span class="nf">getStressState</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">crit</span><span class="o">=</span><span class="s">&#39;VonMis&#39;</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns the stress state of the element.</span>
<span class="sd">        </span>
<span class="sd">        Provided an analysis has been conducted, this method</span>
<span class="sd">        returns a 2x2 np.array[float] containing the element the 3D stress</span>
<span class="sd">        state at the four guass points by default.*</span>
<span class="sd">        </span>
<span class="sd">        :Args:</span>
<span class="sd">        </span>
<span class="sd">        - `crit (str)`: Determines what criteria is used to evaluate the 3D</span>
<span class="sd">            stress state at the sample points within the element. By</span>
<span class="sd">            default the Von Mises stress is returned. Currently supported</span>
<span class="sd">            options include: Von Mises (&#39;VonMis&#39;), maximum principle stress</span>
<span class="sd">            (&#39;MaxPrin&#39;), the minimum principle stress (&#39;MinPrin&#39;), and the</span>
<span class="sd">            local cross-section stress states &#39;sig_xx&#39; where the subindeces can</span>
<span class="sd">            go from 1-3. The keyword &#39;none&#39; is also an option.</span>
<span class="sd">            </span>
<span class="sd">        :Returns:</span>
<span class="sd">        </span>
<span class="sd">        - `sigData (2x2 np.array[float])`: The stress state evaluated at four</span>
<span class="sd">            points within the CQUADX element.</span>
<span class="sd">            </span>
<span class="sd">        .. Note:: The XSect method calcWarpEffects is what determines where strain</span>
<span class="sd">        and stresses are sampled. By default it samples this information at the</span>
<span class="sd">        Guass points where the stress/strain will be most accurate.</span>
<span class="sd">        </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c">#TODO: Make this method the plotting method so that stress can be</span>
        <span class="c"># written to a file using another method.</span>
        <span class="c">#TODO: Add routines for the determining composite failure criteria</span>
        <span class="c"># such as the Tsai-Wu, Hoffman, or Puc criteria</span>
        <span class="c"># Initialize the last saved 3D stress state</span>
        <span class="n">sigState</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Sig</span>
        <span class="c"># Initialize the local node ordering</span>
        <span class="n">nodeInd</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]])</span>
        <span class="c"># Initialize the blank stress 2x2 array</span>
        <span class="n">sigData</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span>
        <span class="c"># For all four points</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">):</span>
                <span class="c"># Determine the local node index</span>
                <span class="n">tmpInd</span> <span class="o">=</span> <span class="n">nodeInd</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span>
                <span class="c"># Determine what criteria is to be used to evaluate the stress</span>
                <span class="c"># State</span>
                <span class="k">if</span> <span class="n">crit</span><span class="o">==</span><span class="s">&#39;VonMis&#39;</span><span class="p">:</span>
                    <span class="n">sigData</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mf">0.5</span><span class="o">*</span><span class="p">((</span><span class="n">sigState</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="n">tmpInd</span><span class="p">]</span><span class="o">-</span><span class="n">sigState</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="n">tmpInd</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span><span class="o">+</span>\
                        <span class="p">(</span><span class="n">sigState</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="n">tmpInd</span><span class="p">]</span><span class="o">-</span><span class="n">sigState</span><span class="p">[</span><span class="mi">5</span><span class="p">,</span><span class="n">tmpInd</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span><span class="o">+</span>\
                        <span class="p">(</span><span class="n">sigState</span><span class="p">[</span><span class="mi">5</span><span class="p">,</span><span class="n">tmpInd</span><span class="p">]</span><span class="o">-</span><span class="n">sigState</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="n">tmpInd</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span><span class="o">+</span>\
                        <span class="mi">6</span><span class="o">*</span><span class="p">(</span><span class="n">sigState</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="n">tmpInd</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="o">+</span><span class="n">sigState</span><span class="p">[</span><span class="mi">3</span><span class="p">,</span><span class="n">tmpInd</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="o">+</span><span class="n">sigState</span><span class="p">[</span><span class="mi">4</span><span class="p">,</span><span class="n">tmpInd</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="p">)))</span>
                <span class="k">elif</span> <span class="n">crit</span><span class="o">==</span><span class="s">&#39;MaxPrin&#39;</span><span class="p">:</span>
                    <span class="n">tmpSig</span> <span class="o">=</span> <span class="n">sigState</span><span class="p">[:,</span><span class="n">tmpInd</span><span class="p">]</span>
                    <span class="n">tmpSigTens</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="n">tmpSig</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">tmpSig</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span><span class="n">tmpSig</span><span class="p">[</span><span class="mi">3</span><span class="p">]],</span>\
                        <span class="p">[</span><span class="n">tmpSig</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span><span class="n">tmpSig</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">tmpSig</span><span class="p">[</span><span class="mi">4</span><span class="p">]],</span>\
                        <span class="p">[</span><span class="n">tmpSig</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span><span class="n">tmpSig</span><span class="p">[</span><span class="mi">4</span><span class="p">],</span><span class="n">tmpSig</span><span class="p">[</span><span class="mi">5</span><span class="p">]]])</span>
                    <span class="n">eigs</span><span class="p">,</span><span class="n">trash</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">eig</span><span class="p">(</span><span class="n">tmpSigTens</span><span class="p">)</span>
                    <span class="n">sigData</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">eigs</span><span class="p">)</span>
                <span class="k">elif</span> <span class="n">crit</span><span class="o">==</span><span class="s">&#39;MinPrin&#39;</span><span class="p">:</span>
                    <span class="n">tmpSig</span> <span class="o">=</span> <span class="n">sigState</span><span class="p">[:,</span><span class="n">tmpInd</span><span class="p">]</span>
                    <span class="n">tmpSigTens</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="n">tmpSig</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">tmpSig</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span><span class="n">tmpSig</span><span class="p">[</span><span class="mi">3</span><span class="p">]],</span>\
                        <span class="p">[</span><span class="n">tmpSig</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span><span class="n">tmpSig</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">tmpSig</span><span class="p">[</span><span class="mi">4</span><span class="p">]],</span>\
                        <span class="p">[</span><span class="n">tmpSig</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span><span class="n">tmpSig</span><span class="p">[</span><span class="mi">4</span><span class="p">],</span><span class="n">tmpSig</span><span class="p">[</span><span class="mi">5</span><span class="p">]]])</span>
                    <span class="n">eigs</span><span class="p">,</span><span class="n">trash</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">eig</span><span class="p">(</span><span class="n">tmpSigTens</span><span class="p">)</span>
                    <span class="n">sigData</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">eigs</span><span class="p">)</span>
                <span class="k">elif</span> <span class="n">crit</span><span class="o">==</span><span class="s">&#39;sig_11&#39;</span><span class="p">:</span>
                    <span class="n">tmpSig</span> <span class="o">=</span> <span class="n">sigState</span><span class="p">[:,</span><span class="n">tmpInd</span><span class="p">]</span>
                    <span class="n">sigData</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">tmpSig</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                <span class="k">elif</span> <span class="n">crit</span><span class="o">==</span><span class="s">&#39;sig_22&#39;</span><span class="p">:</span>
                    <span class="n">tmpSig</span> <span class="o">=</span> <span class="n">sigState</span><span class="p">[:,</span><span class="n">tmpInd</span><span class="p">]</span>
                    <span class="n">sigData</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">tmpSig</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
                <span class="k">elif</span> <span class="n">crit</span><span class="o">==</span><span class="s">&#39;sig_12&#39;</span><span class="p">:</span>
                    <span class="n">tmpSig</span> <span class="o">=</span> <span class="n">sigState</span><span class="p">[:,</span><span class="n">tmpInd</span><span class="p">]</span>
                    <span class="n">sigData</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">tmpSig</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
                <span class="k">elif</span> <span class="n">crit</span><span class="o">==</span><span class="s">&#39;sig_13&#39;</span><span class="p">:</span>
                    <span class="n">tmpSig</span> <span class="o">=</span> <span class="n">sigState</span><span class="p">[:,</span><span class="n">tmpInd</span><span class="p">]</span>
                    <span class="n">sigData</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">tmpSig</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>
                <span class="k">elif</span> <span class="n">crit</span><span class="o">==</span><span class="s">&#39;sig_23&#39;</span><span class="p">:</span>
                    <span class="n">tmpSig</span> <span class="o">=</span> <span class="n">sigState</span><span class="p">[:,</span><span class="n">tmpInd</span><span class="p">]</span>
                    <span class="n">sigData</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">tmpSig</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span>
                <span class="k">elif</span> <span class="n">crit</span><span class="o">==</span><span class="s">&#39;sig_33&#39;</span><span class="p">:</span>
                    <span class="n">tmpSig</span> <span class="o">=</span> <span class="n">sigState</span><span class="p">[:,</span><span class="n">tmpInd</span><span class="p">]</span>
                    <span class="n">sigData</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">tmpSig</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span>
                <span class="k">elif</span> <span class="n">crit</span><span class="o">==</span><span class="s">&#39;none&#39;</span><span class="p">:</span>
                    <span class="n">sigData</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.</span>
                
                    
        <span class="k">return</span> <span class="n">sigData</span>
    </div>
<div class="viewcode-block" id="CQUADX.printSummary"><a class="viewcode-back" href="../../structures.html#AeroComBAT.Structures.CQUADX.printSummary">[docs]</a>    <span class="k">def</span> <span class="nf">printSummary</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">nodes</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;A method for printing a summary of the CQUADX element.</span>
<span class="sd">        </span>
<span class="sd">        Prints out a tabulated form of the element ID, as well as the node ID&#39;s</span>
<span class="sd">        referenced by the element.</span>
<span class="sd">        </span>
<span class="sd">        :Args:</span>
<span class="sd">        </span>
<span class="sd">        - None</span>
<span class="sd">            </span>
<span class="sd">        :Returns:</span>
<span class="sd">        </span>
<span class="sd">        - `summary (str)`: Prints the tabulated EID, node IDs and material IDs</span>
<span class="sd">            associated with the CQUADX element.</span>
<span class="sd">            </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">print</span><span class="p">(</span><span class="s">&#39;CQUADX Summary:&#39;</span><span class="p">)</span>
        <span class="n">headers</span> <span class="o">=</span> <span class="p">(</span><span class="s">&#39;EID&#39;</span><span class="p">,</span><span class="s">&#39;NID 1&#39;</span><span class="p">,</span><span class="s">&#39;NID 2&#39;</span><span class="p">,</span><span class="s">&#39;NID 3&#39;</span><span class="p">,</span><span class="s">&#39;NID 4&#39;</span><span class="p">,</span><span class="s">&#39;MID&#39;</span><span class="p">)</span>
        <span class="k">print</span><span class="p">(</span><span class="n">tabulate</span><span class="p">([[</span><span class="bp">self</span><span class="o">.</span><span class="n">EID</span><span class="p">]</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">NIDs</span><span class="o">+</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">MID</span><span class="p">]],</span><span class="n">headers</span><span class="p">,</span><span class="n">tablefmt</span><span class="o">=</span><span class="s">&quot;fancy_grid&quot;</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">nodes</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">node</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">nodes</span><span class="p">:</span>
                <span class="n">node</span><span class="o">.</span><span class="n">printSummary</span><span class="p">()</span></div>
    <span class="k">def</span> <span class="nf">clearXSectionMatricies</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Clears large matricies associated with cross-sectional analaysis.</span>
<span class="sd">        </span>
<span class="sd">        Intended primarily as a private method but left public, this method</span>
<span class="sd">        clears the matricies associated with cross-sectional analysis. This is</span>
<span class="sd">        mainly done as a way of saving memory.</span>
<span class="sd">        </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Ae</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Ce</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Ee</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Le</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Me</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Re</span> <span class="o">=</span> <span class="bp">None</span>
</div>
<div class="viewcode-block" id="MaterialLib"><a class="viewcode-back" href="../../structures.html#AeroComBAT.Structures.MaterialLib">[docs]</a><span class="k">class</span> <span class="nc">MaterialLib</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Creates a material library object.</span>
<span class="sd">    </span>
<span class="sd">    This material library holds the materials to be used for any type of</span>
<span class="sd">    analysis. Furthermore, it can be used to generate new material objects</span>
<span class="sd">    to be automatically stored within it. See the Material class for suported</span>
<span class="sd">    material types.</span>
<span class="sd">    </span>
<span class="sd">    :Attributes:</span>
<span class="sd">    </span>
<span class="sd">    - `matDict (dict)`: A dictionary which stores material objects as the</span>
<span class="sd">        values with the MIDs as the associated keys.</span>
<span class="sd">        </span>
<span class="sd">    :Methods:</span>
<span class="sd">    </span>
<span class="sd">    - `addMat`: Adds a material to the MaterialLib object dictionary.</span>
<span class="sd">    - `getMat`: Returns a material object provided an MID</span>
<span class="sd">    - `printSummary`: Prints a summary of all of the materials held within the</span>
<span class="sd">        matDict dictionary.</span>
<span class="sd">        </span>
<span class="sd">    &quot;&quot;&quot;</span>
<div class="viewcode-block" id="MaterialLib.__init__"><a class="viewcode-back" href="../../structures.html#AeroComBAT.Structures.MaterialLib.__init__">[docs]</a>    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Initialize MaterialLib object.</span>
<span class="sd">        </span>
<span class="sd">        The initialization method is mainly used to initialize a dictionary</span>
<span class="sd">        which houses material objects.</span>
<span class="sd">        </span>
<span class="sd">        :Args:</span>
<span class="sd">        </span>
<span class="sd">        - None</span>
<span class="sd">            </span>
<span class="sd">        :Returns:</span>
<span class="sd">        </span>
<span class="sd">        - None</span>
<span class="sd">            </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">matDict</span> <span class="o">=</span> <span class="p">{}</span></div>
<div class="viewcode-block" id="MaterialLib.addMat"><a class="viewcode-back" href="../../structures.html#AeroComBAT.Structures.MaterialLib.addMat">[docs]</a>    <span class="k">def</span> <span class="nf">addMat</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">MID</span><span class="p">,</span> <span class="n">mat_name</span><span class="p">,</span> <span class="n">mat_type</span><span class="p">,</span> <span class="n">mat_constants</span><span class="p">,</span><span class="n">mat_t</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Add a material to the MaterialLib object.</span>
<span class="sd">        </span>
<span class="sd">        This is the primary method of the class, used to create new material</span>
<span class="sd">        obects and then add them to the library for later use.</span>
<span class="sd">        </span>
<span class="sd">        :Args:</span>
<span class="sd">        </span>
<span class="sd">        - `MID (int)`: Material ID.</span>
<span class="sd">        - `name (str)`: Name of the material.</span>
<span class="sd">        - `matType (str)`: The type of the material. Supported material types</span>
<span class="sd">            are &quot;iso&quot;, &quot;trans_iso&quot;, and &quot;ortho&quot;.</span>
<span class="sd">        - `mat_constants (1xX Array[Float])`: The requisite number of material</span>
<span class="sd">            constants required for any structural analysis. Note, this</span>
<span class="sd">            array includes the material density. For example, an isotropic</span>
<span class="sd">            material needs 2 elastic material constants, so the total</span>
<span class="sd">            length of mat_constants would be 3, 2 elastic constants and the</span>
<span class="sd">            density.</span>
<span class="sd">        - `mat_t (float)`: The thickness of 1-ply of the material</span>
<span class="sd">        - `th (1x3 Array[float])`: The angles about which the material can be</span>
<span class="sd">            rotated when it is initialized. In degrees.</span>
<span class="sd">        - `overwrite (bool)`: Input used in order to define whether the</span>
<span class="sd">            material being added can overwrite another material already</span>
<span class="sd">            held by the material library with the same MID.</span>
<span class="sd">            </span>
<span class="sd">        :Returns:</span>
<span class="sd">        </span>
<span class="sd">        - None</span>
<span class="sd">            </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c"># Whether a material has the right to overwrite other materials</span>
        <span class="n">overwrite</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s">&#39;overwrite&#39;</span><span class="p">,</span><span class="bp">False</span><span class="p">)</span>
        <span class="c"># Optional argument for material direction rotation</span>
        <span class="n">th</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s">&#39;th&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
        <span class="c"># Check to see if there is a danger of overwriting a material</span>
        <span class="k">if</span> <span class="n">MID</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">matDict</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">overwrite</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">StandardError</span><span class="p">(</span><span class="s">&#39;You may not overwrite a library material&#39;</span><span class="o">+</span>\
                <span class="s">&#39; entry without adding the optional argument overwrite=True&#39;</span><span class="p">)</span>
        <span class="c"># Save material</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">matDict</span><span class="p">[</span><span class="n">MID</span><span class="p">]</span> <span class="o">=</span> <span class="n">Material</span><span class="p">(</span><span class="n">MID</span><span class="p">,</span> <span class="n">mat_name</span><span class="p">,</span> <span class="n">mat_type</span><span class="p">,</span> <span class="n">mat_constants</span><span class="p">,</span><span class="n">mat_t</span><span class="p">,</span><span class="n">th</span><span class="o">=</span><span class="n">th</span><span class="p">)</span></div>
<div class="viewcode-block" id="MaterialLib.getMat"><a class="viewcode-back" href="../../structures.html#AeroComBAT.Structures.MaterialLib.getMat">[docs]</a>    <span class="k">def</span> <span class="nf">getMat</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">MID</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Method that returns a material from the material libary</span>
<span class="sd">        </span>
<span class="sd">        :Args:</span>
<span class="sd">        </span>
<span class="sd">        - `MID (int)`: The ID of the material which is desired</span>
<span class="sd">            </span>
<span class="sd">        :Returns:</span>
<span class="sd">        </span>
<span class="sd">        - `(obj): A material object associated with the key MID</span>
<span class="sd">            </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">MID</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">matDict</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="k">raise</span> <span class="ne">KeyError</span><span class="p">(</span><span class="s">&#39;The MID provided is not linked with any materials&#39;</span><span class="o">+</span>
                <span class="s">&#39;within the supplied material library.&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">matDict</span><span class="p">[</span><span class="n">MID</span><span class="p">]</span></div>
<div class="viewcode-block" id="MaterialLib.printSummary"><a class="viewcode-back" href="../../structures.html#AeroComBAT.Structures.MaterialLib.printSummary">[docs]</a>    <span class="k">def</span> <span class="nf">printSummary</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Prints summary of all Materials in MaterialLib</span>
<span class="sd">        </span>
<span class="sd">        A method used to print out tabulated summary of all of the materials</span>
<span class="sd">        held within the material library object.</span>
<span class="sd">        </span>
<span class="sd">        :Args:</span>
<span class="sd">        </span>
<span class="sd">        - None</span>
<span class="sd">            </span>
<span class="sd">        :Returns:</span>
<span class="sd">        </span>
<span class="sd">        - (str): A tabulated summary of the materials.</span>
<span class="sd">            </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">matDict</span><span class="p">)</span><span class="o">==</span><span class="mi">0</span><span class="p">:</span>
            <span class="k">print</span><span class="p">(</span><span class="s">&#39;The material library is currently empty.</span><span class="se">\n</span><span class="s">&#39;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">print</span><span class="p">(</span><span class="s">&#39;The materials are:&#39;</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">mat</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">matDict</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">matDict</span><span class="p">[</span><span class="n">mat</span><span class="p">]</span><span class="o">.</span><span class="n">printSummary</span><span class="p">()</span>
        
        </div></div>
<div class="viewcode-block" id="Ply"><a class="viewcode-back" href="../../structures.html#AeroComBAT.Structures.Ply">[docs]</a><span class="k">class</span> <span class="nc">Ply</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Creates a CLT ply object.</span>
<span class="sd">    </span>
<span class="sd">    A class inspired by CLT, this class can be used to generate laminates</span>
<span class="sd">    to be used for CLT or cross-sectional analysis. It is likely that ply</span>
<span class="sd">    objects won&#39;t be created individually and then assembeled into a lamiante.</span>
<span class="sd">    More likely is that the plies will be generated within the laminate object.</span>
<span class="sd">    It should also be noted that it is assumed that the materials used are</span>
<span class="sd">    effectively at most transversely isotropic.</span>
<span class="sd">    </span>
<span class="sd">    :Attributes:</span>
<span class="sd">    </span>
<span class="sd">    - `E1 (float)`: Stiffness in the fiber direction.</span>
<span class="sd">    - `E2 (float)`: Stiffness transverse to the fiber direction.</span>
<span class="sd">    - `nu_12 (float)`: In plane poisson ratio.</span>
<span class="sd">    - `G_12 (float)`: In plane shear modulus.</span>
<span class="sd">    - `t (float)`: Thickness of the ply.</span>
<span class="sd">    - `Qbar (1x6 np.array[float])`: The terms in the rotated, reduced stiffness</span>
<span class="sd">        matrix. Ordering is as follows: [Q11,Q12,Q16,Q22,Q26,Q66]</span>
<span class="sd">    - `MID (int)`: An integer refrencing the material ID used for the</span>
<span class="sd">        constitutive relations.</span>
<span class="sd">    - `th (float)`: The angle about which the fibers are rotated in the plane</span>
<span class="sd">        in degrees.</span>
<span class="sd">        </span>
<span class="sd">    :Methods:</span>
<span class="sd">    </span>
<span class="sd">    - `genQ`: Given the in-plane stiffnesses used by the material of the ply,</span>
<span class="sd">        the method calculates the terms of ther reduced stiffness matrix.</span>
<span class="sd">    - `printSummary`: This prints out a summary of the object, including</span>
<span class="sd">        thickness, referenced MID and in plane angle orientation theta in</span>
<span class="sd">        degrees.</span>
<span class="sd">        </span>
<span class="sd">    &quot;&quot;&quot;</span>
<div class="viewcode-block" id="Ply.__init__"><a class="viewcode-back" href="../../structures.html#AeroComBAT.Structures.Ply.__init__">[docs]</a>    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">Material</span><span class="p">,</span><span class="n">th</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Initializes the ply.</span>
<span class="sd">        </span>
<span class="sd">        This method initializes information about the ply such as in-plane</span>
<span class="sd">        stiffness repsonse.</span>
<span class="sd">        </span>
<span class="sd">        :Args:</span>
<span class="sd">        </span>
<span class="sd">        - `Material (obj)`: A material object, most likely coming from a</span>
<span class="sd">            material library.</span>
<span class="sd">        - `th (float)`: The angle about which the fibers are rotated in the</span>
<span class="sd">            plane in degrees.</span>
<span class="sd">            </span>
<span class="sd">        :Returns:</span>
<span class="sd">        </span>
<span class="sd">        - None</span>
<span class="sd">            </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">E1</span> <span class="o">=</span> <span class="n">Material</span><span class="o">.</span><span class="n">E1</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">E2</span> <span class="o">=</span> <span class="n">Material</span><span class="o">.</span><span class="n">E2</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">nu_12</span> <span class="o">=</span> <span class="n">Material</span><span class="o">.</span><span class="n">nu_12</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">G_12</span> <span class="o">=</span> <span class="n">Material</span><span class="o">.</span><span class="n">G_12</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">t</span> <span class="o">=</span> <span class="n">Material</span><span class="o">.</span><span class="n">t</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Q</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">genQ</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">E1</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">E2</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">nu_12</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">G_12</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Qbar</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">rotRedStiffMat</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Q</span><span class="p">,</span><span class="n">th</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">QbarMat</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="bp">self</span><span class="o">.</span><span class="n">Qbar</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="bp">self</span><span class="o">.</span><span class="n">Qbar</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="bp">self</span><span class="o">.</span><span class="n">Qbar</span><span class="p">[</span><span class="mi">2</span><span class="p">]],</span>\
                                 <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">Qbar</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="bp">self</span><span class="o">.</span><span class="n">Qbar</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span><span class="bp">self</span><span class="o">.</span><span class="n">Qbar</span><span class="p">[</span><span class="mi">4</span><span class="p">]],</span>\
                                 <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">Qbar</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span><span class="bp">self</span><span class="o">.</span><span class="n">Qbar</span><span class="p">[</span><span class="mi">4</span><span class="p">],</span><span class="bp">self</span><span class="o">.</span><span class="n">Qbar</span><span class="p">[</span><span class="mi">5</span><span class="p">]]])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">MID</span> <span class="o">=</span> <span class="n">Material</span><span class="o">.</span><span class="n">MID</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">th</span> <span class="o">=</span> <span class="n">th</span></div>
<div class="viewcode-block" id="Ply.genQ"><a class="viewcode-back" href="../../structures.html#AeroComBAT.Structures.Ply.genQ">[docs]</a>    <span class="k">def</span> <span class="nf">genQ</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">E1</span><span class="p">,</span><span class="n">E2</span><span class="p">,</span><span class="n">nu12</span><span class="p">,</span><span class="n">G12</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;A method for calculating the reduced compliance of the ply.</span>
<span class="sd">        </span>
<span class="sd">        Intended primarily as a private method but left public, this method,</span>
<span class="sd">        for those unfarmiliar with CLT, calculates the terms in the reduced stiffness</span>
<span class="sd">        matrix given the in plane ply stiffnesses. It can be thus inferred that</span>
<span class="sd">        this requires the assumption of plane stres. This method is primarily</span>
<span class="sd">        used during the ply instantiation.</span>
<span class="sd">        </span>
<span class="sd">        :Args:</span>
<span class="sd">        </span>
<span class="sd">        - `E1 (float)`: The fiber direction stiffness.</span>
<span class="sd">        - `E2 (float)`: The stiffness transverse to the fibers.</span>
<span class="sd">        - `nu12 (float)`: The in-plane poisson ratio.</span>
<span class="sd">        - `G12 (float)`: The in-plane shear stiffness.</span>
<span class="sd">            </span>
<span class="sd">        :Returns:</span>
<span class="sd">        </span>
<span class="sd">        - `(1x4 np.array[float])`: The terms used in the reduced stiffness</span>
<span class="sd">            matrix. The ordering is: [Q11,Q12,Q22,Q66].</span>
<span class="sd">            </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c"># Calculate the other in-plane poisson ratio.</span>
        <span class="n">nu21</span> <span class="o">=</span> <span class="n">nu12</span><span class="o">*</span><span class="n">E2</span><span class="o">/</span><span class="n">E1</span>
        <span class="k">return</span> <span class="p">[</span><span class="n">E1</span><span class="o">/</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">nu12</span><span class="o">*</span><span class="n">nu21</span><span class="p">),</span><span class="n">nu12</span><span class="o">*</span><span class="n">E2</span><span class="o">/</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">nu12</span><span class="o">*</span><span class="n">nu21</span><span class="p">),</span><span class="n">E2</span><span class="o">/</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">nu12</span><span class="o">*</span><span class="n">nu21</span><span class="p">),</span><span class="n">G12</span><span class="p">]</span></div>
    <span class="k">def</span> <span class="nf">rotRedStiffMat</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">Q</span><span class="p">,</span><span class="n">th</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Calculate terms in the rotated, reduced stiffness matrix.</span>
<span class="sd">        </span>
<span class="sd">        Intended primarily as a private method but left public, this method,</span>
<span class="sd">        this method is used to rotate the plies reduced compliance matrix to</span>
<span class="sd">        the local laminate coordinate system.</span>
<span class="sd">        </span>
<span class="sd">        :Args:</span>
<span class="sd">        </span>
<span class="sd">        - `Q (1x4 np.array[float])`: The reduced compliance array containing</span>
<span class="sd">            [Q11,Q12,Q22,Q66]</span>
<span class="sd">        - `th(float)`: The angle the fibers are to be rotated in plane of the</span>
<span class="sd">            laminate.</span>
<span class="sd">            </span>
<span class="sd">        :Returns:</span>
<span class="sd">        </span>
<span class="sd">        - `(1x6 np.array[float])`: The reduced and rotated stiffness matrix terms</span>
<span class="sd">            for the ply. The ordering is: [Q11, Q12, Q16, Q22, Q26, Q66].</span>
<span class="sd">            </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c"># Convert the angle to radians</span>
        <span class="n">th</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">deg2rad</span><span class="p">(</span><span class="n">th</span><span class="p">)</span>
        <span class="c"># Pre-calculate cosine of theta</span>
        <span class="n">m</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">th</span><span class="p">)</span>
        <span class="c"># Pre-calculate sine of theta</span>
        <span class="n">n</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">th</span><span class="p">)</span>
        <span class="c"># Compute the rotated, reduced stiffness matrix terms:</span>
        <span class="n">Q11bar</span> <span class="o">=</span> <span class="n">Q</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">m</span><span class="o">**</span><span class="mi">4</span><span class="o">+</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="n">Q</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="mi">2</span><span class="o">*</span><span class="n">Q</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span><span class="o">*</span><span class="n">n</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">m</span><span class="o">**</span><span class="mi">2</span><span class="o">+</span><span class="n">Q</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">*</span><span class="n">n</span><span class="o">**</span><span class="mi">4</span>
        <span class="n">Q12bar</span> <span class="o">=</span> <span class="p">(</span><span class="n">Q</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="n">Q</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">-</span><span class="mi">4</span><span class="o">*</span><span class="n">Q</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span><span class="o">*</span><span class="n">n</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">m</span><span class="o">**</span><span class="mi">2</span><span class="o">+</span><span class="n">Q</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="n">n</span><span class="o">**</span><span class="mi">4</span><span class="o">+</span><span class="n">m</span><span class="o">**</span><span class="mi">4</span><span class="p">)</span>
        <span class="n">Q16bar</span> <span class="o">=</span> <span class="p">(</span><span class="n">Q</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">-</span><span class="n">Q</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">Q</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span><span class="o">*</span><span class="n">n</span><span class="o">*</span><span class="n">m</span><span class="o">**</span><span class="mi">3</span><span class="o">+</span><span class="p">(</span><span class="n">Q</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">Q</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">+</span><span class="mi">2</span><span class="o">*</span><span class="n">Q</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span><span class="o">*</span><span class="n">n</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">m</span>
        <span class="n">Q22bar</span> <span class="o">=</span> <span class="n">Q</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">n</span><span class="o">**</span><span class="mi">4</span><span class="o">+</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="n">Q</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="mi">2</span><span class="o">*</span><span class="n">Q</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span><span class="o">*</span><span class="n">n</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">m</span><span class="o">**</span><span class="mi">2</span><span class="o">+</span><span class="n">Q</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">*</span><span class="n">m</span><span class="o">**</span><span class="mi">4</span>
        <span class="n">Q26bar</span> <span class="o">=</span> <span class="p">(</span><span class="n">Q</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">-</span><span class="n">Q</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">Q</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span><span class="o">*</span><span class="n">n</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">m</span><span class="o">+</span><span class="p">(</span><span class="n">Q</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">Q</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">+</span><span class="mi">2</span><span class="o">*</span><span class="n">Q</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span><span class="o">*</span><span class="n">n</span><span class="o">*</span><span class="n">m</span><span class="o">**</span><span class="mi">3</span>
        <span class="n">Q66bar</span> <span class="o">=</span> <span class="p">(</span><span class="n">Q</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="n">Q</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">Q</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">Q</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span><span class="o">*</span><span class="n">n</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">m</span><span class="o">**</span><span class="mi">2</span><span class="o">+</span><span class="n">Q</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="n">n</span><span class="o">**</span><span class="mi">4</span><span class="o">+</span><span class="n">m</span><span class="o">**</span><span class="mi">4</span><span class="p">)</span>
        <span class="k">return</span> <span class="p">[</span><span class="n">Q11bar</span><span class="p">,</span><span class="n">Q12bar</span><span class="p">,</span><span class="n">Q16bar</span><span class="p">,</span><span class="n">Q22bar</span><span class="p">,</span><span class="n">Q26bar</span><span class="p">,</span><span class="n">Q66bar</span><span class="p">]</span>
<div class="viewcode-block" id="Ply.printSummary"><a class="viewcode-back" href="../../structures.html#AeroComBAT.Structures.Ply.printSummary">[docs]</a>    <span class="k">def</span> <span class="nf">printSummary</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Prints a summary of the ply object.</span>
<span class="sd">        </span>
<span class="sd">        A method for printing a summary of the ply properties, such as</span>
<span class="sd">        the material ID, fiber orientation and ply thickness.</span>
<span class="sd">        </span>
<span class="sd">        :Args:</span>
<span class="sd">        </span>
<span class="sd">        - None</span>
<span class="sd">            </span>
<span class="sd">        :Returns:</span>
<span class="sd">        </span>
<span class="sd">        - `(str)`: Printed tabulated summary of the ply.</span>
<span class="sd">            </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">headers</span> <span class="o">=</span> <span class="p">[</span><span class="s">&#39;MID&#39;</span><span class="p">,</span><span class="s">&#39;Theta, degrees&#39;</span><span class="p">,</span><span class="s">&#39;Thickness&#39;</span><span class="p">]</span>
        <span class="k">print</span><span class="p">(</span><span class="n">tabulate</span><span class="p">(([[</span><span class="bp">self</span><span class="o">.</span><span class="n">MID</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">th</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">t</span><span class="p">]]),</span><span class="n">headers</span><span class="p">))</span>
        </div></div>
<div class="viewcode-block" id="Laminate"><a class="viewcode-back" href="../../structures.html#AeroComBAT.Structures.Laminate">[docs]</a><span class="k">class</span> <span class="nc">Laminate</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Creates a CLT laminate object.</span>
<span class="sd">    </span>
<span class="sd">    This class has two main uses. It can either be used for CLT analysis, or it</span>
<span class="sd">    can be used to build up a 2D mesh for a descretized cross-section.</span>
<span class="sd">    </span>
<span class="sd">    :Attributes:</span>
<span class="sd">    </span>
<span class="sd">    - `mesh (NxM np.array[int])`: This 2D array holds NIDs and is used</span>
<span class="sd">        to represent how nodes are organized in the 2D cross-section of</span>
<span class="sd">        the laminate.</span>
<span class="sd">    - `xmesh (NxM np.array[int])`: This 2D array holds the rigid x-coordinates</span>
<span class="sd">        of the nodes within the 2D descretization of the laminate on the</span>
<span class="sd">        local xsect CSYS.</span>
<span class="sd">    - `ymesh (NxM np.array[int])`: This 2D array holds the rigid y-coordinates</span>
<span class="sd">        of the nodes within the 2D descretization of the laminate on the</span>
<span class="sd">        local xsect CSYS.</span>
<span class="sd">    - `zmesh (NxM np.array[int])`: This 2D array holds the rigid z-coordinates</span>
<span class="sd">        of the nodes within the 2D descretization of the laminate on the</span>
<span class="sd">        local xsect CSYS.</span>
<span class="sd">    - `H (float)`: The total laminate thickness.</span>
<span class="sd">    - `rho_A (float)`: The laminate area density.</span>
<span class="sd">    - `plies (1xN array[obj])`: Contains an array of ply objects used to</span>
<span class="sd">        construct the laminate.</span>
<span class="sd">    - `t (1xN array[float])`: An array containing all of the ply thicknesses.</span>
<span class="sd">    - `ABD (6x6 np.array[float])`: The CLT 6x6 matrix relating in-plane strains</span>
<span class="sd">        and curvatures to in-plane force and moment resultants.</span>
<span class="sd">    - `abd (6x6 np.array[float])`: The CLT 6x6 matrix relating in-plane forces</span>
<span class="sd">        and moments resultants to in-plane strains and curvatures.</span>
<span class="sd">    - `z (1xN array[float])`: The z locations of laminate starting and ending</span>
<span class="sd">        points. This system always starts at -H/2 and goes to H/2</span>
<span class="sd">    - `equivMat (obj)`: This is orthotropic material object which exhibits</span>
<span class="sd">        similar in-plane stiffnesses.</span>
<span class="sd">    - `forceRes (1x6 np.array[float])`: The applied or resulting force and</span>
<span class="sd">        moment resultants generated during CLT analysis.</span>
<span class="sd">    - `globalStrain (1x6 np.array[float])`:  The applied or resulting strain</span>
<span class="sd">        and curvatures generated during CLT analysis.</span>
<span class="sd">        </span>
<span class="sd">        </span>
<span class="sd">    :Methods:</span>
<span class="sd">    </span>
<span class="sd">    - `printSummary`: This method prints out defining attributes of the</span>
<span class="sd">        laminate, such as the ABD matrix and layup schedule.</span>
<span class="sd">        </span>
<span class="sd">    &quot;&quot;&quot;</span>
<div class="viewcode-block" id="Laminate.__init__"><a class="viewcode-back" href="../../structures.html#AeroComBAT.Structures.Laminate.__init__">[docs]</a>    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">n_i_tmp</span><span class="p">,</span><span class="n">m_i_tmp</span><span class="p">,</span><span class="n">matLib</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Initializes the Laminate object</span>
<span class="sd">        </span>
<span class="sd">        The way the laminate initialization works is you pass in two-three</span>
<span class="sd">        arrays and a material library. The first array contains information</span>
<span class="sd">        about how many plies you want to stack, the second array determines</span>
<span class="sd">        what material should be used for those plies, and the third array</span>
<span class="sd">        determines at what angle those plies lie. The class was developed this</span>
<span class="sd">        way as a means to fascilitate laminate optimization by quickly changing</span>
<span class="sd">        the number of plies at a given orientation and using a given material.</span>
<span class="sd">        </span>
<span class="sd">        :Args:</span>
<span class="sd">        </span>
<span class="sd">        - `n_i_tmp (1xN array[int])`: An array containing the number of plies</span>
<span class="sd">            using a material at a particular orientation such as:</span>
<span class="sd">            (theta=0,theta=45...)</span>
<span class="sd">        - `m_i_tmp (1xN array[int])`: An array containing the material to be</span>
<span class="sd">            used for the corresponding number of plies in the n_i_tmp array</span>
<span class="sd">        - `matLib (obj)`: The material library holding different material</span>
<span class="sd">            objects.</span>
<span class="sd">        - `sym (bool)`: Whether the laminate is symetric. (False by default)</span>
<span class="sd">        - `th (1xN array[float])`: An array containing the orientation at which</span>
<span class="sd">            the fibers are positioned within the laminate.</span>
<span class="sd">            </span>
<span class="sd">        :Returns:</span>
<span class="sd">        </span>
<span class="sd">        - None</span>
<span class="sd">            </span>
<span class="sd">        .. Note:: If you wanted to create a [0_2/45_2/90_2/-45_2]_s laminate of the</span>
<span class="sd">            same material, you could call laminate as:</span>
<span class="sd">            </span>
<span class="sd">            lam = Laminate([2,2,2,2],[1,1,1,1],matLib,sym=True)</span>
<span class="sd">            </span>
<span class="sd">            Or:</span>
<span class="sd">            </span>
<span class="sd">            lam = Laminate([2,2,2,2],[1,1,1,1],matLib,sym=True,th=[0,45,90,-45])</span>
<span class="sd">            </span>
<span class="sd">            Both of these statements are equivalent. If no theta array is</span>
<span class="sd">            provided and n_i_tmp is not equal to 4, then Laminate will default</span>
<span class="sd">            your fibers to all be running in the 0 degree orientation.</span>
<span class="sd">            </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c"># Initialize attribute handles for latter X-Section meshing assignment</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mesh</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">xmesh</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ymesh</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">zmesh</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="c"># Assign symetric laminate parameter</span>
        <span class="n">sym</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s">&#39;sym&#39;</span><span class="p">,</span><span class="bp">False</span><span class="p">)</span>
        <span class="c"># Verify that n_i_tmp and m_i_tmp are the same length</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">len</span><span class="p">(</span><span class="n">n_i_tmp</span><span class="p">)</span><span class="o">==</span><span class="nb">len</span><span class="p">(</span><span class="n">m_i_tmp</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s">&#39;n_i_tmp and m_i_tmp must be the same length.</span><span class="se">\n</span><span class="s">&#39;</span><span class="p">)</span>
        <span class="c"># If no th provided, assign and n_i_tmp is a 4 length array, make</span>
        <span class="c"># th=[0,45,90,-45].</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">n_i_tmp</span><span class="p">)</span><span class="o">==</span><span class="mi">4</span><span class="p">:</span>
            <span class="n">th</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s">&#39;th&#39;</span><span class="p">,[</span><span class="mi">0</span><span class="p">,</span><span class="mi">45</span><span class="p">,</span><span class="mi">90</span><span class="p">,</span><span class="o">-</span><span class="mi">45</span><span class="p">])</span>
        <span class="c"># Otherwise make th 0 for the length of n_i_tmp</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">th</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s">&#39;th&#39;</span><span class="p">,[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="nb">len</span><span class="p">(</span><span class="n">n_i_tmp</span><span class="p">))</span>
        <span class="c"># If the laminate is symmetric, reflect n_i_tmp and m_i_tmp</span>
        <span class="k">if</span> <span class="n">sym</span><span class="p">:</span>
            <span class="n">n_i_tmp</span> <span class="o">=</span> <span class="n">n_i_tmp</span><span class="o">+</span><span class="n">n_i_tmp</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
            <span class="n">m_i_tmp</span> <span class="o">=</span> <span class="n">m_i_tmp</span><span class="o">+</span><span class="n">m_i_tmp</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
            <span class="n">th</span> <span class="o">=</span> <span class="n">th</span><span class="o">+</span><span class="n">th</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="c">#Calculate the total laminate thickness and area density:</span>
        <span class="n">H</span> <span class="o">=</span> <span class="mf">0.</span>
        <span class="n">rho_A</span> <span class="o">=</span> <span class="mf">0.</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">th</span><span class="p">)):</span>
            <span class="n">tmp_mat</span> <span class="o">=</span> <span class="n">matLib</span><span class="o">.</span><span class="n">matDict</span><span class="p">[</span><span class="n">m_i_tmp</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span>
            <span class="n">H</span> <span class="o">+=</span> <span class="n">tmp_mat</span><span class="o">.</span><span class="n">t</span><span class="o">*</span><span class="n">n_i_tmp</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
            <span class="n">rho_A</span> <span class="o">+=</span> <span class="n">tmp_mat</span><span class="o">.</span><span class="n">t</span><span class="o">*</span><span class="n">n_i_tmp</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">tmp_mat</span><span class="o">.</span><span class="n">rho</span>
        <span class="c"># Assign the total laminate thickness H</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">H</span> <span class="o">=</span> <span class="n">H</span>
        <span class="c"># Assign the laminate area density</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">rho_A</span> <span class="o">=</span> <span class="n">rho_A</span>
        <span class="n">z</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">sum</span><span class="p">(</span><span class="n">n_i_tmp</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">z</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">H</span><span class="o">/</span><span class="mf">2.</span>
        <span class="c"># Initialize ABD Matrix, thermal and moisture unit forces, and the area</span>
        <span class="c"># density.</span>
        <span class="n">ABD</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">6</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span>
        <span class="c">#TODO: Add thermal and moisture support</span>
        <span class="c"># NM_T = np.zeros((6,1))</span>
        <span class="c"># NM_B = np.zeros((6,1))</span>
        <span class="c"># Counter for ease of programming. Could go back and fix:</span>
        <span class="n">c</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="c"># Initialize plies object array</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plies</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="c"># Initialize thickness float array</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">t</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="c"># For all plies</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">th</span><span class="p">)):</span>
            <span class="c"># Select the temporary material for the ith set of plies</span>
            <span class="n">tmp_mat</span> <span class="o">=</span> <span class="n">matLib</span><span class="o">.</span><span class="n">matDict</span><span class="p">[</span><span class="n">m_i_tmp</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span>
            <span class="c"># For the number of times the ply material and orientation are</span>
            <span class="c"># repeated</span>
            <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">n_i_tmp</span><span class="p">[</span><span class="n">i</span><span class="p">]):</span>
                <span class="c"># Create a new ply</span>
                <span class="n">tmp_ply</span> <span class="o">=</span> <span class="n">Ply</span><span class="p">(</span><span class="n">tmp_mat</span><span class="p">,</span><span class="n">th</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
                <span class="c"># Add the new ply to the array of plies held by the laminate</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">plies</span><span class="o">+=</span><span class="p">[</span><span class="n">tmp_ply</span><span class="p">]</span>
                <span class="c"># Update z-position array</span>
                <span class="n">z</span><span class="p">[</span><span class="n">c</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">z</span><span class="p">[</span><span class="n">c</span><span class="p">]</span><span class="o">+</span><span class="n">tmp_mat</span><span class="o">.</span><span class="n">t</span>
                <span class="c"># Add terms to the ABD matrix for laminate reponse</span>
                <span class="n">ABD</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">3</span><span class="p">,</span><span class="mi">0</span><span class="p">:</span><span class="mi">3</span><span class="p">]</span> <span class="o">+=</span> <span class="n">tmp_ply</span><span class="o">.</span><span class="n">QbarMat</span><span class="o">*</span><span class="p">(</span><span class="n">z</span><span class="p">[</span><span class="n">c</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">z</span><span class="p">[</span><span class="n">c</span><span class="p">])</span>
                <span class="n">ABD</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">:</span><span class="mi">6</span><span class="p">]</span> <span class="o">+=</span> <span class="p">(</span><span class="mf">1.</span><span class="o">/</span><span class="mf">2.</span><span class="p">)</span><span class="o">*</span><span class="n">tmp_ply</span><span class="o">.</span><span class="n">QbarMat</span><span class="o">*</span><span class="p">(</span><span class="n">z</span><span class="p">[</span><span class="n">c</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="o">-</span><span class="n">z</span><span class="p">[</span><span class="n">c</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
                <span class="n">ABD</span><span class="p">[</span><span class="mi">3</span><span class="p">:</span><span class="mi">6</span><span class="p">,</span><span class="mi">0</span><span class="p">:</span><span class="mi">3</span><span class="p">]</span> <span class="o">+=</span> <span class="p">(</span><span class="mf">1.</span><span class="o">/</span><span class="mf">2.</span><span class="p">)</span><span class="o">*</span><span class="n">tmp_ply</span><span class="o">.</span><span class="n">QbarMat</span><span class="o">*</span><span class="p">(</span><span class="n">z</span><span class="p">[</span><span class="n">c</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="o">-</span><span class="n">z</span><span class="p">[</span><span class="n">c</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
                <span class="n">ABD</span><span class="p">[</span><span class="mi">3</span><span class="p">:</span><span class="mi">6</span><span class="p">,</span><span class="mi">3</span><span class="p">:</span><span class="mi">6</span><span class="p">]</span> <span class="o">+=</span> <span class="p">(</span><span class="mf">1.</span><span class="o">/</span><span class="mf">3.</span><span class="p">)</span><span class="o">*</span><span class="n">tmp_ply</span><span class="o">.</span><span class="n">QbarMat</span><span class="o">*</span><span class="p">(</span><span class="n">z</span><span class="p">[</span><span class="n">c</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span><span class="o">**</span><span class="mi">3</span><span class="o">-</span><span class="n">z</span><span class="p">[</span><span class="n">c</span><span class="p">]</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span>
                <span class="n">c</span> <span class="o">+=</span> <span class="mi">1</span>
                <span class="c"># Create array of all laminate thicknesses</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">t</span> <span class="o">+=</span> <span class="p">[</span><span class="n">tmp_mat</span><span class="o">.</span><span class="n">t</span><span class="p">]</span>
        <span class="c"># Assign the ABD matrix to the object</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ABD</span> <span class="o">=</span> <span class="n">ABD</span>
        <span class="c"># Assign the inverse of the ABD matrix to the object</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">abd</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">inv</span><span class="p">(</span><span class="n">ABD</span><span class="p">)</span>
        <span class="c"># Assign the coordinates for the laminate (demarking the interfaces</span>
        <span class="c"># between plies within the laminate) to the object</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">z</span> <span class="o">=</span> <span class="n">z</span>
        <span class="c"># Generate equivalent in-plane engineering properties:</span>
        <span class="n">Ex</span> <span class="o">=</span> <span class="p">(</span><span class="n">ABD</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">ABD</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">ABD</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">ABD</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">H</span><span class="p">)</span>
        <span class="n">Ey</span> <span class="o">=</span> <span class="p">(</span><span class="n">ABD</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">ABD</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">ABD</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">ABD</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">H</span><span class="p">)</span>
        <span class="n">G_xy</span> <span class="o">=</span> <span class="n">ABD</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">]</span><span class="o">/</span><span class="n">H</span>
        <span class="n">nu_xy</span> <span class="o">=</span> <span class="n">ABD</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="n">ABD</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span>
        <span class="c"># nuyx = ABD[0,1]/ABD[0,0]</span>
        <span class="n">mat_constants</span> <span class="o">=</span> <span class="p">[</span><span class="n">Ex</span><span class="p">,</span> <span class="n">Ey</span><span class="p">,</span> <span class="n">nu_xy</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="n">G_xy</span><span class="p">,</span> <span class="n">rho_A</span><span class="p">]</span>
        <span class="c"># Create an equivalent material object for the laminate</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">equivMat</span> <span class="o">=</span> <span class="n">Material</span><span class="p">(</span><span class="mi">101</span><span class="p">,</span> <span class="s">&#39;Equiv Lam Mat&#39;</span><span class="p">,</span> <span class="s">&#39;trans_iso&#39;</span><span class="p">,</span> <span class="n">mat_constants</span><span class="p">,</span><span class="n">H</span><span class="p">)</span>
        <span class="c"># Initialize Miscelanoes Parameters:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">forceRes</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">globalStrain</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span></div>
<div class="viewcode-block" id="Laminate.printSummary"><a class="viewcode-back" href="../../structures.html#AeroComBAT.Structures.Laminate.printSummary">[docs]</a>    <span class="k">def</span> <span class="nf">printSummary</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Prints a summary of information about the laminate.</span>
<span class="sd">        </span>
<span class="sd">        This method can print both the ABD matrix and ply information schedule</span>
<span class="sd">        of the laminate.</span>
<span class="sd">        </span>
<span class="sd">        :Args:</span>
<span class="sd">        </span>
<span class="sd">        - `ABD (bool)`: This optional argument asks whether the ABD matrix</span>
<span class="sd">            should be printed.</span>
<span class="sd">        - `decimals (int)`: Should the ABD matrix be printed, python should</span>
<span class="sd">            print up to this many digits after the decimal point.</span>
<span class="sd">        - `plies (bool)`: This optional argument asks whether the ply schedule</span>
<span class="sd">            for the laminate should be printed.</span>
<span class="sd">            </span>
<span class="sd">        :Returns:</span>
<span class="sd">        </span>
<span class="sd">        - None</span>
<span class="sd">            </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">ABD</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s">&#39;ABD&#39;</span><span class="p">,</span><span class="bp">True</span><span class="p">)</span>
        <span class="n">decimals</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s">&#39;decimals&#39;</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span>
        <span class="n">plies</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s">&#39;plies&#39;</span><span class="p">,</span><span class="bp">True</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">ABD</span><span class="p">:</span>
            <span class="k">print</span><span class="p">(</span><span class="s">&#39;ABD Matrix:&#39;</span><span class="p">)</span>
            <span class="k">print</span><span class="p">(</span><span class="n">tabulate</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">around</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ABD</span><span class="p">,</span><span class="n">decimals</span><span class="o">=</span><span class="n">decimals</span><span class="p">),</span><span class="n">tablefmt</span><span class="o">=</span><span class="s">&quot;fancy_grid&quot;</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">plies</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">ply</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">plies</span><span class="p">:</span>
                <span class="n">ply</span><span class="o">.</span><span class="n">printSummary</span><span class="p">()</span></div>
    <span class="k">def</span> <span class="nf">plotLaminate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Plots the laminate using the MayaVi environment.</span>
<span class="sd">        </span>
<span class="sd">        Intended primarily as a private method but left public, this method,</span>
<span class="sd">        Plots a 2D representation of the laminate. This method can only be</span>
<span class="sd">        employed once a cross-section object has been instantiated using the</span>
<span class="sd">        laminate object desired. This method is outdated and generally no</span>
<span class="sd">        longer used.</span>
<span class="sd">        </span>
<span class="sd">        :Args:</span>
<span class="sd">        </span>
<span class="sd">        - `figName (str)`: The name of the figure</span>
<span class="sd">            </span>
<span class="sd">        :Returns:</span>
<span class="sd">        </span>
<span class="sd">        - `(figure)`: MayaVi Figure of the laminate.</span>
<span class="sd">            </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">figName</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s">&#39;figName&#39;</span><span class="p">,</span><span class="s">&#39;Figure&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">()</span><span class="o">*</span><span class="mi">100</span><span class="p">)))</span>
        <span class="n">mlab</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figure</span><span class="o">=</span><span class="n">figName</span><span class="p">)</span>
        <span class="n">mlab</span><span class="o">.</span><span class="n">mesh</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">xmesh</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">ymesh</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">zmesh</span><span class="p">,</span><span class="n">representation</span><span class="o">=</span><span class="s">&#39;wireframe&#39;</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">))</span>
        <span class="n">mlab</span><span class="o">.</span><span class="n">mesh</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">xmesh</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">ymesh</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">zmesh</span><span class="p">)</span>
        </div>
<div class="viewcode-block" id="Mesher"><a class="viewcode-back" href="../../structures.html#AeroComBAT.Structures.Mesher">[docs]</a><span class="k">class</span> <span class="nc">Mesher</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Meshes cross-section objects</span>
<span class="sd">    </span>
<span class="sd">    This class is used to descritize cross-sections provided laminate objects.</span>
<span class="sd">    Currently only two cross-sectional shapes are supported. The first is a</span>
<span class="sd">    box beam using an airfoil outer mold line, and the second is a hollow tube</span>
<span class="sd">    using as many laminates as desired. One of the main results is the</span>
<span class="sd">    population of the nodeDict and elemDict attributes for the cross-section.</span>
<span class="sd">    </span>
<span class="sd">    :Attributes:</span>
<span class="sd">    </span>
<span class="sd">    - None</span>
<span class="sd">        </span>
<span class="sd">    :Methods:</span>
<span class="sd">    </span>
<span class="sd">    - `boxBeam`: Taking several inputs including 4 laminate objects and meshes</span>
<span class="sd">        a 2D box beam cross-section.</span>
<span class="sd">    - `laminate`: Meshes the cross-section of a single laminate.</span>
<span class="sd">    - `cylindricalTube`: Taking several inputs including n laminate objects and</span>
<span class="sd">        meshes a 2D cylindrical tube cross-section.</span>
<span class="sd">    - `rectBoxBeam`: Meshes a rectangular cross-section, but it is more</span>
<span class="sd">        restrictive than boxBeam method. In this method, each of the four</span>
<span class="sd">        laminates must have the same number of plies, each of which are the</span>
<span class="sd">        same thickness.</span>
<span class="sd">        </span>
<span class="sd">    &quot;&quot;&quot;</span>
<div class="viewcode-block" id="Mesher.boxBeam"><a class="viewcode-back" href="../../structures.html#AeroComBAT.Structures.Mesher.boxBeam">[docs]</a>    <span class="k">def</span> <span class="nf">boxBeam</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">xsect</span><span class="p">,</span><span class="n">meshSize</span><span class="p">,</span><span class="n">x0</span><span class="p">,</span><span class="n">xf</span><span class="p">,</span><span class="n">matlib</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Meshes a box beam cross-section.</span>
<span class="sd">        </span>
<span class="sd">        This meshing routine takes several parameters including a cross-section</span>
<span class="sd">        object `xsect`. This cross-section object should also contain the</span>
<span class="sd">        laminate objects used to construct it. There are no restrictions place</span>
<span class="sd">        on these laminates. Furthermore the outer mold line of this cross-</span>
<span class="sd">        section can take the form of any NACA 4-series airfoil. Finally, the</span>
<span class="sd">        convention is that for the four laminates that make up the box-beam,</span>
<span class="sd">        the the first ply in the laminate (which in CLT corresponds to the last</span>
<span class="sd">        ply in the stack) is located on the outside of the box beam. This</span>
<span class="sd">        convention can be seen below:</span>
<span class="sd">        </span>
<span class="sd">        .. image:: images/boxBeamGeom.png</span>
<span class="sd">            :align: center</span>
<span class="sd">        </span>
<span class="sd">        :Args:</span>
<span class="sd">        </span>
<span class="sd">        - `xsect (obj)`: The cross-section object to be meshed.</span>
<span class="sd">        - `meshSize (int)`: The maximum aspect ratio an element can have</span>
<span class="sd">        - `x0 (float)`: The non-dimensional starting point of the cross-section</span>
<span class="sd">            on the airfoil.</span>
<span class="sd">        - `xf (float)`: The non-dimesnional ending point of the cross-section</span>
<span class="sd">            on the airfoil.</span>
<span class="sd">        - `matlib (obj)`: The material library object used to create CQUADX</span>
<span class="sd">            elements.</span>
<span class="sd">            </span>
<span class="sd">        :Returns:</span>
<span class="sd">        </span>
<span class="sd">        - None</span>
<span class="sd">            </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c"># INITIALIZE INPUTS</span>
        <span class="c"># Initialize the node dictionary containing all nodes objects used by</span>
        <span class="c"># the cross-section</span>
        <span class="n">nodeDict</span> <span class="o">=</span> <span class="p">{</span><span class="o">-</span><span class="mi">1</span><span class="p">:</span><span class="bp">None</span><span class="p">}</span>
        <span class="c"># Initialize the element dictionary containing all element objects used</span>
        <span class="c"># by the cross-section</span>
        <span class="n">elemDict</span> <span class="o">=</span> <span class="p">{</span><span class="o">-</span><span class="mi">1</span><span class="p">:</span><span class="bp">None</span><span class="p">}</span>
        <span class="c"># The laminates used to mesh the cross-seciton</span>
        <span class="n">laminates</span> <span class="o">=</span> <span class="n">xsect</span><span class="o">.</span><span class="n">laminates</span>
        <span class="c"># Initialize the airfoil</span>
        <span class="n">Airfoil</span> <span class="o">=</span> <span class="n">xsect</span><span class="o">.</span><span class="n">airfoil</span>
        <span class="c"># The chord length of the airfoil profile</span>
        <span class="n">c</span> <span class="o">=</span> <span class="n">Airfoil</span><span class="o">.</span><span class="n">c</span>
        <span class="c"># Initialize the z location of the cross-section</span>
        <span class="n">zc</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="c"># Initialize the Euler angler rotation about the local xsect z-axis for</span>
        <span class="c"># any the given laminate. Note that individual elements might</span>
        <span class="c"># experience further z-axis orientation if there is curvature in in the</span>
        <span class="c"># OML of the cross-section.</span>
        <span class="n">thz</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">90</span><span class="p">,</span><span class="mi">180</span><span class="p">,</span><span class="mi">270</span><span class="p">]</span>
        
        <span class="c"># CREATE NODES FOR MESH</span>
        <span class="c"># Verify that 4 laminate objects have been provides</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">len</span><span class="p">(</span><span class="n">laminates</span><span class="p">)</span><span class="o">==</span><span class="mi">4</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s">&#39;The box beam cross-section was selected, but 4 &#39;</span>\
                <span class="s">&#39;laminates were not provided&#39;</span><span class="p">)</span>
        <span class="c"># Determine the number of plies per each laminate</span>
        <span class="n">nlam1</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">laminates</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plies</span><span class="p">)</span>
        <span class="n">nlam2</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">laminates</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plies</span><span class="p">)</span>
        <span class="n">nlam3</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">laminates</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">plies</span><span class="p">)</span>
        <span class="n">nlam4</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">laminates</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">plies</span><span class="p">)</span>
        <span class="c"># Define boundary curves:</span>
        <span class="c"># Note, the following curves represent the x-coordinate mesh</span>
        <span class="c"># seeding along key regions, such as the connection region</span>
        <span class="c"># between laminate 1 and 2</span>
        <span class="n">x2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">laminates</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plies</span><span class="p">))</span>
        <span class="n">x4</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">laminates</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">plies</span><span class="p">))</span>
        <span class="n">x3</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">x0</span><span class="o">+</span><span class="n">laminates</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">H</span><span class="o">/</span><span class="n">c</span><span class="p">,</span><span class="n">xf</span><span class="o">-</span><span class="n">laminates</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">H</span><span class="o">/</span><span class="n">c</span><span class="p">,</span><span class="nb">int</span><span class="p">(((</span><span class="n">xf</span><span class="o">-</span><span class="n">laminates</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">H</span><span class="o">/</span><span class="n">c</span><span class="p">)</span>\
            <span class="o">-</span><span class="p">(</span><span class="n">x0</span><span class="o">+</span><span class="n">laminates</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">H</span><span class="o">/</span><span class="n">c</span><span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="n">meshSize</span><span class="o">*</span><span class="nb">min</span><span class="p">(</span><span class="n">laminates</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">t</span><span class="p">)</span><span class="o">/</span><span class="n">c</span><span class="p">)))[</span><span class="mi">1</span><span class="p">:]</span>
        <span class="n">x5</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">x0</span><span class="o">+</span><span class="n">laminates</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">H</span><span class="o">/</span><span class="n">c</span><span class="p">,</span><span class="n">xf</span><span class="o">-</span><span class="n">laminates</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">H</span><span class="o">/</span><span class="n">c</span><span class="p">,</span><span class="nb">int</span><span class="p">(((</span><span class="n">xf</span><span class="o">-</span><span class="n">laminates</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">H</span><span class="o">/</span><span class="n">c</span><span class="p">)</span>\
            <span class="o">-</span><span class="p">(</span><span class="n">x0</span><span class="o">+</span><span class="n">laminates</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">H</span><span class="o">/</span><span class="n">c</span><span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="n">meshSize</span><span class="o">*</span><span class="nb">min</span><span class="p">(</span><span class="n">laminates</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">t</span><span class="p">)</span><span class="o">/</span><span class="n">c</span><span class="p">)))[</span><span class="mi">1</span><span class="p">:]</span>
        <span class="c"># Populates the x-coordinates of the mesh seeding in curves x2 and</span>
        <span class="c"># x4, which are the joint regions between the 4 laminates.</span>
        <span class="n">x2</span> <span class="o">=</span> <span class="n">x0</span><span class="o">+</span><span class="p">(</span><span class="n">laminates</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">z</span><span class="o">+</span><span class="n">laminates</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">H</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="n">c</span>
        <span class="n">x4</span> <span class="o">=</span> <span class="n">xf</span><span class="o">-</span><span class="p">(</span><span class="n">laminates</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">z</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="n">laminates</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">H</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="n">c</span>

        <span class="n">x1top</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">hstack</span><span class="p">((</span><span class="n">x2</span><span class="p">,</span><span class="n">x3</span><span class="p">,</span><span class="n">x4</span><span class="p">[</span><span class="mi">1</span><span class="p">:]))</span>
        <span class="n">x3bot</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">hstack</span><span class="p">((</span><span class="n">x2</span><span class="p">,</span><span class="n">x5</span><span class="p">,</span><span class="n">x4</span><span class="p">[</span><span class="mi">1</span><span class="p">:]))</span>
        
        <span class="c"># GENERATE LAMINATE 1 AND 3 MESHES</span>
        <span class="c"># Create 3 empty numpy arrays for each laminate (we will start with</span>
        <span class="c"># lamiantes 1 and 3). The first is holds node ID&#39;s, the second and</span>
        <span class="c"># third hold the corresponding x and y coordinates of the node</span>
        <span class="n">lam1Mesh</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">1</span><span class="o">+</span><span class="n">nlam1</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">x1top</span><span class="p">)),</span><span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>
        <span class="n">lam1xMesh</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">1</span><span class="o">+</span><span class="n">nlam1</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">x1top</span><span class="p">)))</span>
        <span class="n">lam1yMesh</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">1</span><span class="o">+</span><span class="n">nlam1</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">x1top</span><span class="p">)))</span>
        <span class="n">lam3Mesh</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">1</span><span class="o">+</span><span class="n">nlam3</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">x3bot</span><span class="p">)),</span><span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>
        <span class="n">lam3xMesh</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">1</span><span class="o">+</span><span class="n">nlam3</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">x3bot</span><span class="p">)))</span>
        <span class="n">lam3yMesh</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">1</span><span class="o">+</span><span class="n">nlam3</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">x3bot</span><span class="p">)))</span>
        <span class="c">#Generate the xy points of the top airfoil curve</span>
        <span class="n">xu</span><span class="p">,</span><span class="n">yu</span><span class="p">,</span><span class="n">trash1</span><span class="p">,</span><span class="n">trash2</span> <span class="o">=</span> <span class="n">Airfoil</span><span class="o">.</span><span class="n">points</span><span class="p">(</span><span class="n">x1top</span><span class="p">)</span>
        <span class="c">#Generate the xy points of the bottom airfoil curve</span>
        <span class="n">trash1</span><span class="p">,</span><span class="n">trash2</span><span class="p">,</span><span class="n">xl</span><span class="p">,</span><span class="n">yl</span> <span class="o">=</span> <span class="n">Airfoil</span><span class="o">.</span><span class="n">points</span><span class="p">(</span><span class="n">x3bot</span><span class="p">)</span>
        <span class="c">#Generate the node objects for laminate 1</span>
        <span class="n">ttmp</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="p">(</span><span class="n">laminates</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">z</span><span class="o">+</span><span class="n">laminates</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">H</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">nlam1</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">x1top</span><span class="p">)):</span>
                <span class="c">#Create node/populate mesh array</span>
                <span class="n">newNID</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="nb">max</span><span class="p">(</span><span class="n">nodeDict</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
                <span class="n">lam1Mesh</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">newNID</span>
                <span class="c">#Add node to NID Dictionary</span>
                <span class="n">nodeDict</span><span class="p">[</span><span class="n">newNID</span><span class="p">]</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">newNID</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">xu</span><span class="p">[</span><span class="n">j</span><span class="p">],</span><span class="n">yu</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">-</span><span class="n">ttmp</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">zc</span><span class="p">]))</span>
                <span class="n">lam1xMesh</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">xu</span><span class="p">[</span><span class="n">j</span><span class="p">]</span>
                <span class="n">lam1yMesh</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">yu</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">-</span><span class="n">ttmp</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
        <span class="c">#Generate  the node objects for laminate 3</span>
        <span class="n">ttmp</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="n">laminates</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">z</span><span class="o">+</span><span class="n">laminates</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">H</span><span class="o">/</span><span class="mi">2</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">nlam3</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">x3bot</span><span class="p">)):</span>
                <span class="c">#Create node/populate mesh array</span>
                <span class="n">newNID</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="nb">max</span><span class="p">(</span><span class="n">nodeDict</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
                <span class="n">lam3Mesh</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="o">-</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">newNID</span>
                <span class="c">#Add node to NID Dictionary</span>
                <span class="n">nodeDict</span><span class="p">[</span><span class="n">newNID</span><span class="p">]</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">newNID</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">xl</span><span class="p">[</span><span class="n">j</span><span class="p">],</span><span class="n">yl</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">+</span><span class="n">ttmp</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">zc</span><span class="p">]))</span>
                <span class="n">lam3xMesh</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="o">-</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">xl</span><span class="p">[</span><span class="n">j</span><span class="p">]</span>
                <span class="n">lam3yMesh</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="o">-</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">yl</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">+</span><span class="n">ttmp</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
        <span class="c">#GENERATE LAMINATE 2 AND 4 MESHES</span>
        <span class="c">#Define the mesh seeding for laminate 2</span>
        <span class="n">meshLen2</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(((</span><span class="n">yu</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">-</span><span class="n">laminates</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">H</span><span class="p">)</span><span class="o">-</span><span class="p">(</span><span class="n">yl</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="n">laminates</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">H</span><span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="n">meshSize</span><span class="o">*</span><span class="nb">min</span><span class="p">(</span><span class="n">laminates</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">t</span><span class="p">)))</span>
        <span class="c">#Define the mesh seeding for laminate 4</span>
        <span class="n">meshLen4</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(((</span><span class="n">yu</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">laminates</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">H</span><span class="p">)</span><span class="o">-</span><span class="p">(</span><span class="n">yl</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="n">laminates</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">H</span><span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="n">meshSize</span><span class="o">*</span><span class="nb">min</span><span class="p">(</span><span class="n">laminates</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">t</span><span class="p">)))</span>
        <span class="c"># Create 3 empty numpy arrays for each laminate (we will start with</span>
        <span class="c"># lamiantes 2 and 4). The first is holds node ID&#39;s, the second and</span>
        <span class="c"># third hold the corresponding x and y coordinates of the node</span>
        <span class="n">lam2Mesh</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">meshLen2</span><span class="p">,</span><span class="n">nlam2</span><span class="o">+</span><span class="mi">1</span><span class="p">),</span><span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>
        <span class="n">lam2xMesh</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">meshLen2</span><span class="p">,</span><span class="n">nlam2</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span>
        <span class="n">lam2yMesh</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">meshLen2</span><span class="p">,</span><span class="n">nlam2</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span>
        <span class="n">lam4Mesh</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">meshLen4</span><span class="p">,</span><span class="n">nlam4</span><span class="o">+</span><span class="mi">1</span><span class="p">),</span><span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>
        <span class="n">lam4xMesh</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">meshLen4</span><span class="p">,</span><span class="n">nlam4</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span>
        <span class="n">lam4yMesh</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">meshLen4</span><span class="p">,</span><span class="n">nlam4</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span>
        <span class="c">#Add connectivity nodes for lamiante 2</span>
        <span class="n">lam2Mesh</span><span class="p">[</span><span class="mi">0</span><span class="p">,:]</span> <span class="o">=</span> <span class="n">lam1Mesh</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">:</span><span class="n">nlam2</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">lam2xMesh</span><span class="p">[</span><span class="mi">0</span><span class="p">,:]</span> <span class="o">=</span> <span class="n">lam1xMesh</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">:</span><span class="n">nlam2</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">lam2yMesh</span><span class="p">[</span><span class="mi">0</span><span class="p">,:]</span> <span class="o">=</span> <span class="n">lam1yMesh</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">:</span><span class="n">nlam2</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">lam2Mesh</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,:]</span> <span class="o">=</span> <span class="n">lam3Mesh</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">:</span><span class="n">nlam2</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">lam2xMesh</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,:]</span> <span class="o">=</span> <span class="n">lam3xMesh</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">:</span><span class="n">nlam2</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">lam2yMesh</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,:]</span> <span class="o">=</span> <span class="n">lam3yMesh</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">:</span><span class="n">nlam2</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span>
        <span class="c">#Generate the node objects for laminate 2</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">nlam2</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
            <span class="n">lam2xMesh</span><span class="p">[:,</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">lam2xMesh</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="n">i</span><span class="p">],</span><span class="n">lam2xMesh</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">i</span><span class="p">],</span><span class="n">meshLen2</span><span class="p">)</span><span class="o">.</span><span class="n">T</span>
            <span class="n">lam2yMesh</span><span class="p">[:,</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">lam2yMesh</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="n">i</span><span class="p">],</span><span class="n">lam2yMesh</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">i</span><span class="p">],</span><span class="n">meshLen2</span><span class="p">)</span><span class="o">.</span><span class="n">T</span>
            <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">size</span><span class="p">(</span><span class="n">lam2xMesh</span><span class="p">,</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
                <span class="c">#Create node/populate mesh array</span>
                <span class="n">newNID</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="nb">max</span><span class="p">(</span><span class="n">nodeDict</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
                <span class="n">lam2Mesh</span><span class="p">[</span><span class="n">j</span><span class="p">,</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">newNID</span>
                <span class="c">#Add node to NID Dictionary</span>
                <span class="n">nodeDict</span><span class="p">[</span><span class="n">newNID</span><span class="p">]</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">newNID</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">lam2xMesh</span><span class="p">[</span><span class="n">j</span><span class="p">,</span><span class="n">i</span><span class="p">],</span><span class="n">lam2yMesh</span><span class="p">[</span><span class="n">j</span><span class="p">,</span><span class="n">i</span><span class="p">],</span><span class="n">zc</span><span class="p">]))</span>
        <span class="c">#Add connectivity nodes for lamiante 4</span>
        <span class="n">lam4Mesh</span><span class="p">[</span><span class="mi">0</span><span class="p">,:]</span> <span class="o">=</span> <span class="n">lam1Mesh</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="p">(</span><span class="n">nlam2</span><span class="o">+</span><span class="mi">1</span><span class="p">):]</span>
        <span class="n">lam4xMesh</span><span class="p">[</span><span class="mi">0</span><span class="p">,:]</span> <span class="o">=</span> <span class="n">lam1xMesh</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="p">(</span><span class="n">nlam2</span><span class="o">+</span><span class="mi">1</span><span class="p">):]</span>
        <span class="n">lam4yMesh</span><span class="p">[</span><span class="mi">0</span><span class="p">,:]</span> <span class="o">=</span> <span class="n">lam1yMesh</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="p">(</span><span class="n">nlam2</span><span class="o">+</span><span class="mi">1</span><span class="p">):]</span>
        <span class="n">lam4Mesh</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,:]</span> <span class="o">=</span> <span class="n">lam3Mesh</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="p">(</span><span class="n">nlam2</span><span class="o">+</span><span class="mi">1</span><span class="p">):]</span>
        <span class="n">lam4xMesh</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,:]</span> <span class="o">=</span> <span class="n">lam3xMesh</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="p">(</span><span class="n">nlam2</span><span class="o">+</span><span class="mi">1</span><span class="p">):]</span>
        <span class="n">lam4yMesh</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,:]</span> <span class="o">=</span> <span class="n">lam3yMesh</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="p">(</span><span class="n">nlam2</span><span class="o">+</span><span class="mi">1</span><span class="p">):]</span>
        <span class="c">#Generate the node objects for laminate 4</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">nlam4</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
            <span class="n">lam4xMesh</span><span class="p">[:,</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">lam4xMesh</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="n">i</span><span class="p">],</span><span class="n">lam4xMesh</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">i</span><span class="p">],</span><span class="n">meshLen4</span><span class="p">)</span><span class="o">.</span><span class="n">T</span>
            <span class="n">lam4yMesh</span><span class="p">[:,</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">lam4yMesh</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="n">i</span><span class="p">],</span><span class="n">lam4yMesh</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">i</span><span class="p">],</span><span class="n">meshLen4</span><span class="p">)</span><span class="o">.</span><span class="n">T</span>
            <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">size</span><span class="p">(</span><span class="n">lam4Mesh</span><span class="p">,</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
                <span class="c">#Create node/populate mesh array</span>
                <span class="n">newNID</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="nb">max</span><span class="p">(</span><span class="n">nodeDict</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
                <span class="n">lam4Mesh</span><span class="p">[</span><span class="n">j</span><span class="p">,</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">newNID</span>
                <span class="c">#Add node to NID Dictionary</span>
                <span class="n">nodeDict</span><span class="p">[</span><span class="n">newNID</span><span class="p">]</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">newNID</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">lam4xMesh</span><span class="p">[</span><span class="n">j</span><span class="p">,</span><span class="n">i</span><span class="p">],</span><span class="n">lam4yMesh</span><span class="p">[</span><span class="n">j</span><span class="p">,</span><span class="n">i</span><span class="p">],</span><span class="n">zc</span><span class="p">]))</span>
        <span class="c"># Save meshes:</span>
        <span class="n">xsect</span><span class="o">.</span><span class="n">laminates</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">mesh</span> <span class="o">=</span> <span class="n">lam1Mesh</span>
        <span class="n">xsect</span><span class="o">.</span><span class="n">laminates</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">xmesh</span> <span class="o">=</span> <span class="n">lam1xMesh</span>
        <span class="n">xsect</span><span class="o">.</span><span class="n">laminates</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">ymesh</span> <span class="o">=</span> <span class="n">lam1yMesh</span>
        <span class="n">xsect</span><span class="o">.</span><span class="n">laminates</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">zmesh</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">1</span><span class="o">+</span><span class="n">nlam1</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">x1top</span><span class="p">)))</span>

        <span class="n">xsect</span><span class="o">.</span><span class="n">laminates</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">mesh</span> <span class="o">=</span> <span class="n">lam2Mesh</span>
        <span class="n">xsect</span><span class="o">.</span><span class="n">laminates</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">xmesh</span> <span class="o">=</span> <span class="n">lam2xMesh</span>
        <span class="n">xsect</span><span class="o">.</span><span class="n">laminates</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">ymesh</span> <span class="o">=</span> <span class="n">lam2yMesh</span>
        <span class="n">xsect</span><span class="o">.</span><span class="n">laminates</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">zmesh</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">meshLen2</span><span class="p">,</span><span class="n">nlam2</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span>
        
        <span class="n">xsect</span><span class="o">.</span><span class="n">laminates</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">mesh</span> <span class="o">=</span> <span class="n">lam3Mesh</span>
        <span class="n">xsect</span><span class="o">.</span><span class="n">laminates</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">xmesh</span> <span class="o">=</span> <span class="n">lam3xMesh</span>
        <span class="n">xsect</span><span class="o">.</span><span class="n">laminates</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">ymesh</span> <span class="o">=</span> <span class="n">lam3yMesh</span>
        <span class="n">xsect</span><span class="o">.</span><span class="n">laminates</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">zmesh</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">1</span><span class="o">+</span><span class="n">nlam3</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">x3bot</span><span class="p">)))</span>
        
        <span class="n">xsect</span><span class="o">.</span><span class="n">laminates</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">mesh</span> <span class="o">=</span> <span class="n">lam4Mesh</span>
        <span class="n">xsect</span><span class="o">.</span><span class="n">laminates</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">xmesh</span> <span class="o">=</span> <span class="n">lam4xMesh</span>
        <span class="n">xsect</span><span class="o">.</span><span class="n">laminates</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">ymesh</span> <span class="o">=</span> <span class="n">lam4yMesh</span>
        <span class="n">xsect</span><span class="o">.</span><span class="n">laminates</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">zmesh</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">meshLen4</span><span class="p">,</span><span class="n">nlam4</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span>
        
        <span class="n">xsect</span><span class="o">.</span><span class="n">nodeDict</span> <span class="o">=</span> <span class="n">nodeDict</span>
        
        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">xsect</span><span class="o">.</span><span class="n">laminates</span><span class="p">)):</span>
            <span class="n">ylen</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">size</span><span class="p">(</span><span class="n">xsect</span><span class="o">.</span><span class="n">laminates</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">mesh</span><span class="p">,</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span>
            <span class="n">xlen</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">size</span><span class="p">(</span><span class="n">xsect</span><span class="o">.</span><span class="n">laminates</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">mesh</span><span class="p">,</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span>
            <span class="c"># Ovearhead for later plotting of the cross-section. Will allow</span>
            <span class="c"># for discontinuities in the contour should it arise (ie in</span>
            <span class="c"># stress or strain contours).</span>
            <span class="n">xsect</span><span class="o">.</span><span class="n">laminates</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">plotx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">ylen</span><span class="o">*</span><span class="mi">2</span><span class="p">,</span><span class="n">xlen</span><span class="o">*</span><span class="mi">2</span><span class="p">))</span>
            <span class="n">xsect</span><span class="o">.</span><span class="n">laminates</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">ploty</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">ylen</span><span class="o">*</span><span class="mi">2</span><span class="p">,</span><span class="n">xlen</span><span class="o">*</span><span class="mi">2</span><span class="p">))</span>
            <span class="n">xsect</span><span class="o">.</span><span class="n">laminates</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">plotz</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">ylen</span><span class="o">*</span><span class="mi">2</span><span class="p">,</span><span class="n">xlen</span><span class="o">*</span><span class="mi">2</span><span class="p">))</span>
            <span class="n">xsect</span><span class="o">.</span><span class="n">laminates</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">plotc</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">ylen</span><span class="o">*</span><span class="mi">2</span><span class="p">,</span><span class="n">xlen</span><span class="o">*</span><span class="mi">2</span><span class="p">))</span>
            <span class="n">xsect</span><span class="o">.</span><span class="n">laminates</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">EIDmesh</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">ylen</span><span class="p">,</span><span class="n">xlen</span><span class="p">),</span><span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">ylen</span><span class="p">):</span>
                <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">xlen</span><span class="p">):</span>
                    <span class="n">newEID</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="nb">max</span><span class="p">(</span><span class="n">elemDict</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
                    <span class="n">NIDs</span> <span class="o">=</span> <span class="p">[</span><span class="n">xsect</span><span class="o">.</span><span class="n">laminates</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">mesh</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">j</span><span class="p">],</span><span class="n">xsect</span><span class="o">.</span><span class="n">laminates</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">mesh</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">],</span>\
                        <span class="n">xsect</span><span class="o">.</span><span class="n">laminates</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">mesh</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">],</span><span class="n">xsect</span><span class="o">.</span><span class="n">laminates</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">mesh</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]]</span>
                    <span class="n">nodes</span> <span class="o">=</span> <span class="p">[</span><span class="n">xsect</span><span class="o">.</span><span class="n">nodeDict</span><span class="p">[</span><span class="n">NID</span><span class="p">]</span> <span class="k">for</span> <span class="n">NID</span> <span class="ow">in</span> <span class="n">NIDs</span><span class="p">]</span>
                    <span class="c"># If the laminate is horizontal (i.e. divisible by 2)</span>
                    <span class="k">if</span> <span class="n">k</span> <span class="o">%</span> <span class="mi">2</span><span class="o">==</span><span class="mi">0</span><span class="p">:</span>
                        <span class="c"># Section determines how curvature in the beam causes</span>
                        <span class="c"># slight variations in fiber rotation.</span>
                        <span class="n">deltax1</span> <span class="o">=</span> <span class="n">xsect</span><span class="o">.</span><span class="n">laminates</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">xmesh</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">xsect</span><span class="o">.</span><span class="n">laminates</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">xmesh</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span>
                        <span class="n">deltay1</span> <span class="o">=</span> <span class="n">xsect</span><span class="o">.</span><span class="n">laminates</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">ymesh</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">xsect</span><span class="o">.</span><span class="n">laminates</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">ymesh</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span>
                        <span class="n">deltax2</span> <span class="o">=</span> <span class="n">xsect</span><span class="o">.</span><span class="n">laminates</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">xmesh</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">xsect</span><span class="o">.</span><span class="n">laminates</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">xmesh</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">j</span><span class="p">]</span>
                        <span class="n">deltay2</span> <span class="o">=</span> <span class="n">xsect</span><span class="o">.</span><span class="n">laminates</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">ymesh</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">xsect</span><span class="o">.</span><span class="n">laminates</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">ymesh</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">j</span><span class="p">]</span>
                        <span class="n">thz_loc</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">rad2deg</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">arctan</span><span class="p">(</span><span class="n">deltay1</span><span class="o">/</span><span class="n">deltax1</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">arctan</span><span class="p">(</span><span class="n">deltay2</span><span class="o">/</span><span class="n">deltax2</span><span class="p">)]))</span>
                        <span class="k">if</span> <span class="n">k</span><span class="o">==</span><span class="mi">0</span><span class="p">:</span>
                            <span class="n">MID</span> <span class="o">=</span> <span class="n">xsect</span><span class="o">.</span><span class="n">laminates</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">plies</span><span class="p">[</span><span class="n">ylen</span><span class="o">-</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">MID</span>
                            <span class="n">th</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="n">xsect</span><span class="o">.</span><span class="n">laminates</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">plies</span><span class="p">[</span><span class="n">ylen</span><span class="o">-</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">th</span><span class="p">,</span><span class="n">thz</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">+</span><span class="n">thz_loc</span><span class="p">]</span>
                        <span class="k">else</span><span class="p">:</span>
                            <span class="n">MID</span> <span class="o">=</span> <span class="n">xsect</span><span class="o">.</span><span class="n">laminates</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">plies</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">MID</span>
                            <span class="n">th</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="n">xsect</span><span class="o">.</span><span class="n">laminates</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">plies</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">th</span><span class="p">,</span><span class="n">thz</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">+</span><span class="n">thz_loc</span><span class="p">]</span>
                        
                        <span class="c">#if newEID in [0,1692,1135,1134,2830,2831]:</span>
                        <span class="c">#    print(th)</span>
                    <span class="c"># Else if it is vertical:</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="k">if</span> <span class="n">k</span><span class="o">==</span><span class="mi">1</span><span class="p">:</span>
                            <span class="n">MID</span> <span class="o">=</span> <span class="n">xsect</span><span class="o">.</span><span class="n">laminates</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">plies</span><span class="p">[</span><span class="n">xlen</span><span class="o">-</span><span class="n">j</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">MID</span>
                            <span class="n">th</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="n">xsect</span><span class="o">.</span><span class="n">laminates</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">plies</span><span class="p">[</span><span class="n">xlen</span><span class="o">-</span><span class="n">j</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">th</span><span class="p">,</span><span class="n">thz</span><span class="p">[</span><span class="n">k</span><span class="p">]]</span>
                        <span class="k">else</span><span class="p">:</span>
                            <span class="n">MID</span> <span class="o">=</span> <span class="n">xsect</span><span class="o">.</span><span class="n">laminates</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">plies</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">MID</span>
                            <span class="n">th</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="n">xsect</span><span class="o">.</span><span class="n">laminates</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">plies</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">th</span><span class="p">,</span><span class="n">thz</span><span class="p">[</span><span class="n">k</span><span class="p">]]</span>
                        <span class="c">#MID = xsect.laminates[k].plies[j].MID</span>
                        
                        <span class="c">#if newEID in [0,1692,1135,1134,2830,2831]:</span>
                        <span class="c">#    print(th)</span>
                    <span class="n">elemDict</span><span class="p">[</span><span class="n">newEID</span><span class="p">]</span> <span class="o">=</span> <span class="n">CQUADX</span><span class="p">(</span><span class="n">newEID</span><span class="p">,</span><span class="n">nodes</span><span class="p">,</span><span class="n">MID</span><span class="p">,</span><span class="n">matlib</span><span class="p">,</span><span class="n">th</span><span class="o">=</span><span class="n">th</span><span class="p">)</span>
                    <span class="n">xsect</span><span class="o">.</span><span class="n">laminates</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">EIDmesh</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">newEID</span>
        <span class="n">xsect</span><span class="o">.</span><span class="n">elemDict</span> <span class="o">=</span> <span class="n">elemDict</span>
        <span class="k">del</span> <span class="n">xsect</span><span class="o">.</span><span class="n">nodeDict</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="k">del</span> <span class="n">xsect</span><span class="o">.</span><span class="n">elemDict</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span></div>
<div class="viewcode-block" id="Mesher.laminate"><a class="viewcode-back" href="../../structures.html#AeroComBAT.Structures.Mesher.laminate">[docs]</a>    <span class="k">def</span> <span class="nf">laminate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">xsect</span><span class="p">,</span><span class="n">meshSize</span><span class="p">,</span><span class="n">x0</span><span class="p">,</span><span class="n">xf</span><span class="p">,</span><span class="n">matlib</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Meshes laminate cross-section.</span>
<span class="sd">        </span>
<span class="sd">        This method meshes a simple laminate cross-section. It is assumed that</span>
<span class="sd">        the unit normal vector of the laminate points in the y-direction. This</span>
<span class="sd">        method only requires one laminate, which can take any shape. The cross-</span>
<span class="sd">        section geometry can be seen below:</span>
<span class="sd">        </span>
<span class="sd">        .. image:: images/laminateGeom.png</span>
<span class="sd">            :align: center</span>
<span class="sd">        </span>
<span class="sd">        :Args:</span>
<span class="sd">        </span>
<span class="sd">        - `xsect (obj)`: The cross-section object to be meshed.</span>
<span class="sd">        - `meshSize (int)`: The maximum aspect ratio an element can have</span>
<span class="sd">        - `x0 (float)`: The non-dimensional starting point of the cross-section</span>
<span class="sd">            on the airfoil.</span>
<span class="sd">        - `xf (float)`: The non-dimesnional ending point of the cross-section</span>
<span class="sd">            on the airfoil.</span>
<span class="sd">        - `matlib (obj)`: The material library object used to create CQUADX</span>
<span class="sd">            elements.</span>
<span class="sd">            </span>
<span class="sd">        :Returns:</span>
<span class="sd">        </span>
<span class="sd">        - None</span>
<span class="sd">            </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c"># INITIALIZE INPUTS</span>
        <span class="c"># Initialize the node dictionary containing all nodes objects used by</span>
        <span class="c"># the cross-section</span>
        <span class="n">nodeDict</span> <span class="o">=</span> <span class="p">{</span><span class="o">-</span><span class="mi">1</span><span class="p">:</span><span class="bp">None</span><span class="p">}</span>
        <span class="c"># Initialize the element dictionary containing all element objects used</span>
        <span class="c"># by the cross-section</span>
        <span class="n">elemDict</span> <span class="o">=</span> <span class="p">{</span><span class="o">-</span><span class="mi">1</span><span class="p">:</span><span class="bp">None</span><span class="p">}</span>
        <span class="c"># The laminates used to mesh the cross-seciton</span>
        <span class="n">laminates</span> <span class="o">=</span> <span class="n">xsect</span><span class="o">.</span><span class="n">laminates</span>
        <span class="c"># Initialize the airfoil</span>
        <span class="n">Airfoil</span> <span class="o">=</span> <span class="n">xsect</span><span class="o">.</span><span class="n">airfoil</span>
        <span class="c"># The chord length of the airfoil profile</span>
        <span class="n">c</span> <span class="o">=</span> <span class="n">Airfoil</span><span class="o">.</span><span class="n">c</span>
        
        <span class="c"># CREATE NODES FOR MESH</span>
        <span class="c"># Verify that 4 laminate objects have been provides</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">len</span><span class="p">(</span><span class="n">laminates</span><span class="p">)</span><span class="o">==</span><span class="mi">1</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s">&#39;The laminate cross-section was selected, but 1 &#39;</span>\
                <span class="s">&#39;laminate was not provided&#39;</span><span class="p">)</span>
        <span class="c"># Determine the number of plies per each laminate</span>
        <span class="n">laminate</span> <span class="o">=</span> <span class="n">laminates</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="c"># get the y coordinates of the lamiante</span>
        <span class="n">ycoords</span> <span class="o">=</span> <span class="n">laminate</span><span class="o">.</span><span class="n">z</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">xcoords</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">x0</span><span class="o">*</span><span class="n">c</span><span class="p">,</span><span class="n">xf</span><span class="o">*</span><span class="n">c</span><span class="p">,</span><span class="nb">int</span><span class="p">(</span><span class="n">c</span><span class="o">/</span><span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="n">laminate</span><span class="o">.</span><span class="n">t</span><span class="p">)</span><span class="o">*</span><span class="n">meshSize</span><span class="p">))</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
        <span class="c"># Create 2D meshes</span>
        <span class="n">xmesh</span><span class="p">,</span><span class="n">ymesh</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">xcoords</span><span class="p">,</span><span class="n">ycoords</span><span class="p">)</span>
        <span class="c"># Create z-mesh</span>
        <span class="n">zmesh</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="nb">len</span><span class="p">(</span><span class="n">ycoords</span><span class="p">),</span><span class="nb">len</span><span class="p">(</span><span class="n">xcoords</span><span class="p">)))</span>
        
        <span class="n">Mesh</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="nb">len</span><span class="p">(</span><span class="n">ycoords</span><span class="p">),</span><span class="nb">len</span><span class="p">(</span><span class="n">xcoords</span><span class="p">)),</span><span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>
        
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">ycoords</span><span class="p">)):</span>
            <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">xcoords</span><span class="p">)):</span>
                <span class="n">newNID</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">nodeDict</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span><span class="o">+</span><span class="mi">1</span>
                <span class="n">Mesh</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">newNID</span>
                <span class="n">nodeDict</span><span class="p">[</span><span class="n">newNID</span><span class="p">]</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">newNID</span><span class="p">,[</span><span class="n">xmesh</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">],</span><span class="n">ymesh</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">],</span><span class="n">zmesh</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]])</span>
        
        <span class="c"># Save meshes:</span>
        <span class="n">laminate</span><span class="o">.</span><span class="n">mesh</span> <span class="o">=</span> <span class="n">Mesh</span>
        <span class="n">laminate</span><span class="o">.</span><span class="n">xmesh</span> <span class="o">=</span> <span class="n">xmesh</span>
        <span class="n">laminate</span><span class="o">.</span><span class="n">ymesh</span> <span class="o">=</span> <span class="n">ymesh</span>
        <span class="n">laminate</span><span class="o">.</span><span class="n">zmesh</span> <span class="o">=</span> <span class="n">zmesh</span>
        
        <span class="n">xsect</span><span class="o">.</span><span class="n">nodeDict</span> <span class="o">=</span> <span class="n">nodeDict</span>
        
        <span class="c">#Create Elements</span>
        <span class="n">ylen</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">ycoords</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span>
        <span class="n">xlen</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">xcoords</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span>
        <span class="c"># Ovearhead for later plotting of the cross-section. Will allow</span>
        <span class="c"># for discontinuities in the contour should it arise (ie in</span>
        <span class="c"># stress or strain contours).</span>
        <span class="n">laminate</span><span class="o">.</span><span class="n">plotx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">ylen</span><span class="o">*</span><span class="mi">2</span><span class="p">,</span><span class="n">xlen</span><span class="o">*</span><span class="mi">2</span><span class="p">))</span>
        <span class="n">laminate</span><span class="o">.</span><span class="n">ploty</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">ylen</span><span class="o">*</span><span class="mi">2</span><span class="p">,</span><span class="n">xlen</span><span class="o">*</span><span class="mi">2</span><span class="p">))</span>
        <span class="n">laminate</span><span class="o">.</span><span class="n">plotz</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">ylen</span><span class="o">*</span><span class="mi">2</span><span class="p">,</span><span class="n">xlen</span><span class="o">*</span><span class="mi">2</span><span class="p">))</span>
        <span class="n">laminate</span><span class="o">.</span><span class="n">plotc</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">ylen</span><span class="o">*</span><span class="mi">2</span><span class="p">,</span><span class="n">xlen</span><span class="o">*</span><span class="mi">2</span><span class="p">))</span>
        <span class="n">laminate</span><span class="o">.</span><span class="n">EIDmesh</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">ylen</span><span class="p">,</span><span class="n">xlen</span><span class="p">),</span><span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">ylen</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">xlen</span><span class="p">):</span>
                <span class="n">newEID</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="nb">max</span><span class="p">(</span><span class="n">elemDict</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
                <span class="n">NIDs</span> <span class="o">=</span> <span class="p">[</span><span class="n">laminate</span><span class="o">.</span><span class="n">mesh</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">j</span><span class="p">],</span><span class="n">laminate</span><span class="o">.</span><span class="n">mesh</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">],</span>\
                    <span class="n">laminate</span><span class="o">.</span><span class="n">mesh</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">],</span><span class="n">laminate</span><span class="o">.</span><span class="n">mesh</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]]</span>
                <span class="n">nodes</span> <span class="o">=</span> <span class="p">[</span><span class="n">xsect</span><span class="o">.</span><span class="n">nodeDict</span><span class="p">[</span><span class="n">NID</span><span class="p">]</span> <span class="k">for</span> <span class="n">NID</span> <span class="ow">in</span> <span class="n">NIDs</span><span class="p">]</span>
                <span class="n">MID</span> <span class="o">=</span> <span class="n">laminate</span><span class="o">.</span><span class="n">plies</span><span class="p">[</span><span class="n">ylen</span><span class="o">-</span><span class="mi">1</span><span class="o">-</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">MID</span>
                <span class="n">th</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="n">laminate</span><span class="o">.</span><span class="n">plies</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">th</span><span class="p">,</span><span class="mf">0.</span><span class="p">]</span>
                <span class="n">elemDict</span><span class="p">[</span><span class="n">newEID</span><span class="p">]</span> <span class="o">=</span> <span class="n">CQUADX</span><span class="p">(</span><span class="n">newEID</span><span class="p">,</span><span class="n">nodes</span><span class="p">,</span><span class="n">MID</span><span class="p">,</span><span class="n">matlib</span><span class="p">,</span><span class="n">th</span><span class="o">=</span><span class="n">th</span><span class="p">)</span>
                <span class="n">laminate</span><span class="o">.</span><span class="n">EIDmesh</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">newEID</span>
        <span class="n">xsect</span><span class="o">.</span><span class="n">elemDict</span> <span class="o">=</span> <span class="n">elemDict</span>
        <span class="k">del</span> <span class="n">xsect</span><span class="o">.</span><span class="n">nodeDict</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="k">del</span> <span class="n">xsect</span><span class="o">.</span><span class="n">elemDict</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span></div>
    <span class="k">def</span> <span class="nf">cylindricalTube</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">xsect</span><span class="p">,</span><span class="n">r</span><span class="p">,</span><span class="n">meshSize</span><span class="p">,</span><span class="n">x0</span><span class="p">,</span><span class="n">xf</span><span class="p">,</span><span class="n">matlib</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="c"># Initialize the node dictionary, containing all local node objects</span>
        <span class="c"># used by the cross-section</span>
        <span class="n">nodeDict</span> <span class="o">=</span> <span class="p">{</span><span class="o">-</span><span class="mi">1</span><span class="p">:</span><span class="bp">None</span><span class="p">}</span>
        <span class="c"># Initialize the node dictionary, containing all local element objects</span>
        <span class="c"># used by the cross-section</span>
        <span class="n">elemDict</span> <span class="o">=</span> <span class="p">{</span><span class="o">-</span><span class="mi">1</span><span class="p">:</span><span class="bp">None</span><span class="p">}</span>
        <span class="c"># Initialize the X-Section z-coordinate</span>
        <span class="n">zc</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s">&#39;zc&#39;</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
        <span class="c"># Initialize the laminates</span>
        <span class="n">laminates</span> <span class="o">=</span> <span class="n">xsect</span><span class="o">.</span><span class="n">laminates</span>
        <span class="c"># Initialize the number of plies per laminate (must be equal for all)</span>
        <span class="n">nplies</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">laminates</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plies</span><span class="p">)</span>
        <span class="c"># Initialize the thickness vectors of plies per laminate (must be equal for all)</span>
        <span class="n">ts</span> <span class="o">=</span> <span class="n">laminates</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">t</span>
        <span class="c"># Determine the dtheta required for the cross-section</span>
        <span class="n">minT</span> <span class="o">=</span> <span class="mf">1e9</span>
        <span class="k">for</span> <span class="n">lam</span> <span class="ow">in</span> <span class="n">laminates</span><span class="p">:</span>
            <span class="n">lamMin</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">lam</span><span class="o">.</span><span class="n">t</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">lamMin</span><span class="o">&lt;</span><span class="n">minT</span><span class="p">:</span>
                <span class="n">minT</span> <span class="o">=</span> <span class="n">lamMin</span>
            <span class="c"># Check the total number of laminates</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="nb">len</span><span class="p">(</span><span class="n">lam</span><span class="o">.</span><span class="n">plies</span><span class="p">)</span><span class="o">==</span><span class="n">nplies</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s">&#39;Note, for now all laminates must have the&#39;</span>\
                    <span class="s">&#39;same number of plies.&#39;</span><span class="p">)</span>
            <span class="c"># Check that the thicknesses all match</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">np</span><span class="o">.</span><span class="n">array_equal</span><span class="p">(</span><span class="n">ts</span><span class="p">,</span><span class="n">lam</span><span class="o">.</span><span class="n">t</span><span class="p">):</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s">&#39;Note, for now all laminates must have the&#39;</span>\
                    <span class="s">&#39;Sane thickness distribution through the thickness of the&#39;</span>\
                    <span class="s">&#39;laminate in order to preserve mesh compatability between&#39;</span>\
                    <span class="s">&#39;laminates.&#39;</span><span class="p">)</span>
        <span class="n">dth</span> <span class="o">=</span> <span class="n">meshSize</span><span class="o">*</span><span class="n">minT</span><span class="o">/</span><span class="n">r</span>
        <span class="n">thz</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">laminates</span><span class="p">)):</span>
            <span class="n">thz</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">thz</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">i</span><span class="o">*</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="nb">len</span><span class="p">(</span><span class="n">laminates</span><span class="p">),</span>\
                <span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="nb">len</span><span class="p">(</span><span class="n">laminates</span><span class="p">)),</span><span class="n">num</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="p">(</span><span class="n">dth</span><span class="o">*</span><span class="nb">len</span><span class="p">(</span><span class="n">laminates</span><span class="p">))))</span>
        <span class="n">thz</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">thz</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
        <span class="n">rvec</span> <span class="o">=</span> <span class="n">r</span><span class="o">+</span><span class="n">laminates</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">z</span><span class="o">+</span><span class="n">laminates</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">H</span><span class="o">/</span><span class="mi">2</span>
        <span class="n">rmat</span><span class="p">,</span><span class="n">thmat</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">rvec</span><span class="p">,</span><span class="n">thz</span><span class="p">)</span>
        <span class="n">mesh</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">np</span><span class="o">.</span><span class="n">size</span><span class="p">(</span><span class="n">rmat</span><span class="p">,</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">),</span><span class="n">np</span><span class="o">.</span><span class="n">size</span><span class="p">(</span><span class="n">rmat</span><span class="p">,</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)),</span><span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>
        <span class="n">xmesh</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">np</span><span class="o">.</span><span class="n">size</span><span class="p">(</span><span class="n">rmat</span><span class="p">,</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">),</span><span class="n">np</span><span class="o">.</span><span class="n">size</span><span class="p">(</span><span class="n">rmat</span><span class="p">,</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)))</span>
        <span class="n">ymesh</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">np</span><span class="o">.</span><span class="n">size</span><span class="p">(</span><span class="n">rmat</span><span class="p">,</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">),</span><span class="n">np</span><span class="o">.</span><span class="n">size</span><span class="p">(</span><span class="n">rmat</span><span class="p">,</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)))</span>
        <span class="n">zmesh</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">np</span><span class="o">.</span><span class="n">size</span><span class="p">(</span><span class="n">rmat</span><span class="p">,</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">),</span><span class="n">np</span><span class="o">.</span><span class="n">size</span><span class="p">(</span><span class="n">rmat</span><span class="p">,</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)))</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">size</span><span class="p">(</span><span class="n">rmat</span><span class="p">,</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)):</span>
            <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">size</span><span class="p">(</span><span class="n">rmat</span><span class="p">,</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)):</span>
                <span class="c"># Determine temp xy coordinates of the point</span>
                <span class="n">xtmp</span> <span class="o">=</span> <span class="n">rmat</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">thmat</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">])</span>
                <span class="n">ytmp</span> <span class="o">=</span> <span class="n">rmat</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">thmat</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">])</span>
                <span class="c">#Create node/populate mesh array</span>
                <span class="n">newNID</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="nb">max</span><span class="p">(</span><span class="n">nodeDict</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
                <span class="n">mesh</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">newNID</span>
                <span class="c">#Add node to NID Dictionary</span>
                <span class="n">nodeDict</span><span class="p">[</span><span class="n">newNID</span><span class="p">]</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">newNID</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">xtmp</span><span class="p">,</span><span class="n">ytmp</span><span class="p">,</span><span class="n">zc</span><span class="p">]))</span>
                <span class="n">xmesh</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">xtmp</span>
                <span class="n">ymesh</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">ytmp</span>
        <span class="c"># Assign parts of the total mesh to each laminate</span>
        <span class="n">bound</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">num</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">laminates</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">laminates</span><span class="p">)):</span>
            <span class="n">laminates</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">mesh</span> <span class="o">=</span> <span class="n">mesh</span><span class="p">[(</span><span class="n">thmat</span><span class="o">&lt;=</span><span class="n">bound</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">thmat</span><span class="o">&lt;=</span><span class="n">bound</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">])]</span>
            <span class="n">laminates</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">xmesh</span> <span class="o">=</span> <span class="n">xmesh</span><span class="p">[(</span><span class="n">thmat</span><span class="o">&gt;=</span><span class="n">bound</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">thmat</span><span class="o">&lt;=</span><span class="n">bound</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">])]</span>
            <span class="n">laminates</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">ymesh</span> <span class="o">=</span> <span class="n">ymesh</span><span class="p">[(</span><span class="n">thmat</span><span class="o">&gt;=</span><span class="n">bound</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">thmat</span><span class="o">&lt;=</span><span class="n">bound</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">])]</span>
            <span class="n">laminates</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">zmesh</span> <span class="o">=</span> <span class="n">zmesh</span><span class="p">[(</span><span class="n">thmat</span><span class="o">&gt;=</span><span class="n">bound</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">thmat</span><span class="o">&lt;=</span><span class="n">bound</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">])]</span>
            <span class="n">laminates</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">thmesh</span> <span class="o">=</span> <span class="n">thmat</span><span class="p">[(</span><span class="n">thmat</span><span class="o">&lt;=</span><span class="n">bound</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">thmat</span><span class="o">&lt;=</span><span class="n">bound</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">])]</span>
            <span class="n">laminates</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">EIDmesh</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">np</span><span class="o">.</span><span class="n">size</span><span class="p">(</span><span class="n">laminates</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">mesh</span><span class="p">,</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>\
                <span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">size</span><span class="p">(</span><span class="n">laminates</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">mesh</span><span class="p">,</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)),</span><span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">lam</span> <span class="ow">in</span> <span class="n">laminates</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">size</span><span class="p">(</span><span class="n">lam</span><span class="o">.</span><span class="n">mesh</span><span class="p">,</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
                <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">size</span><span class="p">(</span><span class="n">lam</span><span class="o">.</span><span class="n">mesh</span><span class="p">,</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
                    <span class="n">newEID</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="nb">max</span><span class="p">(</span><span class="n">elemDict</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
                    <span class="n">NIDs</span> <span class="o">=</span> <span class="p">[</span><span class="n">lam</span><span class="o">.</span><span class="n">mesh</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">],</span><span class="n">lam</span><span class="o">.</span><span class="n">mesh</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">j</span><span class="p">],</span>\
                        <span class="n">lam</span><span class="o">.</span><span class="n">mesh</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">],</span><span class="n">lam</span><span class="o">.</span><span class="n">mesh</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">]]</span>
                    <span class="n">nodes</span> <span class="o">=</span> <span class="p">[</span><span class="n">xsect</span><span class="o">.</span><span class="n">nodeDict</span><span class="p">[</span><span class="n">NID</span><span class="p">]</span> <span class="k">for</span> <span class="n">NID</span> <span class="ow">in</span> <span class="n">NIDs</span><span class="p">]</span>
                    <span class="n">th</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="n">lam</span><span class="o">.</span><span class="n">plies</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">th</span><span class="p">,</span><span class="n">lam</span><span class="o">.</span><span class="n">thmesh</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]]</span>
                    <span class="n">MID</span> <span class="o">=</span> <span class="n">xsect</span><span class="o">.</span><span class="n">lam</span><span class="o">.</span><span class="n">plies</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">MID</span>
                    <span class="n">elemDict</span><span class="p">[</span><span class="n">newEID</span><span class="p">]</span> <span class="o">=</span> <span class="n">CQUADX</span><span class="p">(</span><span class="n">newEID</span><span class="p">,</span><span class="n">nodes</span><span class="p">,</span><span class="n">MID</span><span class="p">,</span><span class="n">matlib</span><span class="p">,</span><span class="n">th</span><span class="o">=</span><span class="n">th</span><span class="p">)</span>
                    <span class="n">xsect</span><span class="o">.</span><span class="n">lam</span><span class="o">.</span><span class="n">EIDmesh</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">newEID</span>
        <span class="n">xsect</span><span class="o">.</span><span class="n">elemDict</span> <span class="o">=</span> <span class="n">elemDict</span>
        <span class="k">del</span> <span class="n">xsect</span><span class="o">.</span><span class="n">nodeDict</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="k">del</span> <span class="n">xsect</span><span class="o">.</span><span class="n">elemDict</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
<div class="viewcode-block" id="Mesher.rectBoxBeam"><a class="viewcode-back" href="../../structures.html#AeroComBAT.Structures.Mesher.rectBoxBeam">[docs]</a>    <span class="k">def</span> <span class="nf">rectBoxBeam</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">xsect</span><span class="p">,</span><span class="n">meshSize</span><span class="p">,</span><span class="n">x0</span><span class="p">,</span><span class="n">xf</span><span class="p">,</span><span class="n">matlib</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Meshes a box beam cross-section.</span>
<span class="sd">        </span>
<span class="sd">        This method meshes a similar cross-section as the boxBeam method. The</span>
<span class="sd">        geometry of this cross-section can be seen below. The interfaces</span>
<span class="sd">        between the laminates is different, and more restrictive. In this case</span>
<span class="sd">        all of the laminates must have the same number of plies, which must</span>
<span class="sd">        also all be the same thickness.</span>
<span class="sd">        </span>
<span class="sd">        .. image:: images/rectBoxGeom.png</span>
<span class="sd">            :align: center</span>
<span class="sd">        </span>
<span class="sd">        :Args:</span>
<span class="sd">        </span>
<span class="sd">        - `xsect (obj)`: The cross-section object to be meshed.</span>
<span class="sd">        - `meshSize (int)`: The maximum aspect ratio an element can have</span>
<span class="sd">        - `x0 (float)`: The non-dimensional starting point of the cross-section</span>
<span class="sd">            on the airfoil.</span>
<span class="sd">        - `xf (float)`: The non-dimesnional ending point of the cross-section</span>
<span class="sd">            on the airfoil.</span>
<span class="sd">        - `matlib (obj)`: The material library object used to create CQUADX</span>
<span class="sd">            elements.</span>
<span class="sd">            </span>
<span class="sd">        :Returns:</span>
<span class="sd">        </span>
<span class="sd">        - None</span>
<span class="sd">            </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">print</span><span class="p">(</span><span class="s">&#39;Rectangular Box Meshing Commencing&#39;</span><span class="p">)</span>
        <span class="c"># INITIALIZE INPUTS</span>
        <span class="c"># Initialize the node dictionary containing all nodes objects used by</span>
        <span class="c"># the cross-section</span>
        <span class="n">nodeDict</span> <span class="o">=</span> <span class="p">{</span><span class="o">-</span><span class="mi">1</span><span class="p">:</span><span class="bp">None</span><span class="p">}</span>
        <span class="c"># Initialize the element dictionary containing all element objects used</span>
        <span class="c"># by the cross-section</span>
        <span class="n">elemDict</span> <span class="o">=</span> <span class="p">{</span><span class="o">-</span><span class="mi">1</span><span class="p">:</span><span class="bp">None</span><span class="p">}</span>
        <span class="c"># The laminates used to mesh the cross-seciton</span>
        <span class="n">laminates</span> <span class="o">=</span> <span class="n">xsect</span><span class="o">.</span><span class="n">laminates</span>
        <span class="c"># Initialize the airfoil</span>
        <span class="n">Airfoil</span> <span class="o">=</span> <span class="n">xsect</span><span class="o">.</span><span class="n">airfoil</span>
        <span class="c"># The chord length of the airfoil profile</span>
        <span class="n">c</span> <span class="o">=</span> <span class="n">Airfoil</span><span class="o">.</span><span class="n">c</span>
        <span class="c"># Initialize the z location of the cross-section</span>
        <span class="n">zc</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="c"># Initialize the Euler angler rotation about the local xsect z-axis for</span>
        <span class="c"># any the given laminate. Note that individual elements might</span>
        <span class="c"># experience further z-axis orientation if there is curvature in in the</span>
        <span class="c"># OML of the cross-section.</span>
        <span class="n">thz</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">90</span><span class="p">,</span><span class="mi">180</span><span class="p">,</span><span class="mi">270</span><span class="p">]</span>
        
        <span class="c"># CREATE NODES FOR MESH</span>
        <span class="c"># Verify that 4 laminate objects have been provides</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">len</span><span class="p">(</span><span class="n">laminates</span><span class="p">)</span><span class="o">==</span><span class="mi">4</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s">&#39;The box beam cross-section was selected, but 4 &#39;</span>\
                <span class="s">&#39;laminates were not provided&#39;</span><span class="p">)</span>
        <span class="c"># Determine the number of plies per each laminate</span>
        <span class="n">nlam1</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">laminates</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plies</span><span class="p">)</span>
        <span class="n">nlam2</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">laminates</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plies</span><span class="p">)</span>
        <span class="n">nlam3</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">laminates</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">plies</span><span class="p">)</span>
        <span class="n">nlam4</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">laminates</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">plies</span><span class="p">)</span>
        <span class="c"># Define boundary curves:</span>
        <span class="c"># Note, the following curves represent the x-coordinate mesh</span>
        <span class="c"># seeding along key regions, such as the connection region</span>
        <span class="c"># between laminate 1 and 2</span>
        
        <span class="c"># Populates the x-coordinates of the mesh seeding in curves x2 and</span>
        <span class="c"># x4, which are the joint regions between the 4 laminates.</span>
        
        
        <span class="c"># Calculate important x points:</span>
        <span class="n">x0</span> <span class="o">=</span> <span class="n">x0</span><span class="o">*</span><span class="n">c</span>
        <span class="n">x1</span> <span class="o">=</span> <span class="n">x0</span><span class="o">+</span><span class="n">laminates</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">H</span>
        <span class="n">xf</span> <span class="o">=</span> <span class="n">xf</span><span class="o">*</span><span class="n">c</span>
        <span class="n">x2</span> <span class="o">=</span> <span class="n">xf</span><span class="o">-</span><span class="n">laminates</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">H</span>
        
        <span class="c"># Calculate important y points:</span>
        <span class="n">y0</span> <span class="o">=</span> <span class="o">-</span><span class="n">c</span><span class="o">/</span><span class="mi">2</span>
        <span class="n">y1</span> <span class="o">=</span> <span class="n">y0</span><span class="o">+</span><span class="n">laminates</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">H</span>
        <span class="n">yf</span> <span class="o">=</span> <span class="n">c</span><span class="o">/</span><span class="mi">2</span>
        <span class="n">y2</span> <span class="o">=</span> <span class="n">yf</span><span class="o">-</span><span class="n">laminates</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">H</span>
        
        <span class="c"># Determine the mesh seeding to maintain minimum AR</span>
        <span class="n">lam13xSeeding</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ceil</span><span class="p">((</span><span class="n">xf</span><span class="o">-</span><span class="n">x0</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">meshSize</span><span class="o">*</span><span class="nb">min</span><span class="p">(</span><span class="n">laminates</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">t</span><span class="p">)))</span>
        <span class="n">lam24ySeeding</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ceil</span><span class="p">((</span><span class="n">yf</span><span class="o">-</span><span class="n">y0</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">meshSize</span><span class="o">*</span><span class="nb">min</span><span class="p">(</span><span class="n">laminates</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">t</span><span class="p">)))</span>
        
        <span class="c"># Define Finite Element Modeling Functions</span>
        <span class="k">def</span> <span class="nf">x</span><span class="p">(</span><span class="n">eta</span><span class="p">,</span><span class="n">xi</span><span class="p">,</span><span class="n">xs</span><span class="p">):</span>
            <span class="k">return</span> <span class="o">.</span><span class="mi">25</span><span class="o">*</span><span class="p">(</span><span class="n">xs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="mf">1.</span><span class="o">-</span><span class="n">xi</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="mf">1.</span><span class="o">-</span><span class="n">eta</span><span class="p">)</span><span class="o">+</span><span class="n">xs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="mf">1.</span><span class="o">+</span><span class="n">xi</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="mf">1.</span><span class="o">-</span><span class="n">eta</span><span class="p">)</span><span class="o">+</span>\
                    <span class="n">xs</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="mf">1.</span><span class="o">+</span><span class="n">xi</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="mf">1.</span><span class="o">+</span><span class="n">eta</span><span class="p">)</span><span class="o">+</span><span class="n">xs</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="mf">1.</span><span class="o">-</span><span class="n">xi</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="mf">1.</span><span class="o">+</span><span class="n">eta</span><span class="p">))</span>
        <span class="k">def</span> <span class="nf">y</span><span class="p">(</span><span class="n">eta</span><span class="p">,</span><span class="n">xi</span><span class="p">,</span><span class="n">ys</span><span class="p">):</span>
            <span class="k">return</span> <span class="o">.</span><span class="mi">25</span><span class="o">*</span><span class="p">(</span><span class="n">ys</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="mf">1.</span><span class="o">-</span><span class="n">xi</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="mf">1.</span><span class="o">-</span><span class="n">eta</span><span class="p">)</span><span class="o">+</span><span class="n">ys</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="mf">1.</span><span class="o">+</span><span class="n">xi</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="mf">1.</span><span class="o">-</span><span class="n">eta</span><span class="p">)</span><span class="o">+</span>\
                    <span class="n">ys</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="mf">1.</span><span class="o">+</span><span class="n">xi</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="mf">1.</span><span class="o">+</span><span class="n">eta</span><span class="p">)</span><span class="o">+</span><span class="n">ys</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="mf">1.</span><span class="o">-</span><span class="n">xi</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="mf">1.</span><span class="o">+</span><span class="n">eta</span><span class="p">))</span>
        
        <span class="c"># Generate Grids in superelement space</span>
        <span class="n">xis13</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">lam13xSeeding</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">etas13</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">nlam1</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">lam1Mesh</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">1</span><span class="o">+</span><span class="n">nlam1</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">xis13</span><span class="p">)),</span><span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>
        <span class="n">lam3Mesh</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">1</span><span class="o">+</span><span class="n">nlam3</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">xis13</span><span class="p">)),</span><span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>
        <span class="n">xis13</span><span class="p">,</span> <span class="n">etas13</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">xis13</span><span class="p">,</span><span class="n">etas13</span><span class="p">)</span>
        <span class="n">lam1xMesh</span> <span class="o">=</span> <span class="n">x</span><span class="p">(</span><span class="n">etas13</span><span class="p">,</span><span class="n">xis13</span><span class="p">,[</span><span class="n">x1</span><span class="p">,</span><span class="n">x2</span><span class="p">,</span><span class="n">xf</span><span class="p">,</span><span class="n">x0</span><span class="p">])</span>
        <span class="n">lam1yMesh</span> <span class="o">=</span> <span class="n">y</span><span class="p">(</span><span class="n">etas13</span><span class="p">,</span><span class="n">xis13</span><span class="p">,[</span><span class="n">y2</span><span class="p">,</span><span class="n">y2</span><span class="p">,</span><span class="n">yf</span><span class="p">,</span><span class="n">yf</span><span class="p">])</span>
        <span class="n">lam3xMesh</span> <span class="o">=</span> <span class="n">x</span><span class="p">(</span><span class="n">etas13</span><span class="p">,</span><span class="n">xis13</span><span class="p">,[</span><span class="n">x0</span><span class="p">,</span><span class="n">xf</span><span class="p">,</span><span class="n">x2</span><span class="p">,</span><span class="n">x1</span><span class="p">])</span>
        <span class="n">lam3yMesh</span> <span class="o">=</span> <span class="n">y</span><span class="p">(</span><span class="n">etas13</span><span class="p">,</span><span class="n">xis13</span><span class="p">,[</span><span class="n">y0</span><span class="p">,</span><span class="n">y0</span><span class="p">,</span><span class="n">y1</span><span class="p">,</span><span class="n">y1</span><span class="p">])</span>
        
        <span class="c"># GENERATE LAMINATE 1 AND 3 MESHES</span>
        <span class="c"># Create 3 empty numpy arrays for each laminate (we will start with</span>
        <span class="c"># lamiantes 1 and 3). The first is holds node ID&#39;s, the second and</span>
        <span class="c"># third hold the corresponding x and y coordinates of the node</span>
        
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">size</span><span class="p">(</span><span class="n">lam1xMesh</span><span class="p">,</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)):</span>
            <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">size</span><span class="p">(</span><span class="n">lam1xMesh</span><span class="p">,</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)):</span>
                <span class="c">#Create node/populate mesh array</span>
                <span class="n">newNID</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="nb">max</span><span class="p">(</span><span class="n">nodeDict</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
                <span class="n">lam1Mesh</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">newNID</span>
                <span class="c">#Add node to NID Dictionary</span>
                <span class="n">nodeDict</span><span class="p">[</span><span class="n">newNID</span><span class="p">]</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">newNID</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">lam1xMesh</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">],</span><span class="n">lam1yMesh</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">],</span><span class="n">zc</span><span class="p">]))</span>
        <span class="c">#Generate  the node objects for laminate 3</span>
        <span class="c">#ttmp = [0]+laminates[2].z+laminates[2].H/2</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">size</span><span class="p">(</span><span class="n">lam3xMesh</span><span class="p">,</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)):</span>
            <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">size</span><span class="p">(</span><span class="n">lam3xMesh</span><span class="p">,</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)):</span>
                <span class="c">#Create node/populate mesh array</span>
                <span class="n">newNID</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="nb">max</span><span class="p">(</span><span class="n">nodeDict</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
                <span class="n">lam3Mesh</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="o">-</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">newNID</span>
                <span class="c">#Add node to NID Dictionary</span>
                <span class="n">nodeDict</span><span class="p">[</span><span class="n">newNID</span><span class="p">]</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">newNID</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">lam3xMesh</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="o">-</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">],</span><span class="n">lam3yMesh</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="o">-</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">],</span><span class="n">zc</span><span class="p">]))</span>
        <span class="c">#GENERATE LAMINATE 2 AND 4 MESHES</span>
        <span class="c">#Define the mesh seeding for laminate 2</span>
        <span class="c">#meshLen2 = int(((yu[0]-laminates[0].H)-(yl[0]+laminates[2].H))/(meshSize*min(laminates[1].t)))</span>
        <span class="c">#Define the mesh seeding for laminate 4</span>
        <span class="c">#meshLen4 = int(((yu[-1]-laminates[0].H)-(yl[-1]+laminates[2].H))/(meshSize*min(laminates[3].t)))</span>
        <span class="c"># Create 3 empty numpy arrays for each laminate (we will start with</span>
        <span class="c"># lamiantes 2 and 4). The first is holds node ID&#39;s, the second and</span>
        <span class="c"># third hold the corresponding x and y coordinates of the node</span>
        
        <span class="n">xis24</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">nlam2</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">etas24</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">lam24ySeeding</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">lam2Mesh</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="nb">len</span><span class="p">(</span><span class="n">etas24</span><span class="p">),</span><span class="mi">1</span><span class="o">+</span><span class="n">nlam2</span><span class="p">),</span><span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>
        <span class="n">lam4Mesh</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="nb">len</span><span class="p">(</span><span class="n">etas24</span><span class="p">),</span><span class="mi">1</span><span class="o">+</span><span class="n">nlam4</span><span class="p">),</span><span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>
        <span class="n">xis24</span><span class="p">,</span> <span class="n">etas24</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">xis24</span><span class="p">,</span><span class="n">etas24</span><span class="p">)</span>
        <span class="n">lam2xMesh</span> <span class="o">=</span> <span class="n">x</span><span class="p">(</span><span class="n">etas24</span><span class="p">,</span><span class="n">xis24</span><span class="p">,[</span><span class="n">x0</span><span class="p">,</span><span class="n">x1</span><span class="p">,</span><span class="n">x1</span><span class="p">,</span><span class="n">x0</span><span class="p">])</span>
        <span class="n">lam2yMesh</span> <span class="o">=</span> <span class="n">y</span><span class="p">(</span><span class="n">etas24</span><span class="p">,</span><span class="n">xis24</span><span class="p">,[</span><span class="n">y0</span><span class="p">,</span><span class="n">y1</span><span class="p">,</span><span class="n">y2</span><span class="p">,</span><span class="n">yf</span><span class="p">])</span>
        <span class="n">lam4xMesh</span> <span class="o">=</span> <span class="n">x</span><span class="p">(</span><span class="n">etas24</span><span class="p">,</span><span class="n">xis24</span><span class="p">,[</span><span class="n">x2</span><span class="p">,</span><span class="n">xf</span><span class="p">,</span><span class="n">xf</span><span class="p">,</span><span class="n">x2</span><span class="p">])</span>
        <span class="n">lam4yMesh</span> <span class="o">=</span> <span class="n">y</span><span class="p">(</span><span class="n">etas24</span><span class="p">,</span><span class="n">xis24</span><span class="p">,[</span><span class="n">y1</span><span class="p">,</span><span class="n">y0</span><span class="p">,</span><span class="n">yf</span><span class="p">,</span><span class="n">y2</span><span class="p">])</span>
        
        <span class="c">#Add connectivity nodes for lamiante 2</span>
        <span class="n">lam2Mesh</span><span class="p">[</span><span class="mi">0</span><span class="p">,:]</span> <span class="o">=</span> <span class="n">lam1Mesh</span><span class="p">[:,</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">lam2xMesh</span><span class="p">[</span><span class="mi">0</span><span class="p">,:]</span> <span class="o">=</span> <span class="n">lam1xMesh</span><span class="p">[:,</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">lam2yMesh</span><span class="p">[</span><span class="mi">0</span><span class="p">,:]</span> <span class="o">=</span> <span class="n">lam1yMesh</span><span class="p">[:,</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">lam2Mesh</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,:]</span> <span class="o">=</span> <span class="n">lam3Mesh</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">lam2xMesh</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,:]</span> <span class="o">=</span> <span class="n">lam3xMesh</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">lam2yMesh</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,:]</span> <span class="o">=</span> <span class="n">lam3yMesh</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span>
        <span class="c">#Add connectivity nodes for lamiante 4</span>
        <span class="n">lam4Mesh</span><span class="p">[</span><span class="mi">0</span><span class="p">,:]</span> <span class="o">=</span> <span class="n">lam1Mesh</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">lam4xMesh</span><span class="p">[</span><span class="mi">0</span><span class="p">,:]</span> <span class="o">=</span> <span class="n">lam1xMesh</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">lam4yMesh</span><span class="p">[</span><span class="mi">0</span><span class="p">,:]</span> <span class="o">=</span> <span class="n">lam1yMesh</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">lam4Mesh</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,:]</span> <span class="o">=</span> <span class="n">lam3Mesh</span><span class="p">[:,</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">lam4xMesh</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,:]</span> <span class="o">=</span> <span class="n">lam3xMesh</span><span class="p">[:,</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">lam4yMesh</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,:]</span> <span class="o">=</span> <span class="n">lam3yMesh</span><span class="p">[:,</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="c">#Generate the node objects for laminate 2</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">size</span><span class="p">(</span><span class="n">lam2xMesh</span><span class="p">,</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">size</span><span class="p">(</span><span class="n">lam2xMesh</span><span class="p">,</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)):</span>
                <span class="c">#Create node/populate mesh array</span>
                <span class="n">newNID</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="nb">max</span><span class="p">(</span><span class="n">nodeDict</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
                <span class="n">lam2Mesh</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">newNID</span>
                <span class="c">#Add node to NID Dictionary</span>
                <span class="n">nodeDict</span><span class="p">[</span><span class="n">newNID</span><span class="p">]</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">newNID</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">lam2xMesh</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">],</span><span class="n">lam2yMesh</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">],</span><span class="n">zc</span><span class="p">]))</span>
        <span class="c">#Generate the node objects for laminate 4</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">size</span><span class="p">(</span><span class="n">lam2xMesh</span><span class="p">,</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">size</span><span class="p">(</span><span class="n">lam2xMesh</span><span class="p">,</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)):</span>
                <span class="c">#Create node/populate mesh array</span>
                <span class="n">newNID</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="nb">max</span><span class="p">(</span><span class="n">nodeDict</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
                <span class="n">lam4Mesh</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">newNID</span>
                <span class="c">#Add node to NID Dictionary</span>
                <span class="n">nodeDict</span><span class="p">[</span><span class="n">newNID</span><span class="p">]</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">newNID</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">lam4xMesh</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">],</span><span class="n">lam4yMesh</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">],</span><span class="n">zc</span><span class="p">]))</span>
        <span class="c"># Save meshes:</span>
        <span class="n">xsect</span><span class="o">.</span><span class="n">laminates</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">mesh</span> <span class="o">=</span> <span class="n">lam1Mesh</span>
        <span class="n">xsect</span><span class="o">.</span><span class="n">laminates</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">xmesh</span> <span class="o">=</span> <span class="n">lam1xMesh</span>
        <span class="n">xsect</span><span class="o">.</span><span class="n">laminates</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">ymesh</span> <span class="o">=</span> <span class="n">lam1yMesh</span>
        <span class="n">xsect</span><span class="o">.</span><span class="n">laminates</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">zmesh</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">np</span><span class="o">.</span><span class="n">size</span><span class="p">(</span><span class="n">lam1Mesh</span><span class="p">,</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">),</span><span class="n">np</span><span class="o">.</span><span class="n">size</span><span class="p">(</span><span class="n">lam1Mesh</span><span class="p">,</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)))</span>

        <span class="n">xsect</span><span class="o">.</span><span class="n">laminates</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">mesh</span> <span class="o">=</span> <span class="n">lam2Mesh</span>
        <span class="n">xsect</span><span class="o">.</span><span class="n">laminates</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">xmesh</span> <span class="o">=</span> <span class="n">lam2xMesh</span>
        <span class="n">xsect</span><span class="o">.</span><span class="n">laminates</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">ymesh</span> <span class="o">=</span> <span class="n">lam2yMesh</span>
        <span class="n">xsect</span><span class="o">.</span><span class="n">laminates</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">zmesh</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">np</span><span class="o">.</span><span class="n">size</span><span class="p">(</span><span class="n">lam2Mesh</span><span class="p">,</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">),</span><span class="n">np</span><span class="o">.</span><span class="n">size</span><span class="p">(</span><span class="n">lam2Mesh</span><span class="p">,</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)))</span>
        
        <span class="n">xsect</span><span class="o">.</span><span class="n">laminates</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">mesh</span> <span class="o">=</span> <span class="n">lam3Mesh</span>
        <span class="n">xsect</span><span class="o">.</span><span class="n">laminates</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">xmesh</span> <span class="o">=</span> <span class="n">lam3xMesh</span>
        <span class="n">xsect</span><span class="o">.</span><span class="n">laminates</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">ymesh</span> <span class="o">=</span> <span class="n">lam3yMesh</span>
        <span class="n">xsect</span><span class="o">.</span><span class="n">laminates</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">zmesh</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">np</span><span class="o">.</span><span class="n">size</span><span class="p">(</span><span class="n">lam3Mesh</span><span class="p">,</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">),</span><span class="n">np</span><span class="o">.</span><span class="n">size</span><span class="p">(</span><span class="n">lam3Mesh</span><span class="p">,</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)))</span>
        
        <span class="n">xsect</span><span class="o">.</span><span class="n">laminates</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">mesh</span> <span class="o">=</span> <span class="n">lam4Mesh</span>
        <span class="n">xsect</span><span class="o">.</span><span class="n">laminates</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">xmesh</span> <span class="o">=</span> <span class="n">lam4xMesh</span>
        <span class="n">xsect</span><span class="o">.</span><span class="n">laminates</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">ymesh</span> <span class="o">=</span> <span class="n">lam4yMesh</span>
        <span class="n">xsect</span><span class="o">.</span><span class="n">laminates</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">zmesh</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">np</span><span class="o">.</span><span class="n">size</span><span class="p">(</span><span class="n">lam4Mesh</span><span class="p">,</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">),</span><span class="n">np</span><span class="o">.</span><span class="n">size</span><span class="p">(</span><span class="n">lam4Mesh</span><span class="p">,</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)))</span>
        
        <span class="n">xsect</span><span class="o">.</span><span class="n">nodeDict</span> <span class="o">=</span> <span class="n">nodeDict</span>
        
        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">xsect</span><span class="o">.</span><span class="n">laminates</span><span class="p">)):</span>
            <span class="n">ylen</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">size</span><span class="p">(</span><span class="n">xsect</span><span class="o">.</span><span class="n">laminates</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">mesh</span><span class="p">,</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span>
            <span class="n">xlen</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">size</span><span class="p">(</span><span class="n">xsect</span><span class="o">.</span><span class="n">laminates</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">mesh</span><span class="p">,</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span>
            <span class="c"># Ovearhead for later plotting of the cross-section. Will allow</span>
            <span class="c"># for discontinuities in the contour should it arise (ie in</span>
            <span class="c"># stress or strain contours).</span>
            <span class="n">xsect</span><span class="o">.</span><span class="n">laminates</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">plotx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">ylen</span><span class="o">*</span><span class="mi">2</span><span class="p">,</span><span class="n">xlen</span><span class="o">*</span><span class="mi">2</span><span class="p">))</span>
            <span class="n">xsect</span><span class="o">.</span><span class="n">laminates</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">ploty</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">ylen</span><span class="o">*</span><span class="mi">2</span><span class="p">,</span><span class="n">xlen</span><span class="o">*</span><span class="mi">2</span><span class="p">))</span>
            <span class="n">xsect</span><span class="o">.</span><span class="n">laminates</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">plotz</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">ylen</span><span class="o">*</span><span class="mi">2</span><span class="p">,</span><span class="n">xlen</span><span class="o">*</span><span class="mi">2</span><span class="p">))</span>
            <span class="n">xsect</span><span class="o">.</span><span class="n">laminates</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">plotc</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">ylen</span><span class="o">*</span><span class="mi">2</span><span class="p">,</span><span class="n">xlen</span><span class="o">*</span><span class="mi">2</span><span class="p">))</span>
            <span class="n">xsect</span><span class="o">.</span><span class="n">laminates</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">EIDmesh</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">ylen</span><span class="p">,</span><span class="n">xlen</span><span class="p">),</span><span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">ylen</span><span class="p">):</span>
                <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">xlen</span><span class="p">):</span>
                    <span class="n">newEID</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="nb">max</span><span class="p">(</span><span class="n">elemDict</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
                    <span class="n">NIDs</span> <span class="o">=</span> <span class="p">[</span><span class="n">xsect</span><span class="o">.</span><span class="n">laminates</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">mesh</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">j</span><span class="p">],</span><span class="n">xsect</span><span class="o">.</span><span class="n">laminates</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">mesh</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">],</span>\
                        <span class="n">xsect</span><span class="o">.</span><span class="n">laminates</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">mesh</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">],</span><span class="n">xsect</span><span class="o">.</span><span class="n">laminates</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">mesh</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]]</span>
                    <span class="n">nodes</span> <span class="o">=</span> <span class="p">[</span><span class="n">xsect</span><span class="o">.</span><span class="n">nodeDict</span><span class="p">[</span><span class="n">NID</span><span class="p">]</span> <span class="k">for</span> <span class="n">NID</span> <span class="ow">in</span> <span class="n">NIDs</span><span class="p">]</span>
                    <span class="k">if</span> <span class="n">k</span><span class="o">==</span><span class="mi">0</span><span class="p">:</span>
                        <span class="n">MID</span> <span class="o">=</span> <span class="n">xsect</span><span class="o">.</span><span class="n">laminates</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">plies</span><span class="p">[</span><span class="o">-</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">MID</span>
                        <span class="n">th</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="n">xsect</span><span class="o">.</span><span class="n">laminates</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">plies</span><span class="p">[</span><span class="o">-</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">th</span><span class="p">,</span><span class="n">thz</span><span class="p">[</span><span class="n">k</span><span class="p">]]</span>
                    <span class="k">elif</span> <span class="n">k</span><span class="o">==</span><span class="mi">1</span><span class="p">:</span>
                        <span class="n">MID</span> <span class="o">=</span> <span class="n">xsect</span><span class="o">.</span><span class="n">laminates</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">plies</span><span class="p">[</span><span class="o">-</span><span class="n">j</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">MID</span>
                        <span class="n">th</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="n">xsect</span><span class="o">.</span><span class="n">laminates</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">plies</span><span class="p">[</span><span class="o">-</span><span class="n">j</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">th</span><span class="p">,</span><span class="n">thz</span><span class="p">[</span><span class="n">k</span><span class="p">]]</span>
                    <span class="k">elif</span> <span class="n">k</span><span class="o">==</span><span class="mi">2</span><span class="p">:</span>
                        <span class="n">MID</span> <span class="o">=</span> <span class="n">xsect</span><span class="o">.</span><span class="n">laminates</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">plies</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">MID</span>
                        <span class="n">th</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="n">xsect</span><span class="o">.</span><span class="n">laminates</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">plies</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">th</span><span class="p">,</span><span class="n">thz</span><span class="p">[</span><span class="n">k</span><span class="p">]]</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">MID</span> <span class="o">=</span> <span class="n">xsect</span><span class="o">.</span><span class="n">laminates</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">plies</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">MID</span>
                        <span class="n">th</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="n">xsect</span><span class="o">.</span><span class="n">laminates</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">plies</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">th</span><span class="p">,</span><span class="n">thz</span><span class="p">[</span><span class="n">k</span><span class="p">]]</span>
                    <span class="n">elemDict</span><span class="p">[</span><span class="n">newEID</span><span class="p">]</span> <span class="o">=</span> <span class="n">CQUADX</span><span class="p">(</span><span class="n">newEID</span><span class="p">,</span><span class="n">nodes</span><span class="p">,</span><span class="n">MID</span><span class="p">,</span><span class="n">matlib</span><span class="p">,</span><span class="n">th</span><span class="o">=</span><span class="n">th</span><span class="p">)</span>
                    <span class="n">xsect</span><span class="o">.</span><span class="n">laminates</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">EIDmesh</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">newEID</span>
        <span class="n">xsect</span><span class="o">.</span><span class="n">elemDict</span> <span class="o">=</span> <span class="n">elemDict</span>
        <span class="k">del</span> <span class="n">xsect</span><span class="o">.</span><span class="n">nodeDict</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="k">del</span> <span class="n">xsect</span><span class="o">.</span><span class="n">elemDict</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span></div></div>
<div class="viewcode-block" id="XSect"><a class="viewcode-back" href="../../structures.html#AeroComBAT.Structures.XSect">[docs]</a><span class="k">class</span> <span class="nc">XSect</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Creates a beam cross-section object,</span>
<span class="sd">    </span>
<span class="sd">    This cross-section can be made of multiple materials which can be in</span>
<span class="sd">    general anisotropic. This is the main workhorse within the structures</span>
<span class="sd">    library.</span>
<span class="sd">    </span>
<span class="sd">    :Attributes:</span>
<span class="sd">    </span>
<span class="sd">    - `Color (touple)`: A length 3 touple used to define the color of the</span>
<span class="sd">        cross-section.</span>
<span class="sd">    - `Airfoil (obj)`: The airfoil object used to define the OML of the cross-</span>
<span class="sd">        section.</span>
<span class="sd">    - `typeXSect (str)`: Defines what type of cross-section is to be used.</span>
<span class="sd">        Currently the only supported type is &#39;box&#39;.</span>
<span class="sd">    - `normalVector (1x3 np.array[float])`: Expresses the normal vector of the</span>
<span class="sd">        cross-section.</span>
<span class="sd">    - `nodeDict (dict)`: A dictionary of all nodes used to descretize the</span>
<span class="sd">        cross-section surface. The keys are the NIDs and the values stored</span>
<span class="sd">        are the Node objects.</span>
<span class="sd">    - `elemDict (dict)`: A dictionary of all elements used to descretize the</span>
<span class="sd">        cross-section surface. the keys are the EIDs and the values stored</span>
<span class="sd">        are the element objects.</span>
<span class="sd">    - `X (ndx6 np.array[float])`: A very large 2D array. This is one of the</span>
<span class="sd">        results of the cross-sectional analysis. This array relays the</span>
<span class="sd">        force and moment resultants applied to the cross-section to the</span>
<span class="sd">        nodal warping displacements exhibited by the cross-section.</span>
<span class="sd">    - `Y (6x6 np.array[float])`: This array relays the force and moment</span>
<span class="sd">        resultants applied to the cross-section to the rigid section</span>
<span class="sd">        strains and curvatures exhibited by the cross-section.</span>
<span class="sd">    - `dXdz (ndx6 np.array[float])`: A very large 2D array. This is one of the</span>
<span class="sd">        results of the cross-sectional analysis. This array relays the</span>
<span class="sd">        force and moment resultants applied to the cross-section to the</span>
<span class="sd">        gradient of the nodal warping displacements exhibited by the</span>
<span class="sd">        cross-section with respect to the beam axis.</span>
<span class="sd">    - `xt (float)`: The x-coordinate of the tension center (point at which</span>
<span class="sd">        tension and bending are decoupled)</span>
<span class="sd">    - `yt (float)`: The y-coordinate of the tension center (point at which</span>
<span class="sd">        tension and bending are decoupled)</span>
<span class="sd">    - `xs (float)`: The x-coordinate of the shear center (point at which shear</span>
<span class="sd">        and torsion are decoupled)</span>
<span class="sd">    - `ys (float)`: The y-coordinate of the shear center (point at which shear</span>
<span class="sd">        and torsion are decoupled)</span>
<span class="sd">    - `refAxis (3x1 np.array[float])`: A column vector containing the reference</span>
<span class="sd">        axis for the beam.</span>
<span class="sd">    - `bendAxes (2x3 np.array[float])`: Contains two row vectors about which</span>
<span class="sd">        bending from one axis is decoupled from bending about the other.</span>
<span class="sd">    - `F_raw (6x6 np.array[float])`: The 6x6 compliance matrix that results</span>
<span class="sd">        from cross-sectional analysis. This is the case where the reference</span>
<span class="sd">        axis is at the origin.</span>
<span class="sd">    - `K_raw (6x6 np.array[float])`: The 6x6 stiffness matrix that results</span>
<span class="sd">        from cross-sectional analysis. This is the case where the reference</span>
<span class="sd">        axis is at the origin.</span>
<span class="sd">    - `F (6x6 np.array[float])`: The 6x6 compliance matrix for the cross-</span>
<span class="sd">        section about the reference axis. The reference axis is by default</span>
<span class="sd">        at the shear center.</span>
<span class="sd">    - `K (6x6 np.array[float])`: The 6x6 stiffness matrix for the cross-</span>
<span class="sd">        section about the reference axis. The reference axis is by default</span>
<span class="sd">        at the shear center.</span>
<span class="sd">    - `T1 (3x6 np.array[float])`: The transformation matrix that converts</span>
<span class="sd">        strains and curvatures from the local xsect origin to the reference</span>
<span class="sd">        axis.</span>
<span class="sd">    - `T2 (3x6 np.array[float])`: The transformation matrix that converts</span>
<span class="sd">        forces and moments from the local xsect origin to the reference</span>
<span class="sd">        axis.</span>
<span class="sd">    - `x_m (1x3 np.array[float])`: Center of mass of the cross-section about in</span>
<span class="sd">        the local xsect CSYS</span>
<span class="sd">    - `M (6x6 np.array[float])`: This mass matrix relays linear and angular</span>
<span class="sd">        velocities to linear and angular momentum of the cross-section.</span>
<span class="sd">        </span>

<span class="sd">    :Methods:</span>
<span class="sd">    </span>
<span class="sd">    - `resetResults`: This method resets all results (displacements, strains</span>
<span class="sd">        and stresse) within the elements used by the cross-section object.</span>
<span class="sd">    - `calcWarpEffects`: Given applied force and moment resultants, this method</span>
<span class="sd">        calculates the warping displacement, 3D strains and 3D stresses</span>
<span class="sd">        within the elements used by the cross-section.</span>
<span class="sd">    - `printSummary`: This method is used to print characteristic attributes of</span>
<span class="sd">        the object. This includes the elastic, shear and mass centers, as</span>
<span class="sd">        well as the stiffness matrix and mass matrix.</span>
<span class="sd">    - `plotRigid`: This method plots the rigid cross-section shape, typically</span>
<span class="sd">        in conjunction with a full beam model.</span>
<span class="sd">    - `plotWarped`: This method plots the warped cross-section including a</span>
<span class="sd">        contour criteria, typically in conjuction with the results of the</span>
<span class="sd">        displacement of a full beam model.</span>
<span class="sd">        </span>
<span class="sd">    &quot;&quot;&quot;</span>
<div class="viewcode-block" id="XSect.__init__"><a class="viewcode-back" href="../../structures.html#AeroComBAT.Structures.XSect.__init__">[docs]</a>    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">XID</span><span class="p">,</span><span class="n">Airfoil</span><span class="p">,</span><span class="n">xdim</span><span class="p">,</span><span class="n">laminates</span><span class="p">,</span><span class="n">matlib</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Instantiates a cross-section object.</span>
<span class="sd">        </span>
<span class="sd">        The constructor for the class is effectively responsible for creating</span>
<span class="sd">        the 2D desretized mesh of the cross-section. It is important to note</span>
<span class="sd">        that while meshing technically occurs in the constructor, the work is</span>
<span class="sd">        handeled by another class altogether. While not</span>
<span class="sd">        computationally heavily intensive in itself, it is responsible for</span>
<span class="sd">        creating all of the framework for the cross-sectional analysis.</span>
<span class="sd">        </span>
<span class="sd">        :Args:</span>
<span class="sd">        </span>
<span class="sd">        - `XID (int)`: The cross-section integer identifier.</span>
<span class="sd">        - `Airfoil (obj)`: An airfoil object used to determine the OML shape of</span>
<span class="sd">            the cross-section.</span>
<span class="sd">        - `xdim (1x2 array[float])`: The non-dimensional starting and stoping</span>
<span class="sd">            points of the cross-section. In other words, if you wanted to</span>
<span class="sd">            have your cross-section start at the 1/4 chord and run to the</span>
<span class="sd">            3/4 chord of your airfoil, xdim would look like xdim=[0.25,0.75]</span>
<span class="sd">        - `laminates (1xN array[obj])`: Laminate objects used to create the</span>
<span class="sd">            descretized mesh surface. Do not repeat a laminate within this</span>
<span class="sd">            array! It will referrence this object multiple times and not</span>
<span class="sd">            mesh the cross-section properly then!</span>
<span class="sd">        - `matlib (obj)`: A material library</span>
<span class="sd">        - `typeXSect (str)`: The general shape the cross-section should take.</span>
<span class="sd">            Note that currently only a box beam profile is supported.</span>
<span class="sd">            More shapes and the ability to add stiffeners to the</span>
<span class="sd">            cross-section will come in later updates.</span>
<span class="sd">        - `meshSize (int)`: The maximum aspect ratio you would like your 2D</span>
<span class="sd">            CQUADX elements to exhibit within the cross-section.</span>
<span class="sd">            </span>
<span class="sd">        :Returns:</span>
<span class="sd">        </span>
<span class="sd">        - None</span>
<span class="sd">            </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c">#Save the cross-section ID</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">XID</span> <span class="o">=</span> <span class="n">XID</span>
        <span class="c"># Save the cross-section type:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">typeXSect</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s">&#39;typeXSect&#39;</span><span class="p">,</span><span class="s">&#39;box&#39;</span><span class="p">)</span>
        <span class="c"># Meshing aspect ratio</span>
        <span class="n">meshSize</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s">&#39;meshSize&#39;</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span>
        <span class="c"># Initialize plotting color for the cross-section</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">color</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s">&#39;color&#39;</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span>
        <span class="c"># Save the airfoil object used to define the OML of the cross-section</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">airfoil</span> <span class="o">=</span> <span class="n">Airfoil</span>
        <span class="c"># Save the laminate array (and thus laminate objects) to be used</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">laminates</span> <span class="o">=</span> <span class="n">laminates</span>
        <span class="c"># Save the vector normal to the plane of the cross-section in the</span>
        <span class="c"># global coordinate system</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">normal_vector</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.</span><span class="p">,</span><span class="mf">0.</span><span class="p">,</span><span class="mf">1.</span><span class="p">])</span>
        <span class="n">x0</span> <span class="o">=</span> <span class="n">xdim</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">xf</span> <span class="o">=</span> <span class="n">xdim</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        
        <span class="n">mesher</span> <span class="o">=</span> <span class="n">Mesher</span><span class="p">()</span>
        <span class="c"># Begin the meshing process for a box beam cross-section profile</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">typeXSect</span><span class="o">==</span><span class="s">&#39;box&#39;</span><span class="p">:</span>
            <span class="n">mesher</span><span class="o">.</span><span class="n">boxBeam</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">meshSize</span><span class="p">,</span><span class="n">x0</span><span class="p">,</span><span class="n">xf</span><span class="p">,</span><span class="n">matlib</span><span class="p">)</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">typeXSect</span><span class="o">==</span><span class="s">&#39;circle&#39;</span><span class="p">:</span>
            <span class="n">r</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s">&#39;r&#39;</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">airfoil</span><span class="o">.</span><span class="n">c</span><span class="p">)</span>
            <span class="n">mesher</span><span class="o">.</span><span class="n">cylindricalTube</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">r</span><span class="p">,</span><span class="n">meshSize</span><span class="p">,</span><span class="n">x0</span><span class="p">,</span><span class="n">xf</span><span class="p">,</span><span class="n">matlib</span><span class="p">)</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">typeXSect</span><span class="o">==</span><span class="s">&#39;laminate&#39;</span><span class="p">:</span>
            <span class="n">mesher</span><span class="o">.</span><span class="n">laminate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">meshSize</span><span class="p">,</span> <span class="n">x0</span><span class="p">,</span> <span class="n">xf</span><span class="p">,</span> <span class="n">matlib</span><span class="p">)</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">typeXSect</span><span class="o">==</span><span class="s">&#39;rectBox&#39;</span><span class="p">:</span>
            <span class="n">mesher</span><span class="o">.</span><span class="n">rectBoxBeam</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">meshSize</span><span class="p">,</span> <span class="n">x0</span><span class="p">,</span> <span class="n">xf</span><span class="p">,</span> <span class="n">matlib</span><span class="p">)</span>
            </div>
<div class="viewcode-block" id="XSect.xSectionAnalysis"><a class="viewcode-back" href="../../structures.html#AeroComBAT.Structures.XSect.xSectionAnalysis">[docs]</a>    <span class="k">def</span> <span class="nf">xSectionAnalysis</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Analyzes an initialized corss-section.</span>
<span class="sd">        </span>
<span class="sd">        This is the main workhorse of the class. This method assembles the</span>
<span class="sd">        finite element model generated using the meshing class, and solve the</span>
<span class="sd">        HIGH dimensional equilibrium equations associated with the cross-</span>
<span class="sd">        section. In doing so, it generates the warping displacement, the</span>
<span class="sd">        section strain, and the gradient of the warping displacement along the</span>
<span class="sd">        beam axis as a function of force-moment resultants. With these three</span>
<span class="sd">        things, the 3D strains-&gt;stresses can be recovered.</span>
<span class="sd">        </span>
<span class="sd">        This method has been EXTENSIVELY tested and validated against</span>
<span class="sd">        various sources (see theory guide for more info). Since this method</span>
<span class="sd">        is so robust, the biggest limitation of the XSect class is what the</span>
<span class="sd">        mesher is capable of meshing. Finally, keep in mind that due to the</span>
<span class="sd">        high dimensionality of this problem, this method uses up a lot of</span>
<span class="sd">        resources (primarily memory). If this method is taking too many</span>
<span class="sd">        resources, choose a larger aspect ratio for your XSect initialization.</span>
<span class="sd">        </span>
<span class="sd">        :Args:</span>
<span class="sd">        </span>
<span class="sd">        - `ref_ax (str or 1x2 array[float])`: Currently there are two supported</span>
<span class="sd">            input types for this class. The first is the are string key-words.</span>
<span class="sd">            These are &#39;shearCntr&#39;, &#39;massCntr&#39;, and &#39;origin&#39;. Currently</span>
<span class="sd">            &#39;shearCntr&#39; is the default value. Also suported is the ability to</span>
<span class="sd">            pass a length 2 array containing the x and y coordinates of the</span>
<span class="sd">            reference axis relative to the origin. This would take the form of:</span>
<span class="sd">            ref_ax=[1.,3.] to put the reference axis at x,y = 1.,3.</span>
<span class="sd">            </span>
<span class="sd">        :Returns:</span>
<span class="sd">        </span>
<span class="sd">        - None</span>
<span class="sd">            </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c"># Initialize the reference axis:</span>
        <span class="n">ref_ax</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s">&#39;ref_ax&#39;</span><span class="p">,</span><span class="s">&#39;shearCntr&#39;</span><span class="p">)</span>
        <span class="c"># Create local reference to the node dictionary</span>
        <span class="n">nodeDict</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">nodeDict</span>
        <span class="c"># Create local reference to the element dictionary</span>
        <span class="n">elemDict</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">elemDict</span>
        <span class="c"># Initialize the D matrix, responsible for decoupling rigid cross-</span>
        <span class="c"># section displacement from warping cross-section displacement</span>
        <span class="n">nd</span> <span class="o">=</span> <span class="mi">3</span><span class="o">*</span><span class="nb">len</span><span class="p">(</span><span class="n">nodeDict</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
        <span class="n">D</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">6</span><span class="p">,</span><span class="n">nd</span><span class="p">))</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">nodeDict</span><span class="o">.</span><span class="n">keys</span><span class="p">())):</span>
            <span class="n">tmpNode</span> <span class="o">=</span> <span class="n">nodeDict</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
            <span class="n">tempx</span> <span class="o">=</span> <span class="n">tmpNode</span><span class="o">.</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">tempy</span> <span class="o">=</span> <span class="n">tmpNode</span><span class="o">.</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
            <span class="n">D</span><span class="p">[:,</span><span class="mi">3</span><span class="o">*</span><span class="n">i</span><span class="p">:</span><span class="mi">3</span><span class="o">*</span><span class="n">i</span><span class="o">+</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span>\
                                       <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span>\
                                       <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span>\
                                       <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="n">tempy</span><span class="p">],</span>\
                                       <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="n">tempx</span><span class="p">],</span>\
                                       <span class="p">[</span><span class="o">-</span><span class="n">tempy</span><span class="p">,</span><span class="n">tempx</span><span class="p">,</span><span class="mi">0</span><span class="p">]])</span>
        <span class="n">D</span> <span class="o">=</span> <span class="n">D</span><span class="o">.</span><span class="n">T</span>
        <span class="c"># Initialize Matricies used in solving the equilibruim equations:</span>
        <span class="n">Tr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">6</span><span class="p">,</span><span class="mi">6</span><span class="p">));</span><span class="n">Tr</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">4</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span><span class="n">Tr</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="n">A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">6</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span>
        <span class="n">E</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">nd</span><span class="p">,</span><span class="n">nd</span><span class="p">))</span>
        <span class="n">L</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">nd</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span>
        <span class="n">R</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">nd</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span>
        <span class="n">C</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">nd</span><span class="p">,</span><span class="n">nd</span><span class="p">))</span>
        <span class="n">M</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">nd</span><span class="p">,</span><span class="n">nd</span><span class="p">))</span>
        <span class="n">Z6</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">6</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span>
        <span class="c"># Initialize the cross-section mass per unit length</span>
        <span class="n">m</span> <span class="o">=</span> <span class="mf">0.</span>
        <span class="c"># Initialize the first mass moment of inertia about x</span>
        <span class="n">xm</span> <span class="o">=</span> <span class="mf">0.</span>
        <span class="c"># Initialize the first mass moment of inertia about y</span>
        <span class="n">ym</span> <span class="o">=</span> <span class="mf">0.</span>
        <span class="c">#for i in range(0,len(elemDict.keys())):</span>
        <span class="c"># For all elements in the cross-section mesh</span>
        <span class="k">for</span> <span class="n">EID</span><span class="p">,</span> <span class="n">elem</span> <span class="ow">in</span> <span class="n">elemDict</span><span class="o">.</span><span class="n">iteritems</span><span class="p">():</span>
            <span class="c">#Select the element</span>
            <span class="c">#tempElem = elemDict[i]</span>
            <span class="c"># Get the NIDs reference by the element</span>
            <span class="n">tempNodes</span> <span class="o">=</span> <span class="n">elem</span><span class="o">.</span><span class="n">NIDs</span>
            <span class="c"># Update the cross-section mass</span>
            <span class="n">m</span> <span class="o">+=</span> <span class="n">elem</span><span class="o">.</span><span class="n">mass</span>
            <span class="c"># Update the first mass moment of ineratia about x</span>
            <span class="n">xm</span><span class="o">+=</span> <span class="n">elem</span><span class="o">.</span><span class="n">mass</span><span class="o">*</span><span class="n">elem</span><span class="o">.</span><span class="n">x</span><span class="p">(</span><span class="mf">0.</span><span class="p">,</span><span class="mf">0.</span><span class="p">)</span>
            <span class="c"># Update the first mass moment of ineratia about y</span>
            <span class="n">ym</span><span class="o">+=</span> <span class="n">elem</span><span class="o">.</span><span class="n">mass</span><span class="o">*</span><span class="n">elem</span><span class="o">.</span><span class="n">y</span><span class="p">(</span><span class="mf">0.</span><span class="p">,</span><span class="mf">0.</span><span class="p">)</span>
            <span class="c"># If the 2D element is a CQUADX</span>
            <span class="k">if</span> <span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">elem</span><span class="o">.</span><span class="n">type</span><span class="p">)</span><span class="o">==</span><span class="s">&#39;CQUADX&#39;</span><span class="p">):</span>
                <span class="c"># Create local references to the element equilibrium matricies</span>
                <span class="n">A</span> <span class="o">=</span> <span class="n">A</span> <span class="o">+</span> <span class="n">elem</span><span class="o">.</span><span class="n">Ae</span>
                <span class="n">Re</span> <span class="o">=</span> <span class="n">elem</span><span class="o">.</span><span class="n">Re</span>
                <span class="n">Ee</span> <span class="o">=</span> <span class="n">elem</span><span class="o">.</span><span class="n">Ee</span>
                <span class="n">Ce</span> <span class="o">=</span> <span class="n">elem</span><span class="o">.</span><span class="n">Ce</span>
                <span class="n">Le</span> <span class="o">=</span> <span class="n">elem</span><span class="o">.</span><span class="n">Le</span>
                <span class="n">Me</span> <span class="o">=</span> <span class="n">elem</span><span class="o">.</span><span class="n">Me</span>
                
                <span class="c"># Cross-section finite element matrix assembely</span>
                <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">tempNodes</span><span class="p">)):</span>
                    <span class="n">row</span> <span class="o">=</span> <span class="n">tempNodes</span><span class="p">[</span><span class="n">j</span><span class="p">]</span>
                    <span class="n">R</span><span class="p">[</span><span class="mi">3</span><span class="o">*</span><span class="n">row</span><span class="p">:</span><span class="mi">3</span><span class="o">*</span><span class="n">row</span><span class="o">+</span><span class="mi">3</span><span class="p">,:]</span> <span class="o">=</span> <span class="n">R</span><span class="p">[</span><span class="mi">3</span><span class="o">*</span><span class="n">row</span><span class="p">:</span><span class="mi">3</span><span class="o">*</span><span class="n">row</span><span class="o">+</span><span class="mi">3</span><span class="p">,:]</span> <span class="o">+</span> <span class="n">Re</span><span class="p">[</span><span class="mi">3</span><span class="o">*</span><span class="n">j</span><span class="p">:</span><span class="mi">3</span><span class="o">*</span><span class="n">j</span><span class="o">+</span><span class="mi">3</span><span class="p">,:]</span>
                    <span class="n">L</span><span class="p">[</span><span class="mi">3</span><span class="o">*</span><span class="n">row</span><span class="p">:</span><span class="mi">3</span><span class="o">*</span><span class="n">row</span><span class="o">+</span><span class="mi">3</span><span class="p">,:]</span> <span class="o">=</span> <span class="n">L</span><span class="p">[</span><span class="mi">3</span><span class="o">*</span><span class="n">row</span><span class="p">:</span><span class="mi">3</span><span class="o">*</span><span class="n">row</span><span class="o">+</span><span class="mi">3</span><span class="p">,:]</span> <span class="o">+</span> <span class="n">Le</span><span class="p">[</span><span class="mi">3</span><span class="o">*</span><span class="n">j</span><span class="p">:</span><span class="mi">3</span><span class="o">*</span><span class="n">j</span><span class="o">+</span><span class="mi">3</span><span class="p">,:]</span>
                    <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">tempNodes</span><span class="p">)):</span>
                        <span class="n">col</span> <span class="o">=</span> <span class="n">tempNodes</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>
                        <span class="n">E</span><span class="p">[</span><span class="mi">3</span><span class="o">*</span><span class="n">row</span><span class="p">:</span><span class="mi">3</span><span class="o">*</span><span class="n">row</span><span class="o">+</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="o">*</span><span class="n">col</span><span class="p">:</span><span class="mi">3</span><span class="o">*</span><span class="n">col</span><span class="o">+</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="n">E</span><span class="p">[</span><span class="mi">3</span><span class="o">*</span><span class="n">row</span><span class="p">:</span><span class="mi">3</span><span class="o">*</span><span class="n">row</span><span class="o">+</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="o">*</span><span class="n">col</span><span class="p">:</span><span class="mi">3</span><span class="o">*</span><span class="n">col</span><span class="o">+</span><span class="mi">3</span><span class="p">]</span> <span class="o">+</span> <span class="n">Ee</span><span class="p">[</span><span class="mi">3</span><span class="o">*</span><span class="n">j</span><span class="p">:</span><span class="mi">3</span><span class="o">*</span><span class="n">j</span><span class="o">+</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="o">*</span><span class="n">k</span><span class="p">:</span><span class="mi">3</span><span class="o">*</span><span class="n">k</span><span class="o">+</span><span class="mi">3</span><span class="p">]</span>
                        <span class="n">C</span><span class="p">[</span><span class="mi">3</span><span class="o">*</span><span class="n">row</span><span class="p">:</span><span class="mi">3</span><span class="o">*</span><span class="n">row</span><span class="o">+</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="o">*</span><span class="n">col</span><span class="p">:</span><span class="mi">3</span><span class="o">*</span><span class="n">col</span><span class="o">+</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="n">C</span><span class="p">[</span><span class="mi">3</span><span class="o">*</span><span class="n">row</span><span class="p">:</span><span class="mi">3</span><span class="o">*</span><span class="n">row</span><span class="o">+</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="o">*</span><span class="n">col</span><span class="p">:</span><span class="mi">3</span><span class="o">*</span><span class="n">col</span><span class="o">+</span><span class="mi">3</span><span class="p">]</span> <span class="o">+</span> <span class="n">Ce</span><span class="p">[</span><span class="mi">3</span><span class="o">*</span><span class="n">j</span><span class="p">:</span><span class="mi">3</span><span class="o">*</span><span class="n">j</span><span class="o">+</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="o">*</span><span class="n">k</span><span class="p">:</span><span class="mi">3</span><span class="o">*</span><span class="n">k</span><span class="o">+</span><span class="mi">3</span><span class="p">]</span>
                        <span class="n">M</span><span class="p">[</span><span class="mi">3</span><span class="o">*</span><span class="n">row</span><span class="p">:</span><span class="mi">3</span><span class="o">*</span><span class="n">row</span><span class="o">+</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="o">*</span><span class="n">col</span><span class="p">:</span><span class="mi">3</span><span class="o">*</span><span class="n">col</span><span class="o">+</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="n">M</span><span class="p">[</span><span class="mi">3</span><span class="o">*</span><span class="n">row</span><span class="p">:</span><span class="mi">3</span><span class="o">*</span><span class="n">row</span><span class="o">+</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="o">*</span><span class="n">col</span><span class="p">:</span><span class="mi">3</span><span class="o">*</span><span class="n">col</span><span class="o">+</span><span class="mi">3</span><span class="p">]</span> <span class="o">+</span> <span class="n">Me</span><span class="p">[</span><span class="mi">3</span><span class="o">*</span><span class="n">j</span><span class="p">:</span><span class="mi">3</span><span class="o">*</span><span class="n">j</span><span class="o">+</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="o">*</span><span class="n">k</span><span class="p">:</span><span class="mi">3</span><span class="o">*</span><span class="n">k</span><span class="o">+</span><span class="mi">3</span><span class="p">]</span>
            <span class="k">elif</span> <span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">elem</span><span class="o">.</span><span class="n">type</span><span class="p">)</span><span class="o">==</span><span class="s">&#39;TRIA3&#39;</span><span class="p">):</span>
                <span class="c">#TODO: Still need to add a TRIA3 class</span>
                <span class="k">pass</span>
        <span class="c"># Cross-section matricies currently not saved to xsect object to save</span>
        <span class="c"># memory.</span>
        <span class="c">#self.A = A</span>
        <span class="c">#self.R = R</span>
        <span class="c">#self.E = E</span>
        <span class="c">#self.C = C</span>
        <span class="c">#self.L = L</span>
        <span class="c">#self.M = M</span>
                
        <span class="c"># SOLVING THE EQUILIBRIUM EQUATIONS</span>
        <span class="c"># Assemble state matrix for first equation</span>
        <span class="n">EquiA1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">((</span><span class="n">np</span><span class="o">.</span><span class="n">hstack</span><span class="p">((</span><span class="n">E</span><span class="p">,</span><span class="n">R</span><span class="p">,</span><span class="n">D</span><span class="p">)),</span><span class="n">np</span><span class="o">.</span><span class="n">hstack</span><span class="p">((</span><span class="n">R</span><span class="o">.</span><span class="n">T</span><span class="p">,</span><span class="n">A</span><span class="p">,</span><span class="n">Z6</span><span class="p">)),</span>\
                                        <span class="n">np</span><span class="o">.</span><span class="n">hstack</span><span class="p">((</span><span class="n">D</span><span class="o">.</span><span class="n">T</span><span class="p">,</span><span class="n">Z6</span><span class="p">,</span><span class="n">Z6</span><span class="p">))))</span>
        <span class="c"># Assemble solution vector for first equation</span>
        <span class="n">Equib1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">((</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">nd</span><span class="p">,</span><span class="mi">6</span><span class="p">)),</span><span class="n">Tr</span><span class="o">.</span><span class="n">T</span><span class="p">,</span><span class="n">Z6</span><span class="p">))</span>
        <span class="c"># LU factorize state matrix as it will be used twice</span>
        <span class="n">lu</span><span class="p">,</span><span class="n">piv</span> <span class="o">=</span> <span class="n">sci</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">lu_factor</span><span class="p">(</span><span class="n">EquiA1</span><span class="p">)</span>
        <span class="c"># Solve system</span>
        <span class="n">sol1</span> <span class="o">=</span> <span class="n">sci</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">lu_solve</span><span class="p">((</span><span class="n">lu</span><span class="p">,</span><span class="n">piv</span><span class="p">),</span><span class="n">Equib1</span><span class="p">,</span><span class="n">check_finite</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
        <span class="c"># Recover gradient of displacement as a function of force and moment</span>
        <span class="c"># resutlants</span>
        <span class="n">dXdz</span> <span class="o">=</span> <span class="n">sol1</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">nd</span><span class="p">,:]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dXdz</span> <span class="o">=</span> <span class="n">sol1</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">nd</span><span class="p">,:]</span>
        <span class="c"># Save the gradient of section strains as a function of force and</span>
        <span class="c"># moment resultants</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dYdz</span> <span class="o">=</span> <span class="n">sol1</span><span class="p">[</span><span class="n">nd</span><span class="p">:</span><span class="n">nd</span><span class="o">+</span><span class="mi">6</span><span class="p">,:]</span>
        <span class="c"># Set up the first of two solution vectors for second equation</span>
        <span class="n">Equib2_1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">((</span><span class="n">np</span><span class="o">.</span><span class="n">hstack</span><span class="p">((</span><span class="o">-</span><span class="p">(</span><span class="n">C</span><span class="o">-</span><span class="n">C</span><span class="o">.</span><span class="n">T</span><span class="p">),</span><span class="n">L</span><span class="p">)),</span><span class="n">np</span><span class="o">.</span><span class="n">hstack</span><span class="p">((</span><span class="o">-</span><span class="n">L</span><span class="o">.</span><span class="n">T</span><span class="p">,</span><span class="n">Z6</span><span class="p">)),</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">6</span><span class="p">,</span><span class="n">nd</span><span class="o">+</span><span class="mi">6</span><span class="p">))))</span>
        <span class="c"># Set up the second of two solution vectors for second equation</span>
        <span class="n">Equib2_2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">((</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">nd</span><span class="p">,</span><span class="mi">6</span><span class="p">)),</span><span class="n">np</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="mi">6</span><span class="p">),</span><span class="n">Z6</span><span class="p">))</span>
        <span class="c"># Add solution vectors and solve second equillibrium equation</span>
        <span class="n">sol2</span> <span class="o">=</span> <span class="n">sci</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">lu_solve</span><span class="p">((</span><span class="n">lu</span><span class="p">,</span><span class="n">piv</span><span class="p">),</span><span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">Equib2_1</span><span class="p">,</span><span class="n">sol1</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">nd</span><span class="o">+</span><span class="mi">6</span><span class="p">,:])</span><span class="o">+</span><span class="n">Equib2_2</span><span class="p">)</span>
        <span class="n">X</span> <span class="o">=</span> <span class="n">sol2</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">nd</span><span class="p">,</span><span class="mi">0</span><span class="p">:</span><span class="mi">6</span><span class="p">]</span>
        <span class="c"># Store the warping displacement as a funtion of force and moment</span>
        <span class="c"># resultants</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">X</span> <span class="o">=</span> <span class="n">X</span>
        <span class="c"># Store the section strain as a function of force and moment resultants</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Y</span> <span class="o">=</span> <span class="n">Y</span> <span class="o">=</span> <span class="n">sol2</span><span class="p">[</span><span class="n">nd</span><span class="p">:</span><span class="n">nd</span><span class="o">+</span><span class="mi">6</span><span class="p">,</span><span class="mi">0</span><span class="p">:</span><span class="mi">6</span><span class="p">]</span>
        <span class="c">#Solve for the cross-section compliance</span>
        <span class="n">comp1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">((</span><span class="n">X</span><span class="p">,</span><span class="n">dXdz</span><span class="p">,</span><span class="n">Y</span><span class="p">))</span>
        <span class="n">comp2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">((</span><span class="n">np</span><span class="o">.</span><span class="n">hstack</span><span class="p">((</span><span class="n">E</span><span class="p">,</span><span class="n">C</span><span class="p">,</span><span class="n">R</span><span class="p">)),</span><span class="n">np</span><span class="o">.</span><span class="n">hstack</span><span class="p">((</span><span class="n">C</span><span class="o">.</span><span class="n">T</span><span class="p">,</span><span class="n">M</span><span class="p">,</span><span class="n">L</span><span class="p">)),</span><span class="n">np</span><span class="o">.</span><span class="n">hstack</span><span class="p">((</span><span class="n">R</span><span class="o">.</span><span class="n">T</span><span class="p">,</span><span class="n">L</span><span class="o">.</span><span class="n">T</span><span class="p">,</span><span class="n">A</span><span class="p">))))</span>
        <span class="n">F</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">comp1</span><span class="o">.</span><span class="n">T</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">comp2</span><span class="p">,</span><span class="n">comp1</span><span class="p">))</span>
        <span class="c"># Store the compliance matrix taken about the xsect origin</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">F_raw</span> <span class="o">=</span> <span class="n">F</span>
        <span class="c"># Store the stiffness matrix taken about the xsect origin</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">K_raw</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">inv</span><span class="p">(</span><span class="n">F</span><span class="p">)</span>
        <span class="c"># Calculate the tension center</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">xt</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="n">F</span><span class="p">[</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">]</span><span class="o">*</span><span class="n">F</span><span class="p">[</span><span class="mi">4</span><span class="p">,</span><span class="mi">2</span><span class="p">]</span><span class="o">+</span><span class="n">F</span><span class="p">[</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">]</span><span class="o">*</span><span class="n">F</span><span class="p">[</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span><span class="o">/</span><span class="p">(</span><span class="n">F</span><span class="p">[</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">]</span><span class="o">*</span><span class="n">F</span><span class="p">[</span><span class="mi">4</span><span class="p">,</span><span class="mi">4</span><span class="p">]</span><span class="o">-</span><span class="n">F</span><span class="p">[</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">yt</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="n">F</span><span class="p">[</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">]</span><span class="o">*</span><span class="n">F</span><span class="p">[</span><span class="mi">4</span><span class="p">,</span><span class="mi">4</span><span class="p">]</span><span class="o">+</span><span class="n">F</span><span class="p">[</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">]</span><span class="o">*</span><span class="n">F</span><span class="p">[</span><span class="mi">4</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span><span class="o">/</span><span class="p">(</span><span class="n">F</span><span class="p">[</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">]</span><span class="o">*</span><span class="n">F</span><span class="p">[</span><span class="mi">4</span><span class="p">,</span><span class="mi">4</span><span class="p">]</span><span class="o">-</span><span class="n">F</span><span class="p">[</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
        <span class="c"># Calculate axis about which bedning is decoupled</span>
        <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">K_raw</span><span class="p">[</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">])</span><span class="o">&lt;</span><span class="mf">0.1</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">bendAxes</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mf">1.</span><span class="p">,</span><span class="mf">0.</span><span class="p">,</span><span class="mf">0.</span><span class="p">,],[</span><span class="mf">0.</span><span class="p">,</span><span class="mf">1.</span><span class="p">,</span><span class="mf">0.</span><span class="p">]])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">trash</span><span class="p">,</span><span class="n">axes</span> <span class="o">=</span> <span class="n">sci</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">eig</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="bp">self</span><span class="o">.</span><span class="n">K_raw</span><span class="p">[</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">],</span><span class="bp">self</span><span class="o">.</span><span class="n">K_raw</span><span class="p">[</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">]],</span>\
                        <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">K_raw</span><span class="p">[</span><span class="mi">4</span><span class="p">,</span><span class="mi">3</span><span class="p">],</span><span class="bp">self</span><span class="o">.</span><span class="n">K_raw</span><span class="p">[</span><span class="mi">4</span><span class="p">,</span><span class="mi">4</span><span class="p">]]]))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">bendAxes</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span><span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span><span class="mf">0.</span><span class="p">,],[</span><span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span><span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span><span class="mf">0.</span><span class="p">]])</span>
        <span class="c"># Calculate the location of the shear center neglecting the bending</span>
        <span class="c"># torsion coupling contribution:</span>
        
        <span class="c"># An error tolerance of 1% is chosen as the difference between shear</span>
        <span class="c"># center locations at the beggining and end of the non-dimensional beam</span>
        <span class="n">es</span> <span class="o">=</span> <span class="mf">1.</span>
        <span class="n">z</span> <span class="o">=</span> <span class="mf">1.</span>
        <span class="n">L</span> <span class="o">=</span> <span class="mf">1.</span>
        <span class="n">xs</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="n">F</span><span class="p">[</span><span class="mi">5</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="n">F</span><span class="p">[</span><span class="mi">5</span><span class="p">,</span><span class="mi">3</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="n">L</span><span class="o">-</span><span class="n">z</span><span class="p">))</span><span class="o">/</span><span class="n">F</span><span class="p">[</span><span class="mi">5</span><span class="p">,</span><span class="mi">5</span><span class="p">]</span>
        <span class="n">ys</span> <span class="o">=</span> <span class="p">(</span><span class="n">F</span><span class="p">[</span><span class="mi">5</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="n">F</span><span class="p">[</span><span class="mi">5</span><span class="p">,</span><span class="mi">4</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="n">L</span><span class="o">-</span><span class="n">z</span><span class="p">))</span><span class="o">/</span><span class="n">F</span><span class="p">[</span><span class="mi">5</span><span class="p">,</span><span class="mi">5</span><span class="p">]</span>
        <span class="n">xsz0</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="n">F</span><span class="p">[</span><span class="mi">5</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="n">F</span><span class="p">[</span><span class="mi">5</span><span class="p">,</span><span class="mi">3</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="n">L</span><span class="p">))</span><span class="o">/</span><span class="n">F</span><span class="p">[</span><span class="mi">5</span><span class="p">,</span><span class="mi">5</span><span class="p">]</span>
        <span class="n">ysz0</span> <span class="o">=</span> <span class="p">(</span><span class="n">F</span><span class="p">[</span><span class="mi">5</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="n">F</span><span class="p">[</span><span class="mi">5</span><span class="p">,</span><span class="mi">4</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="n">L</span><span class="p">))</span><span class="o">/</span><span class="n">F</span><span class="p">[</span><span class="mi">5</span><span class="p">,</span><span class="mi">5</span><span class="p">]</span>
        <span class="n">eax</span> <span class="o">=</span> <span class="p">(</span><span class="n">xs</span><span class="o">-</span><span class="n">xsz0</span><span class="p">)</span><span class="o">/</span><span class="n">xs</span><span class="o">*</span><span class="mf">100.</span>
        <span class="n">eay</span> <span class="o">=</span> <span class="p">(</span><span class="n">ys</span><span class="o">-</span><span class="n">ysz0</span><span class="p">)</span><span class="o">/</span><span class="n">ys</span><span class="o">*</span><span class="mf">100.</span>
        <span class="k">if</span> <span class="n">eax</span><span class="o">&gt;</span><span class="n">es</span> <span class="ow">or</span> <span class="n">eay</span><span class="o">&gt;</span><span class="n">es</span><span class="p">:</span>
            <span class="k">print</span><span class="p">(</span><span class="s">&#39;CAUTION: The shear center does not appear to be a cross-&#39;</span>\
                <span class="s">&#39;section property, and will vary along the length of the beam.&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">xs</span> <span class="o">=</span> <span class="n">xs</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ys</span> <span class="o">=</span> <span class="n">ys</span>
        <span class="c"># Calculate the mass center of the cross-section</span>
        <span class="n">Ixx</span> <span class="o">=</span> <span class="mf">0.</span><span class="p">;</span> <span class="n">Ixy</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span> <span class="n">Iyy</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">x_m</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">xm</span><span class="o">/</span><span class="n">m</span><span class="p">,</span><span class="n">ym</span><span class="o">/</span><span class="n">m</span><span class="p">,</span><span class="mf">0.</span><span class="p">])</span>
        <span class="c"># Establish reference axis location</span>
        <span class="k">if</span> <span class="n">ref_ax</span><span class="o">==</span><span class="s">&#39;shearCntr&#39;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">refAxis</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="bp">self</span><span class="o">.</span><span class="n">xs</span><span class="p">],[</span><span class="bp">self</span><span class="o">.</span><span class="n">ys</span><span class="p">],[</span><span class="mf">0.</span><span class="p">]])</span>
            <span class="n">xref</span> <span class="o">=</span> <span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">refAxis</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">yref</span> <span class="o">=</span> <span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">refAxis</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">elif</span> <span class="n">ref_ax</span><span class="o">==</span><span class="s">&#39;massCntr&#39;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">refAxis</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="bp">self</span><span class="o">.</span><span class="n">x_m</span><span class="p">[</span><span class="mi">0</span><span class="p">]],[</span><span class="bp">self</span><span class="o">.</span><span class="n">x_m</span><span class="p">[</span><span class="mi">1</span><span class="p">]],[</span><span class="mf">0.</span><span class="p">]])</span>
            <span class="n">xref</span> <span class="o">=</span> <span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">refAxis</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">yref</span> <span class="o">=</span> <span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">refAxis</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">elif</span> <span class="n">ref_ax</span><span class="o">==</span><span class="s">&#39;origin&#39;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">refAxis</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mf">0.</span><span class="p">],[</span><span class="mf">0.</span><span class="p">],[</span><span class="mf">0.</span><span class="p">]])</span>
            <span class="n">xref</span> <span class="o">=</span> <span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">refAxis</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">yref</span> <span class="o">=</span> <span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">refAxis</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">ref_ax</span><span class="p">)</span><span class="o">==</span><span class="mi">2</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">refAxis</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="n">ref_ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]],[</span><span class="n">ref_ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]],[</span><span class="mf">0.</span><span class="p">]])</span>
                <span class="n">xref</span> <span class="o">=</span> <span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">refAxis</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                <span class="n">yref</span> <span class="o">=</span> <span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">refAxis</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s">&#39;You entered neither a supported reference axis&#39;</span>\
                <span class="s">&#39;keyword, nor a valid length 2 array containing the x and y&#39;</span>\
                <span class="s">&#39;beam axis reference coordinates for the cross-section.&#39;</span><span class="p">)</span>
        <span class="c"># Strain reference axis transformation</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">T1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mf">1.</span><span class="p">,</span><span class="mf">0.</span><span class="p">,</span><span class="mf">0.</span><span class="p">,</span><span class="mf">0.</span><span class="p">,</span><span class="mf">0.</span><span class="p">,</span><span class="o">-</span><span class="n">yref</span><span class="p">],[</span><span class="mf">0.</span><span class="p">,</span><span class="mf">1.</span><span class="p">,</span><span class="mf">0.</span><span class="p">,</span><span class="mf">0.</span><span class="p">,</span><span class="mf">0.</span><span class="p">,</span><span class="n">xref</span><span class="p">],</span>\
            <span class="p">[</span><span class="mf">0.</span><span class="p">,</span><span class="mf">0.</span><span class="p">,</span><span class="mf">1.</span><span class="p">,</span><span class="n">yref</span><span class="p">,</span><span class="o">-</span><span class="n">xref</span><span class="p">,</span><span class="mf">0.</span><span class="p">],[</span><span class="mf">0.</span><span class="p">,</span><span class="mf">0.</span><span class="p">,</span><span class="mf">0.</span><span class="p">,</span><span class="mf">1.</span><span class="p">,</span><span class="mf">0.</span><span class="p">,</span><span class="mf">0.</span><span class="p">],[</span><span class="mf">0.</span><span class="p">,</span><span class="mf">0.</span><span class="p">,</span><span class="mf">0.</span><span class="p">,</span><span class="mf">0.</span><span class="p">,</span><span class="mf">1.</span><span class="p">,</span><span class="mf">0.</span><span class="p">],</span>\
            <span class="p">[</span><span class="mf">0.</span><span class="p">,</span><span class="mf">0.</span><span class="p">,</span><span class="mf">0.</span><span class="p">,</span><span class="mf">0.</span><span class="p">,</span><span class="mf">0.</span><span class="p">,</span><span class="mf">1.</span><span class="p">]])</span>
        <span class="c"># Force reference axis transformation</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">T2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mf">1.</span><span class="p">,</span><span class="mf">0.</span><span class="p">,</span><span class="mf">0.</span><span class="p">,</span><span class="mf">0.</span><span class="p">,</span><span class="mf">0.</span><span class="p">,</span><span class="mf">0.</span><span class="p">],[</span><span class="mf">0.</span><span class="p">,</span><span class="mf">1.</span><span class="p">,</span><span class="mf">0.</span><span class="p">,</span><span class="mf">0.</span><span class="p">,</span><span class="mf">0.</span><span class="p">,</span><span class="mf">0.</span><span class="p">],</span>\
            <span class="p">[</span><span class="mf">0.</span><span class="p">,</span><span class="mf">0.</span><span class="p">,</span><span class="mf">1.</span><span class="p">,</span><span class="mf">0.</span><span class="p">,</span><span class="mf">0.</span><span class="p">,</span><span class="mf">0.</span><span class="p">],[</span><span class="mf">0.</span><span class="p">,</span><span class="mf">0.</span><span class="p">,</span><span class="o">-</span><span class="n">yref</span><span class="p">,</span><span class="mf">1.</span><span class="p">,</span><span class="mf">0.</span><span class="p">,</span><span class="mf">0.</span><span class="p">],[</span><span class="mf">0.</span><span class="p">,</span><span class="mf">0.</span><span class="p">,</span><span class="n">xref</span><span class="p">,</span><span class="mf">0.</span><span class="p">,</span><span class="mf">1.</span><span class="p">,</span><span class="mf">0.</span><span class="p">],</span>\
            <span class="p">[</span><span class="n">yref</span><span class="p">,</span><span class="o">-</span><span class="n">xref</span><span class="p">,</span><span class="mf">0.</span><span class="p">,</span><span class="mf">0.</span><span class="p">,</span><span class="mf">0.</span><span class="p">,</span><span class="mf">1.</span><span class="p">]])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">F</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">inv</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">T1</span><span class="p">),</span><span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">F_raw</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">T2</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">K</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">inv</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">T2</span><span class="p">),</span><span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">K_raw</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">T1</span><span class="p">))</span>
        <span class="c"># Reset all element cross-section matricies to free up memory</span>
        <span class="k">for</span> <span class="n">EID</span><span class="p">,</span> <span class="n">elem</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">elemDict</span><span class="o">.</span><span class="n">iteritems</span><span class="p">():</span>
            <span class="c">#elem.clearXSectionMatricies()</span>
            <span class="c"># Initialize Guass points for integration</span>
            <span class="n">etas</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">/</span><span class="mi">3</span>
            <span class="n">xis</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">/</span><span class="mi">3</span>
            <span class="c"># Calculate the second mass moments of inertia about the reference</span>
            <span class="c"># axis</span>
            <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">size</span><span class="p">(</span><span class="n">xis</span><span class="p">)):</span>
                <span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">size</span><span class="p">(</span><span class="n">etas</span><span class="p">)):</span>
                    <span class="n">Jmat</span> <span class="o">=</span> <span class="n">elem</span><span class="o">.</span><span class="n">J</span><span class="p">(</span><span class="n">etas</span><span class="p">[</span><span class="n">l</span><span class="p">],</span><span class="n">xis</span><span class="p">[</span><span class="n">k</span><span class="p">])</span>
                    <span class="n">Jdet</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">det</span><span class="p">(</span><span class="n">Jmat</span><span class="p">))</span>
                    <span class="c"># Add to the cross-section second mass moments of inertia</span>
                    <span class="n">Ixx</span><span class="o">+=</span><span class="n">elem</span><span class="o">.</span><span class="n">rho</span><span class="o">*</span><span class="n">Jdet</span><span class="o">*</span><span class="p">(</span><span class="n">elem</span><span class="o">.</span><span class="n">y</span><span class="p">(</span><span class="n">etas</span><span class="p">[</span><span class="n">l</span><span class="p">],</span><span class="n">xis</span><span class="p">[</span><span class="n">k</span><span class="p">])</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">refAxis</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span>
                    <span class="n">Iyy</span><span class="o">+=</span><span class="n">elem</span><span class="o">.</span><span class="n">rho</span><span class="o">*</span><span class="n">Jdet</span><span class="o">*</span><span class="p">(</span><span class="n">elem</span><span class="o">.</span><span class="n">x</span><span class="p">(</span><span class="n">etas</span><span class="p">[</span><span class="n">l</span><span class="p">],</span><span class="n">xis</span><span class="p">[</span><span class="n">k</span><span class="p">])</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">refAxis</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span>
                    <span class="n">Ixy</span><span class="o">+=</span><span class="n">elem</span><span class="o">.</span><span class="n">rho</span><span class="o">*</span><span class="n">Jdet</span><span class="o">*</span><span class="p">(</span><span class="n">elem</span><span class="o">.</span><span class="n">y</span><span class="p">(</span><span class="n">etas</span><span class="p">[</span><span class="n">l</span><span class="p">],</span><span class="n">xis</span><span class="p">[</span><span class="n">k</span><span class="p">])</span><span class="o">-</span>\
                        <span class="bp">self</span><span class="o">.</span><span class="n">refAxis</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">*</span><span class="p">(</span><span class="n">elem</span><span class="o">.</span><span class="n">x</span><span class="p">(</span><span class="n">etas</span><span class="p">[</span><span class="n">l</span><span class="p">],</span><span class="n">xis</span><span class="p">[</span><span class="n">k</span><span class="p">])</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">refAxis</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="c"># Assemble cross-section mass matrix</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">M</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="n">m</span><span class="p">,</span><span class="mf">0.</span><span class="p">,</span><span class="mf">0.</span><span class="p">,</span><span class="mf">0.</span><span class="p">,</span><span class="mf">0.</span><span class="p">,</span><span class="o">-</span><span class="n">m</span><span class="o">*</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">x_m</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">refAxis</span><span class="p">[</span><span class="mi">1</span><span class="p">])],</span>\
                           <span class="p">[</span><span class="mf">0.</span><span class="p">,</span><span class="n">m</span><span class="p">,</span><span class="mf">0.</span><span class="p">,</span><span class="mf">0.</span><span class="p">,</span><span class="mf">0.</span><span class="p">,</span><span class="n">m</span><span class="o">*</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">x_m</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">refAxis</span><span class="p">[</span><span class="mi">0</span><span class="p">])],</span>\
                           <span class="p">[</span><span class="mf">0.</span><span class="p">,</span><span class="mf">0.</span><span class="p">,</span><span class="n">m</span><span class="p">,</span><span class="n">m</span><span class="o">*</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">x_m</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">refAxis</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span><span class="o">-</span><span class="n">m</span><span class="o">*</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">x_m</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">refAxis</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span><span class="mf">0.</span><span class="p">],</span>\
                           <span class="p">[</span><span class="mf">0.</span><span class="p">,</span><span class="mf">0.</span><span class="p">,</span><span class="n">m</span><span class="o">*</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">x_m</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">refAxis</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span><span class="n">Ixx</span><span class="p">,</span><span class="o">-</span><span class="n">Ixy</span><span class="p">,</span><span class="mf">0.</span><span class="p">],</span>\
                           <span class="p">[</span><span class="mf">0.</span><span class="p">,</span><span class="mf">0.</span><span class="p">,</span><span class="o">-</span><span class="n">m</span><span class="o">*</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">x_m</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">refAxis</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span><span class="o">-</span><span class="n">Ixy</span><span class="p">,</span><span class="n">Iyy</span><span class="p">,</span><span class="mf">0.</span><span class="p">],</span>\
                           <span class="p">[</span><span class="o">-</span><span class="n">m</span><span class="o">*</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">x_m</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">refAxis</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span><span class="n">m</span><span class="o">*</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">x_m</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">refAxis</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span><span class="mf">0.</span><span class="p">,</span><span class="mf">0.</span><span class="p">,</span><span class="mf">0.</span><span class="p">,</span><span class="n">Ixx</span><span class="o">+</span><span class="n">Iyy</span><span class="p">]])</span></div>
<div class="viewcode-block" id="XSect.resetResults"><a class="viewcode-back" href="../../structures.html#AeroComBAT.Structures.XSect.resetResults">[docs]</a>    <span class="k">def</span> <span class="nf">resetResults</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Resets displacements, stress and strains within an xsect</span>
<span class="sd">        </span>
<span class="sd">        This method clears all results (both warping, stress, and strain)</span>
<span class="sd">        within the elements in the xsect object.</span>
<span class="sd">        </span>
<span class="sd">        :Args:</span>
<span class="sd">        </span>
<span class="sd">        - None</span>
<span class="sd">            </span>
<span class="sd">        :Returns:</span>
<span class="sd">        </span>
<span class="sd">        - None</span>
<span class="sd">            </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c"># For all elements within the cross-section</span>
        <span class="k">for</span> <span class="n">EID</span><span class="p">,</span> <span class="n">elem</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">elemDict</span><span class="o">.</span><span class="n">iteritems</span><span class="p">():</span>
            <span class="c"># Clear the results</span>
            <span class="n">elem</span><span class="o">.</span><span class="n">resetResults</span><span class="p">()</span></div>
<div class="viewcode-block" id="XSect.calcWarpEffects"><a class="viewcode-back" href="../../structures.html#AeroComBAT.Structures.XSect.calcWarpEffects">[docs]</a>    <span class="k">def</span> <span class="nf">calcWarpEffects</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Calculates displacements, stresses, and strains for applied forces</span>
<span class="sd">        </span>
<span class="sd">        The second most powerful method of the XSect class. After an analysis</span>
<span class="sd">        is run, the FEM class stores force and moment resultants within the</span>
<span class="sd">        beam element objects. From there, warping displacement, strain and</span>
<span class="sd">        stress can be determined within the cross-section at any given location</span>
<span class="sd">        within the beam using this method. This method will take a while though</span>
<span class="sd">        as it has to calculate 4 displacements and 24 stresses and strains for</span>
<span class="sd">        every element within the cross-section. Keep that in mind when you are</span>
<span class="sd">        surveying your beam or wing for displacements, stresses and strains.</span>
<span class="sd">        </span>
<span class="sd">        :Args:</span>
<span class="sd">        </span>
<span class="sd">        - `force (6x1 np.array[float])`: This is the internal force and moment</span>
<span class="sd">            resultant experienced by the cross-section.</span>
<span class="sd">            </span>
<span class="sd">        :Returns:</span>
<span class="sd">        </span>
<span class="sd">        - None</span>
<span class="sd">            </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c"># Initialize the applied force</span>
        <span class="n">frc</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s">&#39;force&#39;</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">6</span><span class="p">,</span><span class="mi">1</span><span class="p">)))</span>
        <span class="n">frc</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">frc</span><span class="p">,(</span><span class="mi">6</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span>
        <span class="c"># Calculate the force applied at the origin of the cross-section</span>
        <span class="n">th</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">inv</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">T2</span><span class="p">),</span><span class="n">frc</span><span class="p">)</span>
        <span class="c"># Generate nodal warping displacements</span>
        <span class="n">u</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">X</span><span class="p">,</span><span class="n">th</span><span class="p">)</span>
        <span class="c"># Generate section strains</span>
        <span class="n">strn0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Y</span><span class="p">,</span><span class="n">th</span><span class="p">)</span>
        <span class="c"># Generate gradient of warping</span>
        <span class="n">dudz</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dXdz</span><span class="p">,</span><span class="n">th</span><span class="p">)</span>
        <span class="c"># For each element in the cross-section:</span>
        <span class="k">for</span> <span class="n">EID</span><span class="p">,</span> <span class="n">elem</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">elemDict</span><span class="o">.</span><span class="n">iteritems</span><span class="p">():</span>
            <span class="c"># Initialize the element warping vector for strain calc</span>
            <span class="n">uelem</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">12</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span>
            <span class="c"># Initialize the element warping grad vector for strain calc</span>
            <span class="n">dudzelem</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">12</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span>
            <span class="c"># For all nodes in the element</span>
            <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">4</span><span class="p">):</span>
                <span class="n">tmpNID</span> <span class="o">=</span> <span class="n">elem</span><span class="o">.</span><span class="n">NIDs</span><span class="p">[</span><span class="n">j</span><span class="p">]</span>
                <span class="c"># Save warping displacement</span>
                <span class="n">uelem</span><span class="p">[</span><span class="mi">3</span><span class="o">*</span><span class="n">j</span><span class="p">:</span><span class="mi">3</span><span class="o">*</span><span class="n">j</span><span class="o">+</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="n">u</span><span class="p">[</span><span class="mi">3</span><span class="o">*</span><span class="n">tmpNID</span><span class="p">:</span><span class="mi">3</span><span class="o">*</span><span class="n">tmpNID</span><span class="o">+</span><span class="mi">3</span><span class="p">]</span>
                <span class="c"># Save warping gradient</span>
                <span class="n">dudzelem</span><span class="p">[</span><span class="mi">3</span><span class="o">*</span><span class="n">j</span><span class="p">:</span><span class="mi">3</span><span class="o">*</span><span class="n">j</span><span class="o">+</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="n">dudz</span><span class="p">[</span><span class="mi">3</span><span class="o">*</span><span class="n">tmpNID</span><span class="p">:</span><span class="mi">3</span><span class="o">*</span><span class="n">tmpNID</span><span class="o">+</span><span class="mi">3</span><span class="p">]</span>
            <span class="c"># Initialize strain vectors</span>
            <span class="n">tmpEps</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">6</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span>
            <span class="c"># Initialize stress vectors</span>
            <span class="n">tmpSig</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">6</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span>
            <span class="c"># Initialize Xis (strain sampling points)</span>
            <span class="n">xis</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span><span class="c">#*np.sqrt(3.)/3.</span>
            <span class="c"># Initialize Etas (strain sampling points)</span>
            <span class="n">etas</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span><span class="c">#*np.sqrt(3.)/3.</span>
            <span class="c"># Calculate Strain</span>
            <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">4</span><span class="p">):</span>
                <span class="c"># Initialize S:</span>
                <span class="n">S</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">6</span><span class="p">,</span><span class="mi">3</span><span class="p">));</span><span class="n">S</span><span class="p">[</span><span class="mi">3</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span><span class="n">S</span><span class="p">[</span><span class="mi">4</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span><span class="n">S</span><span class="p">[</span><span class="mi">5</span><span class="p">,</span><span class="mi">2</span><span class="p">]</span><span class="o">=</span><span class="mi">1</span>
                <span class="c"># Calculate Z at the corner:</span>
                <span class="n">Z</span> <span class="o">=</span> <span class="n">elem</span><span class="o">.</span><span class="n">Z</span><span class="p">(</span><span class="n">etas</span><span class="p">[</span><span class="n">j</span><span class="p">],</span><span class="n">xis</span><span class="p">[</span><span class="n">j</span><span class="p">])</span>
                <span class="c"># Calculate the Jacobian at the element corner:</span>
                <span class="n">tmpJ</span> <span class="o">=</span> <span class="n">elem</span><span class="o">.</span><span class="n">J</span><span class="p">(</span><span class="n">etas</span><span class="p">[</span><span class="n">j</span><span class="p">],</span><span class="n">xis</span><span class="p">[</span><span class="n">j</span><span class="p">])</span>
                <span class="c"># Calculate the inverse of the Jacobian</span>
                <span class="n">Jmatinv</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">inv</span><span class="p">(</span><span class="n">tmpJ</span><span class="p">)</span>
                <span class="c"># Initialize part of the strain displacement matrix</span>
                <span class="n">Bxi</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">6</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span>
                <span class="n">Bxi</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">Bxi</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">Bxi</span><span class="p">[</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">Jmatinv</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span>
                <span class="n">Bxi</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">Bxi</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">Bxi</span><span class="p">[</span><span class="mi">4</span><span class="p">,</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">Jmatinv</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span>
                <span class="c"># Initialize part of the strain displacement matrix</span>
                <span class="n">Beta</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">6</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span>
                <span class="n">Beta</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">Beta</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">Beta</span><span class="p">[</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">Jmatinv</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span>
                <span class="n">Beta</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">Beta</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">Beta</span><span class="p">[</span><span class="mi">4</span><span class="p">,</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">Jmatinv</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span>
                <span class="c"># Assemble the full strain displacement matrix</span>
                <span class="n">BN</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">Bxi</span><span class="p">,</span><span class="n">elem</span><span class="o">.</span><span class="n">dNdxi</span><span class="p">(</span><span class="n">etas</span><span class="p">[</span><span class="n">j</span><span class="p">]))</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">Beta</span><span class="p">,</span><span class="n">elem</span><span class="o">.</span><span class="n">dNdeta</span><span class="p">(</span><span class="n">xis</span><span class="p">[</span><span class="n">j</span><span class="p">]))</span>
                <span class="c"># Initialize shape function displacement matrix</span>
                <span class="n">N</span> <span class="o">=</span> <span class="n">elem</span><span class="o">.</span><span class="n">N</span><span class="p">(</span><span class="n">etas</span><span class="p">[</span><span class="n">j</span><span class="p">],</span><span class="n">xis</span><span class="p">[</span><span class="n">j</span><span class="p">])</span>
                <span class="c"># Calculate the 3D strain state</span>
                <span class="n">tmpEps</span><span class="p">[:,</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">S</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">Z</span><span class="p">,</span><span class="n">strn0</span><span class="p">))</span><span class="o">+</span>\
                    <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">BN</span><span class="p">,</span><span class="n">uelem</span><span class="p">)</span><span class="o">+</span>\
                    <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">S</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="n">dudzelem</span><span class="p">)))</span>
                <span class="c"># Calculate the 3D stress state in the cross-section CSYS</span>
                <span class="n">tmpSig</span><span class="p">[:,</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">elem</span><span class="o">.</span><span class="n">Q</span><span class="p">,</span><span class="n">tmpEps</span><span class="p">[:,</span><span class="n">j</span><span class="p">])</span>
            <span class="c"># Save the displacement vector of the element nodes</span>
            <span class="n">elem</span><span class="o">.</span><span class="n">U</span> <span class="o">=</span> <span class="n">uelem</span>
            <span class="c"># Save the strain states at all 4 corners for the element</span>
            <span class="n">elem</span><span class="o">.</span><span class="n">Eps</span> <span class="o">=</span> <span class="n">tmpEps</span>
            <span class="c"># Save the stress states at all 4 corners for the element</span>
            <span class="n">elem</span><span class="o">.</span><span class="n">Sig</span> <span class="o">=</span> <span class="n">tmpSig</span>    
            <span class="c"># Save the forces applied to the beam nodes</span>
                        </div>
    <span class="k">def</span> <span class="nf">plotXSect</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Plots an XSect object.</span>
<span class="sd">        </span>
<span class="sd">        Intended primarily as a private method for new cross-section mesh</span>
<span class="sd">        debugging but left public, this method will plot all of the laminate</span>
<span class="sd">        meshes within the cross-section.</span>
<span class="sd">        </span>
<span class="sd">        :Args:</span>
<span class="sd">        </span>
<span class="sd">        - `figName (str)`: The name of the figure.</span>
<span class="sd">            </span>
<span class="sd">        :Returns:</span>
<span class="sd">        </span>
<span class="sd">        - `(fig)`: Will plot a mayavi figure</span>
<span class="sd">            </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">figName</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s">&#39;figName&#39;</span><span class="p">,</span><span class="s">&#39;Figure&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">()</span><span class="o">*</span><span class="mi">100</span><span class="p">)))</span>
        <span class="n">mlab</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figure</span><span class="o">=</span><span class="n">figName</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">laminate</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">laminates</span><span class="p">:</span>
            <span class="n">laminate</span><span class="o">.</span><span class="n">plotLaminate</span><span class="p">(</span><span class="n">figName</span><span class="o">=</span><span class="n">figName</span><span class="p">)</span>
<div class="viewcode-block" id="XSect.printSummary"><a class="viewcode-back" href="../../structures.html#AeroComBAT.Structures.XSect.printSummary">[docs]</a>    <span class="k">def</span> <span class="nf">printSummary</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">refAxis</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span><span class="n">decimals</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Print characterisic information about the cross-section.</span>
<span class="sd">        </span>
<span class="sd">        This method prints out characteristic information about the cross-</span>
<span class="sd">        section objects. By default, the method will print out the location of</span>
<span class="sd">        the reference axis, the shear, tension, and mass center. This method</span>
<span class="sd">        if requested will also print the stiffness and mass matricies.</span>
<span class="sd">        </span>
<span class="sd">        :Args:</span>
<span class="sd">        </span>
<span class="sd">        - `refAxis (bool)`: Boolean to determine if the stiffness matrix</span>
<span class="sd">            printed should be about the reference axis (True) or about the</span>
<span class="sd">            local xsect origin (False).</span>
<span class="sd">        - `stiffMat (bool)`: Boolean to determine if the stiffness matrix</span>
<span class="sd">            should be printed.</span>
<span class="sd">        - `tensCntr (bool)`: Boolean to determine if the location of the tension</span>
<span class="sd">            center should be printed.</span>
<span class="sd">        - `shearCntr (bool)`: Boolean to determine if the location of the shear</span>
<span class="sd">            center should be printed.</span>
<span class="sd">        - `massCntr (bool)`: Boolean to determine if the location of the mass</span>
<span class="sd">            center should be printed.</span>
<span class="sd">        - `refAxisLoc (bool)`: Boolean to determine if the location of the</span>
<span class="sd">            reference axis should be printed.</span>
<span class="sd">        </span>
<span class="sd">        :Returns:</span>
<span class="sd">        </span>
<span class="sd">        - `(str)`: Prints out a string of information about the cross-section.</span>
<span class="sd">        </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c"># Print xsect info:</span>
        <span class="k">print</span><span class="p">(</span><span class="s">&#39;XSect: </span><span class="si">%d</span><span class="s">&#39;</span> <span class="o">%</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">XID</span><span class="p">))</span>
        <span class="k">print</span><span class="p">(</span><span class="s">&#39;Type of cross-section is: &#39;</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">typeXSect</span><span class="p">)</span>
        <span class="k">print</span><span class="p">(</span><span class="s">&#39;The OML selected is: &#39;</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">airfoil</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
        <span class="c"># Print the 6x6 stiffnes matrix?</span>
        <span class="n">stiffMat</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s">&#39;stiffMat&#39;</span><span class="p">,</span><span class="bp">False</span><span class="p">)</span>
        <span class="c"># Print tension center?</span>
        <span class="n">tensCntr</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s">&#39;tensCntr&#39;</span><span class="p">,</span><span class="bp">True</span><span class="p">)</span>
        <span class="c"># Print shear center?</span>
        <span class="n">shearCntr</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s">&#39;shearCntr&#39;</span><span class="p">,</span><span class="bp">True</span><span class="p">)</span>
        <span class="c"># Print mass matrix?</span>
        <span class="n">massMat</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s">&#39;massMat&#39;</span><span class="p">,</span><span class="bp">False</span><span class="p">)</span>
        <span class="c"># Print mass center?</span>
        <span class="n">massCntr</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s">&#39;massCntr&#39;</span><span class="p">,</span><span class="bp">True</span><span class="p">)</span>
        <span class="c"># Print reference axis?</span>
        <span class="n">refAxisLoc</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s">&#39;refAxis&#39;</span><span class="p">,</span><span class="bp">True</span><span class="p">)</span>
        
        <span class="k">if</span> <span class="n">refAxisLoc</span><span class="p">:</span>
            <span class="k">print</span><span class="p">(</span><span class="s">&#39;The x-coordinate of the reference axis is: </span><span class="si">%4.6f</span><span class="s">&#39;</span> <span class="o">%</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">refAxis</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
            <span class="k">print</span><span class="p">(</span><span class="s">&#39;The y-coordinate of the reference axis is: </span><span class="si">%4.6f</span><span class="s">&#39;</span> <span class="o">%</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">refAxis</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
        <span class="k">if</span> <span class="n">massCntr</span><span class="p">:</span>
            <span class="k">print</span><span class="p">(</span><span class="s">&#39;The x-coordinate of the mass center is: </span><span class="si">%4.6f</span><span class="s">&#39;</span> <span class="o">%</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">x_m</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
            <span class="k">print</span><span class="p">(</span><span class="s">&#39;The y-coordinate of the mass center is: </span><span class="si">%4.6f</span><span class="s">&#39;</span> <span class="o">%</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">x_m</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
        <span class="k">if</span> <span class="n">shearCntr</span><span class="p">:</span>
            <span class="k">print</span><span class="p">(</span><span class="s">&#39;The x-coordinate of the shear center is: </span><span class="si">%4.6f</span><span class="s">&#39;</span> <span class="o">%</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">xs</span><span class="p">))</span>
            <span class="k">print</span><span class="p">(</span><span class="s">&#39;The y-coordinate of the shear center is: </span><span class="si">%4.6f</span><span class="s">&#39;</span> <span class="o">%</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ys</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">tensCntr</span><span class="p">:</span>
            <span class="k">print</span><span class="p">(</span><span class="s">&#39;The x-coordinate of the tension center is: </span><span class="si">%4.6f</span><span class="s">&#39;</span> <span class="o">%</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">xt</span><span class="p">))</span>
            <span class="k">print</span><span class="p">(</span><span class="s">&#39;The y-coordinate of the tension center is: </span><span class="si">%4.6f</span><span class="s">&#39;</span> <span class="o">%</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">yt</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">stiffMat</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">refAxis</span><span class="p">:</span>
                <span class="k">print</span><span class="p">(</span><span class="s">&#39;</span><span class="se">\n\n</span><span class="s">The cross-section stiffness matrix about the reference axis is:&#39;</span><span class="p">)</span>
                <span class="k">print</span><span class="p">(</span><span class="n">tabulate</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">around</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">K</span><span class="p">,</span><span class="n">decimals</span><span class="o">=</span><span class="n">decimals</span><span class="p">),</span><span class="n">tablefmt</span><span class="o">=</span><span class="s">&quot;fancy_grid&quot;</span><span class="p">))</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">print</span><span class="p">(</span><span class="s">&#39;</span><span class="se">\n\n</span><span class="s">The cross-section stiffness matrix about the xsect origin is:&#39;</span><span class="p">)</span>
                <span class="k">print</span><span class="p">(</span><span class="n">tabulate</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">around</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">K_raw</span><span class="p">,</span><span class="n">decimals</span><span class="o">=</span><span class="n">decimals</span><span class="p">),</span><span class="n">tablefmt</span><span class="o">=</span><span class="s">&quot;fancy_grid&quot;</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">massMat</span><span class="p">:</span>
            <span class="k">print</span><span class="p">(</span><span class="s">&#39;</span><span class="se">\n\n</span><span class="s">The cross-section mass matrix about the reference axis is:&#39;</span><span class="p">)</span>
            <span class="k">print</span><span class="p">(</span><span class="n">tabulate</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">around</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">M</span><span class="p">,</span><span class="n">decimals</span><span class="o">=</span><span class="n">decimals</span><span class="p">),</span><span class="n">tablefmt</span><span class="o">=</span><span class="s">&quot;fancy_grid&quot;</span><span class="p">))</span></div>
<div class="viewcode-block" id="XSect.plotRigid"><a class="viewcode-back" href="../../structures.html#AeroComBAT.Structures.XSect.plotRigid">[docs]</a>    <span class="k">def</span> <span class="nf">plotRigid</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Plots the rigid cross-section along a beam.</span>
<span class="sd">        </span>
<span class="sd">        This method is very useful for visually debugging a structural model.</span>
<span class="sd">        It will plot out the rigid cross-section in 3D space with regards to</span>
<span class="sd">        the reference axis.</span>
<span class="sd">        </span>
<span class="sd">        :Args:</span>
<span class="sd">        </span>
<span class="sd">        - `x (1x3 np.array[float])`: The rigid location on your beam you are</span>
<span class="sd">            trying to plot:</span>
<span class="sd">        - `beam_axis (1x3 np.array[float])`: The vector pointing in the</span>
<span class="sd">            direction of your beam axis.</span>
<span class="sd">        - `figName (str)`: The name of the figure.</span>
<span class="sd">        - `wireMesh (bool)`: A boolean to determine of the wiremesh outline</span>
<span class="sd">            should be plotted.*</span>
<span class="sd">            </span>
<span class="sd">        :Returns:</span>
<span class="sd">        </span>
<span class="sd">        - `(fig)`: Plots the cross-section in a mayavi figure.</span>
<span class="sd">            </span>
<span class="sd">        .. Note:: Because of how the mayavi wireframe keyword works, it will</span>
<span class="sd">        apear as though the cross-section is made of triangles as opposed to</span>
<span class="sd">        quadrilateras. Fear not! They are made of quads, the wireframe is just</span>
<span class="sd">        plotted as triangles.</span>
<span class="sd">        </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c"># The rigid translation of the cross-section</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s">&#39;x&#39;</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.</span><span class="p">,</span><span class="mf">0.</span><span class="p">,</span><span class="mf">0.</span><span class="p">]))</span>
        <span class="c"># The rotation matrix mapping the cross-section from the local frame to</span>
        <span class="c"># the global frame</span>
        <span class="n">RotMat</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s">&#39;RotMat&#39;</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mf">1.</span><span class="p">,</span><span class="mf">0.</span><span class="p">,</span><span class="mf">0.</span><span class="p">],[</span><span class="mf">0.</span><span class="p">,</span><span class="mf">1.</span><span class="p">,</span><span class="mf">0.</span><span class="p">],[</span><span class="mf">0.</span><span class="p">,</span><span class="mf">0.</span><span class="p">,</span><span class="mf">1.</span><span class="p">]]))</span>
        <span class="c"># The figure name</span>
        <span class="n">figName</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s">&#39;figName&#39;</span><span class="p">,</span><span class="s">&#39;Figure&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">()</span><span class="o">*</span><span class="mi">100</span><span class="p">)))</span>
        <span class="c"># Whether the wiremesh should be plotted</span>
        <span class="n">wireMesh</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s">&#39;mesh&#39;</span><span class="p">,</span><span class="bp">True</span><span class="p">)</span>
        <span class="c"># Initialize which figure is being plotted on</span>
        <span class="n">mlab</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figure</span><span class="o">=</span><span class="n">figName</span><span class="p">)</span>
        <span class="c"># For all laminate objects in the cross-section</span>
        <span class="k">for</span> <span class="n">lam</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">laminates</span><span class="p">:</span>
            <span class="c"># Initialize xyz array&#39;s to be plotted</span>
            <span class="n">plotx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">lam</span><span class="o">.</span><span class="n">xmesh</span><span class="p">)</span>
            <span class="n">ploty</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">lam</span><span class="o">.</span><span class="n">ymesh</span><span class="p">)</span>
            <span class="n">plotz</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">lam</span><span class="o">.</span><span class="n">zmesh</span><span class="p">)</span>
            <span class="c"># Rotate all of the points within the arrays</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">size</span><span class="p">(</span><span class="n">lam</span><span class="o">.</span><span class="n">mesh</span><span class="p">,</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)):</span>
                <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">size</span><span class="p">(</span><span class="n">lam</span><span class="o">.</span><span class="n">mesh</span><span class="p">,</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)):</span>
                    <span class="n">tmpPos</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="n">plotx</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]],[</span><span class="n">ploty</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]],[</span><span class="n">plotz</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]]])</span>
                    <span class="n">newPos</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">RotMat</span><span class="p">,</span><span class="n">tmpPos</span><span class="p">)</span>
                    <span class="n">plotx</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">newPos</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                    <span class="n">ploty</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">newPos</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
                    <span class="n">plotz</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">newPos</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
            <span class="c"># Plot the three xyz arrays</span>
            <span class="n">mlab</span><span class="o">.</span><span class="n">mesh</span><span class="p">(</span><span class="n">plotx</span><span class="o">+</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">refAxis</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">ploty</span><span class="o">+</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">refAxis</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">plotz</span><span class="o">+</span><span class="n">x</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span><span class="n">color</span><span class="o">=</span><span class="nb">tuple</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">color</span><span class="p">))</span>
            <span class="c"># Plot the wireframe if desired.</span>
            <span class="k">if</span> <span class="n">wireMesh</span><span class="p">:</span>
                <span class="n">mlab</span><span class="o">.</span><span class="n">mesh</span><span class="p">(</span><span class="n">plotx</span><span class="o">+</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">refAxis</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">ploty</span><span class="o">+</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">refAxis</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">plotz</span><span class="o">+</span><span class="n">x</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span>\
                    <span class="n">representation</span><span class="o">=</span><span class="s">&#39;wireframe&#39;</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">))</span></div>
<div class="viewcode-block" id="XSect.plotWarped"><a class="viewcode-back" href="../../structures.html#AeroComBAT.Structures.XSect.plotWarped">[docs]</a>    <span class="k">def</span> <span class="nf">plotWarped</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Plots the warped cross-section along a beam.</span>
<span class="sd">        </span>
<span class="sd">        Once an analysis has been completed, this method can be utilized in</span>
<span class="sd">        order to plot the results anywhere along the beam.</span>
<span class="sd">        </span>
<span class="sd">        :Args:</span>
<span class="sd">        </span>
<span class="sd">        - `displScale (float)`: The scale by which all rotations and</span>
<span class="sd">            displacements will be mutliplied in order make it visually</span>
<span class="sd">            easier to detect displacements.</span>
<span class="sd">        - `x (1x3 np.array[float])`: The rigid location on your beam you are</span>
<span class="sd">            trying to plot:</span>
<span class="sd">        - `U (1x6 np.array[float])`: The rigid body displacements and rotations</span>
<span class="sd">            experienced by the cross-section.</span>
<span class="sd">        - `beam_axis (1x3 np.array[float])`: The vector pointing in the</span>
<span class="sd">            direction of your beam axis.</span>
<span class="sd">        - `contour (str)`: Determines what value is to be plotted during as a</span>
<span class="sd">            contour in the cross-section.</span>
<span class="sd">        - `figName (str)`: The name of the figure.</span>
<span class="sd">        - `wireMesh (bool)`: A boolean to determine of the wiremesh outline</span>
<span class="sd">            should be plotted.*</span>
<span class="sd">        - `contLim (1x2 array[float])`: Describes the upper and lower bounds of</span>
<span class="sd">            contour color scale.</span>
<span class="sd">        - `warpScale (float)`: The scaling factor by which all warping</span>
<span class="sd">            displacements in the cross-section will be multiplied.</span>
<span class="sd">            </span>
<span class="sd">        :Returns:</span>
<span class="sd">        </span>
<span class="sd">        - `(fig)`: Plots the cross-section in a mayavi figure.</span>
<span class="sd">            </span>
<span class="sd">        .. Note:: Because of how the mayavi wireframe keyword works, it will</span>
<span class="sd">        apear as though the cross-section is made of triangles as opposed to</span>
<span class="sd">        quadrilateras. Fear not! They are made of quads, the wireframe is just</span>
<span class="sd">        plotted as triangles.</span>
<span class="sd">        </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c"># INPUT ARGUMENT INITIALIZATION</span>
        <span class="c"># Select Displacement Scale</span>
        <span class="n">displScale</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s">&#39;displScale&#39;</span><span class="p">,</span><span class="mf">1.</span><span class="p">)</span>
        <span class="c"># The rigid translation of the cross-section</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s">&#39;x&#39;</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span>
        <span class="c"># The defomation (tranltation and rotation) of the beam node and cross-section</span>
        <span class="n">U</span> <span class="o">=</span> <span class="n">displScale</span><span class="o">*</span><span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s">&#39;U&#39;</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">6</span><span class="p">))</span>
        <span class="c"># The rotation matrix mapping the cross-section from the local frame to</span>
        <span class="c"># the global frame</span>
        <span class="n">RotMat</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s">&#39;RotMat&#39;</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mf">1.</span><span class="p">,</span><span class="mf">0.</span><span class="p">,</span><span class="mf">0.</span><span class="p">],[</span><span class="mf">0.</span><span class="p">,</span><span class="mf">1.</span><span class="p">,</span><span class="mf">0.</span><span class="p">],[</span><span class="mf">0.</span><span class="p">,</span><span class="mf">0.</span><span class="p">,</span><span class="mf">1.</span><span class="p">]]))</span>
        <span class="c"># The figure name</span>
        <span class="n">figName</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s">&#39;figName&#39;</span><span class="p">,</span><span class="s">&#39;Figure&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">()</span><span class="o">*</span><span class="mi">100</span><span class="p">)))</span>
        <span class="c"># Show a contour</span>
        <span class="n">contour</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s">&#39;contour&#39;</span><span class="p">,</span><span class="s">&#39;VonMis&#39;</span><span class="p">)</span>
        <span class="c"># Show wire mesh?</span>
        <span class="n">wireMesh</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s">&#39;mesh&#39;</span><span class="p">,</span><span class="bp">False</span><span class="p">)</span>
        <span class="c"># Stress Limits</span>
        <span class="n">contLim</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s">&#39;contLim&#39;</span><span class="p">,[])</span>
        <span class="c"># Establish the warping scaling factor</span>
        <span class="n">warpScale</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s">&#39;warpScale&#39;</span><span class="p">,</span><span class="mf">1.</span><span class="p">)</span>
        <span class="c"># Establish if the colorbar should be generated:</span>
        <span class="n">colorbar</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s">&#39;colorbar&#39;</span><span class="p">,</span><span class="bp">False</span><span class="p">)</span>
        <span class="n">plots</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s">&#39;plots&#39;</span><span class="p">,[])</span>
        <span class="c"># Initialize on what figure the cross-section is to be plotted</span>
        <span class="n">mlab</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figure</span><span class="o">=</span><span class="n">figName</span><span class="p">)</span>
        <span class="c"># Create a rotation helper</span>
        <span class="n">rh</span> <span class="o">=</span> <span class="n">RotationHelper</span><span class="p">()</span>
        <span class="c"># Rotate the rotations from the global frame to the local frame:</span>
        <span class="n">UlocalRot</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">RotMat</span><span class="o">.</span><span class="n">T</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">U</span><span class="p">[</span><span class="mi">3</span><span class="p">:</span><span class="mi">6</span><span class="p">],(</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">)))</span>
        <span class="c"># Calculate the rotation matrix about the local z axis</span>
        <span class="n">RotZ</span> <span class="o">=</span> <span class="n">rh</span><span class="o">.</span><span class="n">rotXYZ</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.</span><span class="p">,</span><span class="mf">0.</span><span class="p">,</span><span class="n">UlocalRot</span><span class="p">[</span><span class="mi">2</span><span class="p">]]),</span><span class="n">deg2rad</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
        <span class="c"># Calculate the rotation matrix about the local x-axis</span>
        <span class="n">RotX</span> <span class="o">=</span> <span class="n">rh</span><span class="o">.</span><span class="n">rotXYZ</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">UlocalRot</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="mf">0.</span><span class="p">,</span><span class="mf">0.</span><span class="p">]),</span><span class="n">deg2rad</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
        <span class="c"># Calculate the rotation matrix about the local y-axis</span>
        <span class="n">RotY</span> <span class="o">=</span> <span class="n">rh</span><span class="o">.</span><span class="n">rotXYZ</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.</span><span class="p">,</span><span class="n">UlocalRot</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="mf">0.</span><span class="p">]),</span><span class="n">deg2rad</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
        <span class="c"># Create local reference of the reference axis</span>
        <span class="n">refAxis</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">refAxis</span>
        <span class="c"># Create local reference to the shear center locations</span>
        <span class="n">xsc</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">xs</span>
        <span class="n">ysc</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ys</span>
        <span class="c"># Create local reference to the tension center locations</span>
        <span class="n">xtc</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">xt</span>
        <span class="n">ytc</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">yt</span>
        <span class="c"># Add the warping displacements to original xyz coordinates</span>
        <span class="k">for</span> <span class="n">lam</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">laminates</span><span class="p">:</span>
            <span class="n">eidArray</span> <span class="o">=</span> <span class="n">lam</span><span class="o">.</span><span class="n">EIDmesh</span>
            <span class="n">lamxsize</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">size</span><span class="p">(</span><span class="n">eidArray</span><span class="p">,</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
            <span class="n">lamysize</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">size</span><span class="p">(</span><span class="n">eidArray</span><span class="p">,</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
            <span class="c"># Initialize the x,y,z and contour array&#39;s to be plotted</span>
            <span class="n">plotx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">2</span><span class="o">*</span><span class="n">lamxsize</span><span class="p">,</span><span class="mi">2</span><span class="o">*</span><span class="n">lamysize</span><span class="p">))</span>
            <span class="n">ploty</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">2</span><span class="o">*</span><span class="n">lamxsize</span><span class="p">,</span><span class="mi">2</span><span class="o">*</span><span class="n">lamysize</span><span class="p">))</span>
            <span class="n">plotz</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">2</span><span class="o">*</span><span class="n">lamxsize</span><span class="p">,</span><span class="mi">2</span><span class="o">*</span><span class="n">lamysize</span><span class="p">))</span>
            <span class="n">plotc</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">2</span><span class="o">*</span><span class="n">lamxsize</span><span class="p">,</span><span class="mi">2</span><span class="o">*</span><span class="n">lamysize</span><span class="p">))</span>
            <span class="c"># For all elements in the laminate</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">lamxsize</span><span class="p">):</span>
                <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">lamysize</span><span class="p">):</span>
                    <span class="n">tmpEID</span> <span class="o">=</span> <span class="n">eidArray</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span>
                    <span class="n">elem</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">elemDict</span><span class="p">[</span><span class="n">tmpEID</span><span class="p">]</span>
                    <span class="n">xdef</span><span class="p">,</span><span class="n">ydef</span><span class="p">,</span><span class="n">zdef</span> <span class="o">=</span> <span class="n">elem</span><span class="o">.</span><span class="n">getDeformed</span><span class="p">(</span><span class="n">warpScale</span><span class="o">=</span><span class="n">warpScale</span><span class="p">)</span>
                    <span class="n">plotx</span><span class="p">[</span><span class="mi">2</span><span class="o">*</span><span class="n">i</span><span class="p">:</span><span class="mi">2</span><span class="o">*</span><span class="n">i</span><span class="o">+</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="o">*</span><span class="n">j</span><span class="p">:</span><span class="mi">2</span><span class="o">*</span><span class="n">j</span><span class="o">+</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">xdef</span>
                    <span class="n">ploty</span><span class="p">[</span><span class="mi">2</span><span class="o">*</span><span class="n">i</span><span class="p">:</span><span class="mi">2</span><span class="o">*</span><span class="n">i</span><span class="o">+</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="o">*</span><span class="n">j</span><span class="p">:</span><span class="mi">2</span><span class="o">*</span><span class="n">j</span><span class="o">+</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">ydef</span>
                    <span class="n">plotz</span><span class="p">[</span><span class="mi">2</span><span class="o">*</span><span class="n">i</span><span class="p">:</span><span class="mi">2</span><span class="o">*</span><span class="n">i</span><span class="o">+</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="o">*</span><span class="n">j</span><span class="p">:</span><span class="mi">2</span><span class="o">*</span><span class="n">j</span><span class="o">+</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">zdef</span>
                    <span class="n">plotc</span><span class="p">[</span><span class="mi">2</span><span class="o">*</span><span class="n">i</span><span class="p">:</span><span class="mi">2</span><span class="o">*</span><span class="n">i</span><span class="o">+</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="o">*</span><span class="n">j</span><span class="p">:</span><span class="mi">2</span><span class="o">*</span><span class="n">j</span><span class="o">+</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">elem</span><span class="o">.</span><span class="n">getStressState</span><span class="p">(</span><span class="n">crit</span><span class="o">=</span><span class="n">contour</span><span class="p">)</span>
            <span class="c"># Translate the cross-section points to the shear center</span>
            <span class="c">#plotx = plotx-xsc</span>
            <span class="c">#ploty = ploty-ysc</span>
            <span class="c"># Conduct torsion rotation about the shear center</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">size</span><span class="p">(</span><span class="n">plotx</span><span class="p">,</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)):</span>
                <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">size</span><span class="p">(</span><span class="n">plotx</span><span class="p">,</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)):</span>
                    <span class="c"># Establish the temporary position vector and translate to</span>
                    <span class="c"># shear center</span>
                    <span class="n">tmpPos</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="n">plotx</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span><span class="o">-</span><span class="n">xsc</span><span class="p">],[</span><span class="n">ploty</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span><span class="o">-</span><span class="n">ysc</span><span class="p">],[</span><span class="n">plotz</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]]])</span>
                    <span class="c"># Apply torsion rotation and translate to tension center</span>
                    <span class="n">tmpPos</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">RotZ</span><span class="p">,</span><span class="n">tmpPos</span><span class="p">)</span><span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="n">xtc</span><span class="o">-</span><span class="n">xsc</span><span class="p">],[</span><span class="n">ytc</span><span class="o">-</span><span class="n">ysc</span><span class="p">],[</span><span class="mf">0.</span><span class="p">]])</span>
                    <span class="c"># Apply moment rotations and translate to reference axis</span>
                    <span class="n">tmpPos</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">RotY</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">RotX</span><span class="p">,</span><span class="n">tmpPos</span><span class="p">))</span>\
                        <span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="n">refAxis</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">-</span><span class="n">xtc</span><span class="p">],[</span><span class="n">refAxis</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">ytc</span><span class="p">],[</span><span class="mf">0.</span><span class="p">]])</span>
                    <span class="c"># Apply rotation to global frame</span>
                    <span class="n">newPos</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">RotMat</span><span class="p">,</span><span class="n">tmpPos</span><span class="p">)</span>
                    <span class="c"># Add rotated points back</span>
                    <span class="n">plotx</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">newPos</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                    <span class="n">ploty</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">newPos</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
                    <span class="n">plotz</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">newPos</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
            <span class="c"># Plot the laminate surface</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">contour</span><span class="p">,</span><span class="nb">str</span><span class="p">):</span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">contLim</span><span class="p">)</span><span class="o">==</span><span class="mi">0</span><span class="p">:</span>
                    <span class="n">surf</span> <span class="o">=</span> <span class="n">mlab</span><span class="o">.</span><span class="n">mesh</span><span class="p">(</span><span class="n">plotx</span><span class="o">+</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="n">U</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">ploty</span><span class="o">+</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="n">U</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">plotz</span><span class="o">+</span><span class="n">x</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">+</span><span class="n">U</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span>\
                        <span class="n">scalars</span><span class="o">=</span><span class="n">plotc</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">surf</span> <span class="o">=</span> <span class="n">mlab</span><span class="o">.</span><span class="n">mesh</span><span class="p">(</span><span class="n">plotx</span><span class="o">+</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="n">U</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">ploty</span><span class="o">+</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="n">U</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">plotz</span><span class="o">+</span><span class="n">x</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">+</span><span class="n">U</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span><span class="n">scalars</span><span class="o">=</span><span class="n">plotc</span><span class="p">,</span>\
                        <span class="n">vmin</span><span class="o">=</span><span class="n">contLim</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">vmax</span><span class="o">=</span><span class="n">contLim</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
                <span class="k">if</span> <span class="n">colorbar</span><span class="p">:</span>
                    <span class="n">mlab</span><span class="o">.</span><span class="n">colorbar</span><span class="p">()</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">surf</span> <span class="o">=</span> <span class="n">mlab</span><span class="o">.</span><span class="n">mesh</span><span class="p">(</span><span class="n">plotx</span><span class="o">+</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="n">U</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">ploty</span><span class="o">+</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="n">U</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">plotz</span><span class="o">+</span><span class="n">x</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">+</span><span class="n">U</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span><span class="n">color</span><span class="o">=</span><span class="nb">tuple</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">color</span><span class="p">))</span>
            <span class="k">if</span> <span class="n">wireMesh</span><span class="p">:</span>
                <span class="n">mesh</span> <span class="o">=</span> <span class="n">mlab</span><span class="o">.</span><span class="n">mesh</span><span class="p">(</span><span class="n">plotx</span><span class="o">+</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="n">U</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">ploty</span><span class="o">+</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="n">U</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">plotz</span><span class="o">+</span><span class="n">x</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">+</span><span class="n">U</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span>\
                    <span class="n">representation</span><span class="o">=</span><span class="s">&#39;wireframe&#39;</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="nb">tuple</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">color</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]))</span>
                <span class="n">plots</span> <span class="o">+=</span> <span class="p">[</span><span class="n">mesh</span><span class="p">]</span>
            <span class="n">plots</span> <span class="o">+=</span> <span class="p">[</span><span class="n">surf</span><span class="p">]</span></div></div>
<span class="k">class</span> <span class="nc">Beam</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;The parent class for all beams finite elements.</span>
<span class="sd">    </span>
<span class="sd">    This class exists primarily to cut down on code repetition for all beam</span>
<span class="sd">    finite element objects. Of the two beam finite element classes, only one is</span>
<span class="sd">    currently supported and validated (being the TBeam class).</span>
<span class="sd">    </span>
<span class="sd">    :Attributes:</span>
<span class="sd">    </span>
<span class="sd">    - `U1 (dict)`: This dictionary contains the results of an analysis set. The</span>
<span class="sd">        keys are the string names of the analysis and the values stored are</span>
<span class="sd">        6x1 np.array[float] vectors containing the 3 displacements and</span>
<span class="sd">        3 rotations at the first node.</span>
<span class="sd">    - `U2 (dict)`: This dictionary contains the results of an analysis set. The</span>
<span class="sd">        keys are the string names of the analysis and the values stored are</span>
<span class="sd">        6x1 np.array[float] vectors containing the 3 displacements and</span>
<span class="sd">        3 rotations at the second node.</span>
<span class="sd">    - `Umode1 (dict)`: This dictionary contains the results of a modal analysis</span>
<span class="sd">        set. The keys are the string names of the analysis and the values</span>
<span class="sd">        stored are 6xN np.array[float]. The columns of the array are the</span>
<span class="sd">        displacements and rotations at the first node associated with the</span>
<span class="sd">        particular mode.</span>
<span class="sd">    - `Umode2 (dict)`: This dictionary contains the results of a modal analysis</span>
<span class="sd">        set. The keys are the string names of the analysis and the values</span>
<span class="sd">        stored are 6xN np.array[float]. The columns of the array are the</span>
<span class="sd">        displacements and rotations at the second node associated with the</span>
<span class="sd">        particular mode.</span>
<span class="sd">    - `F1 (dict)`: This dictionary contains the results of an analysis set. The</span>
<span class="sd">        keys are the string names of the analysis and the values stored are</span>
<span class="sd">        6x1 np.array[float] vectors containing the 3 internal forces and</span>
<span class="sd">        3 moments at the first node.</span>
<span class="sd">    - `F2 (dict)`: This dictionary contains the results of an analysis set. The</span>
<span class="sd">        keys are the string names of the analysis and the values stored are</span>
<span class="sd">        6x1 np.array[float] vectors containing the 3 internal forces and</span>
<span class="sd">        3 moments at the second node.</span>
<span class="sd">    - `Fmode1 (dict)`: This dictionary contains the results of a modal analysis</span>
<span class="sd">        set. The keys are the string names of the analysis and the values</span>
<span class="sd">        stored are 6xN np.array[float]. The columns of the array are the</span>
<span class="sd">        forces and moments at the first node associated with the</span>
<span class="sd">        particular mode.*</span>
<span class="sd">    - `Fmode2 (dict)`: This dictionary contains the results of a modal analysis</span>
<span class="sd">        set. The keys are the string names of the analysis and the values</span>
<span class="sd">        stored are 6xN np.array[float]. The columns of the array are the</span>
<span class="sd">        forces and moments at the second node associated with the</span>
<span class="sd">        particular mode.*</span>
<span class="sd">    - `xsect (obj)`: The cross-section object used to determine the beams</span>
<span class="sd">        stiffnesses.</span>
<span class="sd">    - `EID (int)`: The element ID of the beam.</span>
<span class="sd">    - `SBID (int)`: The associated Superbeam ID the beam object belongs to.</span>
<span class="sd">    - `n1 (obj)`: The first nodal object used by the beam.</span>
<span class="sd">    - `n2 (obj)`: The second nodal object used by the beam.</span>
<span class="sd">    - `Fe (12x1 np.array[float])`: The distributed force vector of the element</span>
<span class="sd">    - `Ke (12x12 np.array[float])`: The stiffness matrix of the beam.</span>
<span class="sd">    - `Keg (12x12 np.array[float])`: The geometric stiffness matrix of the</span>
<span class="sd">        beam. Used for beam buckling calculations.</span>
<span class="sd">    - `Me (12x12 np.array[float])`: The mass matrix of the beam.</span>
<span class="sd">    - `analysis_names (array[str])`: An array containing all of the string</span>
<span class="sd">        names being used as keys in either U1,U2,F1,F2,Umode1,Umode2,Fmode1</span>
<span class="sd">        Fmode2</span>
<span class="sd">        </span>
<span class="sd">    :Methods:</span>
<span class="sd">    </span>
<span class="sd">    - `printSummary`: This method prints out characteristic attributes of the</span>
<span class="sd">        beam finite element.</span>
<span class="sd">        </span>
<span class="sd">    .. Note:: The force and moments in the Fmode1 and Fmode2 could be completely</span>
<span class="sd">        fictitious and be left as an artifact to fascilitate plotting of warped</span>
<span class="sd">        cross-sections. DO NOT rely on this information being meaningful.</span>
<span class="sd">        </span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c">#TODO: Add some kind of print results methods for both printing to command</span>
    <span class="c"># line and saving to a file.</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">xsect</span><span class="p">,</span><span class="n">EID</span><span class="p">,</span><span class="n">SBID</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Initializes a blank beam object.</span>
<span class="sd">        </span>
<span class="sd">        This method initializes attributes that are shared by all of the</span>
<span class="sd">        possible beam elements.</span>
<span class="sd">        </span>
<span class="sd">        :Args:</span>
<span class="sd">        </span>
<span class="sd">        - `xsect (obj)`: The cross-section object used by the beam.</span>
<span class="sd">        - `EID (int)`: The integer identifier of the beam element.</span>
<span class="sd">        - `SBID (int)`: The associated superbeam ID</span>
<span class="sd">            </span>
<span class="sd">        :Returns:</span>
<span class="sd">        </span>
<span class="sd">        - None</span>
<span class="sd">            </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c"># Nodal displacement dictionary</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">U1</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">U2</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="c"># Nodal displacements for eigenvalue solutions with multiple modes</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Umode1</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Umode2</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="c"># Nodal force and moment resultant dictionary</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">F1</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">F2</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="c"># Nodal force and moment resultant for eigenvalue solutions with</span>
        <span class="c"># multiple modes</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Fmode1</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Fmode2</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="c"># The beam&#39;s cross-section</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">xsect</span> <span class="o">=</span> <span class="n">xsect</span>
        <span class="c"># INITIALIZE ID&#39;s</span>
        <span class="c"># The element ID</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">EID</span> <span class="o">=</span> <span class="n">EID</span>
        <span class="c"># The xsect ID</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">XID</span> <span class="o">=</span> <span class="n">xsect</span><span class="o">.</span><span class="n">XID</span>
        <span class="c"># The beam super-element ID</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">SBID</span> <span class="o">=</span> <span class="n">SBID</span>
        <span class="c"># Initialize Stifness and force matricies/vectors</span>
        <span class="c"># Element force vector</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Fe</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">12</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Ke</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">12</span><span class="p">,</span><span class="mi">12</span><span class="p">),</span><span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Keg</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">12</span><span class="p">,</span><span class="mi">12</span><span class="p">),</span><span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Me</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">12</span><span class="p">,</span><span class="mi">12</span><span class="p">),</span><span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">T</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">12</span><span class="p">,</span><span class="mi">12</span><span class="p">),</span><span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
        <span class="c"># Initialize a dictionary to hold analysis names</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">analysis_names</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">def</span> <span class="nf">printSummary</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">decimals</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Prints out characteristic information about the beam element.</span>
<span class="sd">        </span>
<span class="sd">        This method by default prints out the EID, XID, SBID and the NIDs along</span>
<span class="sd">        with the nodes associated coordinates. Upon request, it can also print</span>
<span class="sd">        out the beam element stiffness, geometric stiffness, mass matricies and</span>
<span class="sd">        distributed force vector.</span>
<span class="sd">        </span>
<span class="sd">        :Args:</span>
<span class="sd">        </span>
<span class="sd">        - `nodeCoord (bool)`: A boolean to determine if the node coordinate</span>
<span class="sd">            information should also be printed.</span>
<span class="sd">        - `Ke (bool)`: A boolean to determine if the element stiffness matrix</span>
<span class="sd">            should be printed.</span>
<span class="sd">        - `Keg (bool)`: A boolean to determine if the element gemoetric</span>
<span class="sd">            stiffness matrix should be printed.</span>
<span class="sd">        - `Me (bool)`: A boolean to determine if the element mass matrix</span>
<span class="sd">            should be printed.</span>
<span class="sd">        - `Fe (bool)`: A boolean to determine if the element distributed force</span>
<span class="sd">            and moment vector should be printed.</span>
<span class="sd">            </span>
<span class="sd">        :Returns:</span>
<span class="sd">        </span>
<span class="sd">        - `(str)`: Printed summary of the requested attributes.</span>
<span class="sd">            </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c"># Print the element ID</span>
        <span class="k">print</span><span class="p">(</span><span class="s">&#39;Element: </span><span class="si">%d</span><span class="s">&#39;</span> <span class="o">%</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">EID</span><span class="p">))</span>
        <span class="c"># Print the associated xsect ID</span>
        <span class="n">XID</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s">&#39;XID&#39;</span><span class="p">,</span><span class="bp">False</span><span class="p">)</span>
        <span class="c"># Print the associated superbeam ID</span>
        <span class="n">SBID</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s">&#39;SBID&#39;</span><span class="p">,</span><span class="bp">False</span><span class="p">)</span>
        <span class="c"># Determine if node coordinates should also be printed</span>
        <span class="n">nodeCoord</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s">&#39;nodeCoord&#39;</span><span class="p">,</span><span class="bp">True</span><span class="p">)</span>
        <span class="c"># Print the stiffness matrix</span>
        <span class="n">Ke</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s">&#39;Ke&#39;</span><span class="p">,</span><span class="bp">False</span><span class="p">)</span>
        <span class="c"># Print the geometric stiffness matrix</span>
        <span class="n">Keg</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s">&#39;Keg&#39;</span><span class="p">,</span><span class="bp">False</span><span class="p">)</span>
        <span class="c"># Print the mass matrix</span>
        <span class="n">Me</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s">&#39;Me&#39;</span><span class="p">,</span><span class="bp">False</span><span class="p">)</span>
        <span class="c"># Print the distributed force vector</span>
        <span class="n">Fe</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s">&#39;Fe&#39;</span><span class="p">,</span><span class="bp">False</span><span class="p">)</span>
        
        <span class="k">if</span> <span class="n">XID</span><span class="p">:</span>
            <span class="k">print</span><span class="p">(</span><span class="s">&#39;Cross-section: </span><span class="si">%d</span><span class="s">&#39;</span> <span class="o">%</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">XID</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">SBID</span><span class="p">:</span>
            <span class="k">print</span><span class="p">(</span><span class="s">&#39;Superbeam: </span><span class="si">%d</span><span class="s">&#39;</span> <span class="o">%</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">SBID</span><span class="p">))</span>
        <span class="c"># Print the node information</span>
        <span class="k">if</span> <span class="n">nodeCoord</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">n1</span><span class="o">.</span><span class="n">printSummary</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">n2</span><span class="o">.</span><span class="n">printSummary</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">print</span><span class="p">(</span><span class="s">&#39;NID_1: </span><span class="si">%d</span><span class="s">&#39;</span> <span class="o">%</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n1</span><span class="o">.</span><span class="n">NID</span><span class="p">))</span>
            <span class="k">print</span><span class="p">(</span><span class="s">&#39;NID_2: </span><span class="si">%d</span><span class="s">&#39;</span> <span class="o">%</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n2</span><span class="o">.</span><span class="n">NID</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">Ke</span><span class="p">:</span>
            <span class="k">print</span><span class="p">(</span><span class="s">&#39;The beam element stiffness matrix is:&#39;</span><span class="p">)</span>
            <span class="k">print</span><span class="p">(</span><span class="n">tabulate</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">around</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Ke</span><span class="p">,</span><span class="n">decimals</span><span class="o">=</span><span class="n">decimals</span><span class="p">)))</span>
        <span class="k">if</span> <span class="n">Keg</span><span class="p">:</span>
            <span class="k">print</span><span class="p">(</span><span class="s">&#39;The beam element geometric stiffness matrix is:&#39;</span><span class="p">)</span>
            <span class="k">print</span><span class="p">(</span><span class="n">tabulate</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">around</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Keg</span><span class="p">,</span><span class="n">decimals</span><span class="o">=</span><span class="n">decimals</span><span class="p">)))</span>
        <span class="k">if</span> <span class="n">Me</span><span class="p">:</span>
            <span class="k">print</span><span class="p">(</span><span class="s">&#39;The beam element mass matrix is:&#39;</span><span class="p">)</span>
            <span class="k">print</span><span class="p">(</span><span class="n">tabulate</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">around</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Me</span><span class="p">,</span><span class="n">decimals</span><span class="o">=</span><span class="n">decimals</span><span class="p">)))</span>
        <span class="k">if</span> <span class="n">Fe</span><span class="p">:</span>
            <span class="k">print</span><span class="p">(</span><span class="s">&#39;The beam element force vector is:&#39;</span><span class="p">)</span>
            <span class="k">print</span><span class="p">(</span><span class="n">tabulate</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">around</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Fe</span><span class="p">,</span><span class="n">decimals</span><span class="o">=</span><span class="n">decimals</span><span class="p">)))</span>
<span class="k">class</span> <span class="nc">EBBeam</span><span class="p">(</span><span class="n">Beam</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Euler-Bernoulli beam class.</span>
<span class="sd">    </span>
<span class="sd">    This class is currently unsuppoted. Please use the more accurace timoshenko</span>
<span class="sd">    beam class</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">x1</span><span class="p">,</span><span class="n">x2</span><span class="p">,</span><span class="n">xsect</span><span class="p">,</span><span class="n">EID</span><span class="p">,</span><span class="n">SBID</span><span class="p">,</span><span class="n">nid1</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">nid2</span><span class="o">=</span><span class="mi">2</span><span class="p">):</span>
        <span class="c">#Description: Creases a single beam element, capable of being orientied</span>
        <span class="c">#in any desired manner within 3d space.</span>
        
        <span class="c">#INPUTS:</span>
        <span class="c">#x1 - The x,y,z coordinate of the first node in the element</span>
        <span class="c">#x2 - The x,y,z coordinate of the second node in the element</span>
        <span class="c">#xsect - Cross-section object</span>
        <span class="c">#eid - The element ID</span>
        <span class="c">#   Note, the EID is inherited from the Superbeam EID if not otherwise specified</span>
        <span class="c">#leid - The local element ID within a superbeam</span>
        <span class="c">#nid1 - the first node ID</span>
        <span class="c">#nid2 - the second node ID</span>
        <span class="c">#Note, for now these elements can only sustain constant distributed loads</span>
        <span class="n">Beam</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">xsect</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">type</span> <span class="o">=</span> <span class="s">&#39;EBbeam&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">n1</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span><span class="n">nid1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">n2</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">x2</span><span class="p">,</span><span class="n">nid2</span><span class="p">)</span>
        <span class="n">h</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">((</span><span class="n">x2</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">-</span><span class="n">x1</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span><span class="o">+</span><span class="p">(</span><span class="n">x2</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">x1</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span><span class="o">+</span><span class="p">(</span><span class="n">x2</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">-</span><span class="n">x1</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">h</span> <span class="o">=</span> <span class="n">h</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">xsect</span> <span class="o">=</span> <span class="n">xsect</span>
        <span class="n">K</span> <span class="o">=</span> <span class="n">xsect</span><span class="o">.</span><span class="n">K</span>
        <span class="c">#Lines below not needed, there for visual neatness</span>
        <span class="n">C33</span> <span class="o">=</span> <span class="n">K</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">];</span><span class="n">C34</span> <span class="o">=</span> <span class="n">K</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">];</span><span class="n">C35</span> <span class="o">=</span> <span class="n">K</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">4</span><span class="p">];</span><span class="n">C36</span> <span class="o">=</span> <span class="n">K</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">5</span><span class="p">]</span>
        <span class="n">C44</span> <span class="o">=</span> <span class="n">K</span><span class="p">[</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">];</span><span class="n">C45</span> <span class="o">=</span> <span class="n">K</span><span class="p">[</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">];</span><span class="n">C46</span> <span class="o">=</span> <span class="n">K</span><span class="p">[</span><span class="mi">3</span><span class="p">,</span><span class="mi">5</span><span class="p">]</span>
        <span class="n">C55</span> <span class="o">=</span> <span class="n">K</span><span class="p">[</span><span class="mi">4</span><span class="p">,</span><span class="mi">4</span><span class="p">];</span><span class="n">C56</span> <span class="o">=</span> <span class="n">K</span><span class="p">[</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">]</span>
        <span class="n">C66</span> <span class="o">=</span> <span class="n">K</span><span class="p">[</span><span class="mi">5</span><span class="p">,</span><span class="mi">5</span><span class="p">]</span>
        <span class="n">ketmp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mf">12.</span><span class="o">*</span><span class="n">C44</span><span class="o">/</span><span class="n">h</span><span class="o">**</span><span class="mi">3</span><span class="p">,</span><span class="mf">12.</span><span class="o">*</span><span class="n">C45</span><span class="o">/</span><span class="n">h</span><span class="o">**</span><span class="mi">3</span><span class="p">,</span><span class="mf">0.</span><span class="p">,</span><span class="o">-</span><span class="mf">6.</span><span class="o">*</span><span class="n">C44</span><span class="o">/</span><span class="n">h</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span><span class="o">-</span><span class="mf">6.</span><span class="o">*</span><span class="n">C45</span><span class="o">/</span><span class="n">h</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span><span class="mf">0.</span><span class="p">,</span><span class="o">-</span><span class="mf">12.</span><span class="o">*</span><span class="n">C44</span><span class="o">/</span><span class="n">h</span><span class="o">**</span><span class="mi">3</span><span class="p">,</span><span class="o">-</span><span class="mf">12.</span><span class="o">*</span><span class="n">C45</span><span class="o">/</span><span class="n">h</span><span class="o">**</span><span class="mi">3</span><span class="p">,</span><span class="mf">0.</span><span class="p">,</span><span class="o">-</span><span class="mf">6.</span><span class="o">*</span><span class="n">C44</span><span class="o">/</span><span class="n">h</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span><span class="o">-</span><span class="mf">6.</span><span class="o">*</span><span class="n">C45</span><span class="o">/</span><span class="n">h</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span><span class="mf">0.</span><span class="p">],</span>\
                          <span class="p">[</span><span class="mf">12.</span><span class="o">*</span><span class="n">C45</span><span class="o">/</span><span class="n">h</span><span class="o">**</span><span class="mi">3</span><span class="p">,</span><span class="mf">12.</span><span class="o">*</span><span class="n">C55</span><span class="o">/</span><span class="n">h</span><span class="o">**</span><span class="mi">3</span><span class="p">,</span><span class="mf">0.</span><span class="p">,</span><span class="o">-</span><span class="mf">6.</span><span class="o">*</span><span class="n">C45</span><span class="o">/</span><span class="n">h</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span><span class="o">-</span><span class="mf">6.</span><span class="o">*</span><span class="n">C55</span><span class="o">/</span><span class="n">h</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span><span class="mf">0.</span><span class="p">,</span><span class="o">-</span><span class="mf">12.</span><span class="o">*</span><span class="n">C45</span><span class="o">/</span><span class="n">h</span><span class="o">**</span><span class="mi">3</span><span class="p">,</span><span class="o">-</span><span class="mf">12.</span><span class="o">*</span><span class="n">C55</span><span class="o">/</span><span class="n">h</span><span class="o">**</span><span class="mi">3</span><span class="p">,</span><span class="mf">0.</span><span class="p">,</span><span class="o">-</span><span class="mf">6.</span><span class="o">*</span><span class="n">C45</span><span class="o">/</span><span class="n">h</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span><span class="o">-</span><span class="mf">6.</span><span class="o">*</span><span class="n">C55</span><span class="o">/</span><span class="n">h</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span><span class="mf">0.</span><span class="p">],</span>\
                          <span class="p">[</span><span class="mf">0.</span><span class="p">,</span><span class="mf">0.</span><span class="p">,</span><span class="n">C33</span><span class="o">/</span><span class="n">h</span><span class="p">,</span><span class="o">-</span><span class="n">C34</span><span class="o">/</span><span class="n">h</span><span class="p">,</span><span class="o">-</span><span class="n">C35</span><span class="o">/</span><span class="n">h</span><span class="p">,</span><span class="n">C36</span><span class="o">/</span><span class="n">h</span><span class="p">,</span><span class="mf">0.</span><span class="p">,</span><span class="mf">0.</span><span class="p">,</span><span class="o">-</span><span class="n">C33</span><span class="o">/</span><span class="n">h</span><span class="p">,</span><span class="n">C34</span><span class="o">/</span><span class="n">h</span><span class="p">,</span><span class="n">C35</span><span class="o">/</span><span class="n">h</span><span class="p">,</span><span class="o">-</span><span class="n">C36</span><span class="o">/</span><span class="n">h</span><span class="p">],</span>\
                          <span class="p">[</span><span class="o">-</span><span class="mf">6.</span><span class="o">*</span><span class="n">C44</span><span class="o">/</span><span class="n">h</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span><span class="o">-</span><span class="mf">6.</span><span class="o">*</span><span class="n">C45</span><span class="o">/</span><span class="n">h</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span><span class="o">-</span><span class="n">C34</span><span class="o">/</span><span class="n">h</span><span class="p">,</span><span class="mf">4.</span><span class="o">*</span><span class="n">C44</span><span class="o">/</span><span class="n">h</span><span class="p">,</span><span class="mf">4.</span><span class="o">*</span><span class="n">C45</span><span class="o">/</span><span class="n">h</span><span class="p">,</span><span class="o">-</span><span class="n">C46</span><span class="o">/</span><span class="n">h</span><span class="p">,</span><span class="mf">6.</span><span class="o">*</span><span class="n">C44</span><span class="o">/</span><span class="n">h</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span><span class="mf">6.</span><span class="o">*</span><span class="n">C45</span><span class="o">/</span><span class="n">h</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span><span class="n">C34</span><span class="o">/</span><span class="n">h</span><span class="p">,</span><span class="mf">2.</span><span class="o">*</span><span class="n">C44</span><span class="o">/</span><span class="n">h</span><span class="p">,</span><span class="mf">2.</span><span class="o">*</span><span class="n">C45</span><span class="o">/</span><span class="n">h</span><span class="p">,</span><span class="n">C46</span><span class="o">/</span><span class="n">h</span><span class="p">],</span>\
                          <span class="p">[</span><span class="o">-</span><span class="mf">6.</span><span class="o">*</span><span class="n">C45</span><span class="o">/</span><span class="n">h</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span><span class="o">-</span><span class="mf">6.</span><span class="o">*</span><span class="n">C55</span><span class="o">/</span><span class="n">h</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span><span class="o">-</span><span class="n">C35</span><span class="o">/</span><span class="n">h</span><span class="p">,</span><span class="mf">4.</span><span class="o">*</span><span class="n">C45</span><span class="o">/</span><span class="n">h</span><span class="p">,</span><span class="mf">4.</span><span class="o">*</span><span class="n">C55</span><span class="o">/</span><span class="n">h</span><span class="p">,</span><span class="o">-</span><span class="n">C56</span><span class="o">/</span><span class="n">h</span><span class="p">,</span><span class="mf">6.</span><span class="o">*</span><span class="n">C45</span><span class="o">/</span><span class="n">h</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span><span class="mf">6.</span><span class="o">*</span><span class="n">C55</span><span class="o">/</span><span class="n">h</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span><span class="n">C35</span><span class="o">/</span><span class="n">h</span><span class="p">,</span><span class="mf">2.</span><span class="o">*</span><span class="n">C45</span><span class="o">/</span><span class="n">h</span><span class="p">,</span><span class="mf">2.</span><span class="o">*</span><span class="n">C55</span><span class="o">/</span><span class="n">h</span><span class="p">,</span><span class="n">C56</span><span class="o">/</span><span class="n">h</span><span class="p">],</span>\
                          <span class="p">[</span><span class="mf">0.</span><span class="p">,</span><span class="mf">0.</span><span class="p">,</span><span class="n">C36</span><span class="o">/</span><span class="n">h</span><span class="p">,</span><span class="o">-</span><span class="n">C46</span><span class="o">/</span><span class="n">h</span><span class="p">,</span><span class="o">-</span><span class="n">C56</span><span class="o">/</span><span class="n">h</span><span class="p">,</span><span class="n">C66</span><span class="o">/</span><span class="n">h</span><span class="p">,</span><span class="mf">0.</span><span class="p">,</span><span class="mf">0.</span><span class="p">,</span><span class="o">-</span><span class="n">C36</span><span class="o">/</span><span class="n">h</span><span class="p">,</span><span class="n">C46</span><span class="o">/</span><span class="n">h</span><span class="p">,</span><span class="n">C56</span><span class="o">/</span><span class="n">h</span><span class="p">,</span><span class="o">-</span><span class="n">C66</span><span class="o">/</span><span class="n">h</span><span class="p">],</span>\
                          <span class="p">[</span><span class="o">-</span><span class="mf">12.</span><span class="o">*</span><span class="n">C44</span><span class="o">/</span><span class="n">h</span><span class="o">**</span><span class="mi">3</span><span class="p">,</span><span class="o">-</span><span class="mf">12.</span><span class="o">*</span><span class="n">C45</span><span class="o">/</span><span class="n">h</span><span class="o">**</span><span class="mi">3</span><span class="p">,</span><span class="mf">0.</span><span class="p">,</span><span class="mf">6.</span><span class="o">*</span><span class="n">C44</span><span class="o">/</span><span class="n">h</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span><span class="mf">6.</span><span class="o">*</span><span class="n">C45</span><span class="o">/</span><span class="n">h</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span><span class="mf">0.</span><span class="p">,</span><span class="mf">12.</span><span class="o">*</span><span class="n">C44</span><span class="o">/</span><span class="n">h</span><span class="o">**</span><span class="mi">3</span><span class="p">,</span><span class="mf">12.</span><span class="o">*</span><span class="n">C45</span><span class="o">/</span><span class="n">h</span><span class="o">**</span><span class="mi">3</span><span class="p">,</span><span class="mf">0.</span><span class="p">,</span><span class="mf">6.</span><span class="o">*</span><span class="n">C44</span><span class="o">/</span><span class="n">h</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span><span class="mf">6.</span><span class="o">*</span><span class="n">C45</span><span class="o">/</span><span class="n">h</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span><span class="mf">0.</span><span class="p">],</span>\
                          <span class="p">[</span><span class="o">-</span><span class="mf">12.</span><span class="o">*</span><span class="n">C45</span><span class="o">/</span><span class="n">h</span><span class="o">**</span><span class="mi">3</span><span class="p">,</span><span class="o">-</span><span class="mf">12.</span><span class="o">*</span><span class="n">C55</span><span class="o">/</span><span class="n">h</span><span class="o">**</span><span class="mi">3</span><span class="p">,</span><span class="mf">0.</span><span class="p">,</span><span class="mf">6.</span><span class="o">*</span><span class="n">C45</span><span class="o">/</span><span class="n">h</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span><span class="mf">6.</span><span class="o">*</span><span class="n">C55</span><span class="o">/</span><span class="n">h</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span><span class="mf">0.</span><span class="p">,</span><span class="mf">12.</span><span class="o">*</span><span class="n">C45</span><span class="o">/</span><span class="n">h</span><span class="o">**</span><span class="mi">3</span><span class="p">,</span><span class="mf">12.</span><span class="o">*</span><span class="n">C55</span><span class="o">/</span><span class="n">h</span><span class="o">**</span><span class="mi">3</span><span class="p">,</span><span class="mf">0.</span><span class="p">,</span><span class="mf">6.</span><span class="o">*</span><span class="n">C45</span><span class="o">/</span><span class="n">h</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span><span class="mf">6.</span><span class="o">*</span><span class="n">C55</span><span class="o">/</span><span class="n">h</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span><span class="mf">0.</span><span class="p">],</span>\
                          <span class="p">[</span><span class="mf">0.</span><span class="p">,</span><span class="mf">0.</span><span class="p">,</span><span class="o">-</span><span class="n">C33</span><span class="o">/</span><span class="n">h</span><span class="p">,</span><span class="n">C34</span><span class="o">/</span><span class="n">h</span><span class="p">,</span><span class="n">C35</span><span class="o">/</span><span class="n">h</span><span class="p">,</span><span class="o">-</span><span class="n">C36</span><span class="o">/</span><span class="n">h</span><span class="p">,</span><span class="mf">0.</span><span class="p">,</span><span class="mf">0.</span><span class="p">,</span><span class="n">C33</span><span class="o">/</span><span class="n">h</span><span class="p">,</span><span class="o">-</span><span class="n">C34</span><span class="o">/</span><span class="n">h</span><span class="p">,</span><span class="o">-</span><span class="n">C35</span><span class="o">/</span><span class="n">h</span><span class="p">,</span><span class="n">C36</span><span class="o">/</span><span class="n">h</span><span class="p">],</span>\
                          <span class="p">[</span><span class="o">-</span><span class="mf">6.</span><span class="o">*</span><span class="n">C44</span><span class="o">/</span><span class="n">h</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span><span class="o">-</span><span class="mf">6.</span><span class="o">*</span><span class="n">C45</span><span class="o">/</span><span class="n">h</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span><span class="n">C34</span><span class="o">/</span><span class="n">h</span><span class="p">,</span><span class="mf">2.</span><span class="o">*</span><span class="n">C44</span><span class="o">/</span><span class="n">h</span><span class="p">,</span><span class="mf">2.</span><span class="o">*</span><span class="n">C45</span><span class="o">/</span><span class="n">h</span><span class="p">,</span><span class="n">C46</span><span class="o">/</span><span class="n">h</span><span class="p">,</span><span class="mf">6.</span><span class="o">*</span><span class="n">C44</span><span class="o">/</span><span class="n">h</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span><span class="mf">6.</span><span class="o">*</span><span class="n">C45</span><span class="o">/</span><span class="n">h</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span><span class="o">-</span><span class="n">C34</span><span class="o">/</span><span class="n">h</span><span class="p">,</span><span class="mf">4.</span><span class="o">*</span><span class="n">C44</span><span class="o">/</span><span class="n">h</span><span class="p">,</span><span class="mf">4.</span><span class="o">*</span><span class="n">C45</span><span class="o">/</span><span class="n">h</span><span class="p">,</span><span class="o">-</span><span class="n">C46</span><span class="o">/</span><span class="n">h</span><span class="p">],</span>\
                          <span class="p">[</span><span class="o">-</span><span class="mf">6.</span><span class="o">*</span><span class="n">C45</span><span class="o">/</span><span class="n">h</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span><span class="o">-</span><span class="mf">6.</span><span class="o">*</span><span class="n">C55</span><span class="o">/</span><span class="n">h</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span><span class="n">C35</span><span class="o">/</span><span class="n">h</span><span class="p">,</span><span class="mf">2.</span><span class="o">*</span><span class="n">C45</span><span class="o">/</span><span class="n">h</span><span class="p">,</span><span class="mf">2.</span><span class="o">*</span><span class="n">C55</span><span class="o">/</span><span class="n">h</span><span class="p">,</span><span class="n">C56</span><span class="o">/</span><span class="n">h</span><span class="p">,</span><span class="mf">6.</span><span class="o">*</span><span class="n">C45</span><span class="o">/</span><span class="n">h</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span><span class="mf">6.</span><span class="o">*</span><span class="n">C55</span><span class="o">/</span><span class="n">h</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span><span class="o">-</span><span class="n">C35</span><span class="o">/</span><span class="n">h</span><span class="p">,</span><span class="mf">4.</span><span class="o">*</span><span class="n">C45</span><span class="o">/</span><span class="n">h</span><span class="p">,</span><span class="mf">4.</span><span class="o">*</span><span class="n">C55</span><span class="o">/</span><span class="n">h</span><span class="p">,</span><span class="o">-</span><span class="n">C56</span><span class="o">/</span><span class="n">h</span><span class="p">],</span>\
                          <span class="p">[</span><span class="mf">0.</span><span class="p">,</span><span class="mf">0.</span><span class="p">,</span><span class="o">-</span><span class="n">C36</span><span class="o">/</span><span class="n">h</span><span class="p">,</span><span class="n">C46</span><span class="o">/</span><span class="n">h</span><span class="p">,</span><span class="n">C56</span><span class="o">/</span><span class="n">h</span><span class="p">,</span><span class="o">-</span><span class="n">C66</span><span class="o">/</span><span class="n">h</span><span class="p">,</span><span class="mf">0.</span><span class="p">,</span><span class="mf">0.</span><span class="p">,</span><span class="n">C36</span><span class="o">/</span><span class="n">h</span><span class="p">,</span><span class="o">-</span><span class="n">C46</span><span class="o">/</span><span class="n">h</span><span class="p">,</span><span class="o">-</span><span class="n">C56</span><span class="o">/</span><span class="n">h</span><span class="p">,</span><span class="n">C66</span><span class="o">/</span><span class="n">h</span><span class="p">]])</span>            
        <span class="bp">self</span><span class="o">.</span><span class="n">Ke</span> <span class="o">=</span> <span class="n">ketmp</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Fe</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">12</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
        <span class="c">#Initialize the Geometric Stiffness Matrix</span>
        <span class="n">kgtmp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mf">6.</span><span class="o">/</span><span class="p">(</span><span class="mf">5.</span><span class="o">*</span><span class="n">h</span><span class="p">),</span><span class="mf">0.</span><span class="p">,</span><span class="mf">0.</span><span class="p">,</span><span class="o">-</span><span class="mf">1.</span><span class="o">/</span><span class="mf">10.</span><span class="p">,</span><span class="mf">0.</span><span class="p">,</span><span class="mf">0.</span><span class="p">,</span><span class="o">-</span><span class="mi">6</span><span class="o">/</span><span class="p">(</span><span class="mf">5.</span><span class="o">*</span><span class="n">h</span><span class="p">),</span><span class="mf">0.</span><span class="p">,</span><span class="mf">0.</span><span class="p">,</span><span class="o">-</span><span class="mf">1.</span><span class="o">/</span><span class="mf">10.</span><span class="p">,</span><span class="mf">0.</span><span class="p">,</span><span class="mf">0.</span><span class="p">],</span>\
                          <span class="p">[</span><span class="mf">0.</span><span class="p">,</span><span class="mf">6.</span><span class="o">/</span><span class="p">(</span><span class="mf">5.</span><span class="o">*</span><span class="n">h</span><span class="p">),</span><span class="mf">0.</span><span class="p">,</span><span class="mf">0.</span><span class="p">,</span><span class="o">-</span><span class="mf">1.</span><span class="o">/</span><span class="mf">10.</span><span class="p">,</span><span class="mf">0.</span><span class="p">,</span><span class="mf">0.</span><span class="p">,</span><span class="o">-</span><span class="mf">6.</span><span class="o">/</span><span class="p">(</span><span class="mf">5.</span><span class="o">*</span><span class="n">h</span><span class="p">),</span><span class="mf">0.</span><span class="p">,</span><span class="mf">0.</span><span class="p">,</span><span class="o">-</span><span class="mf">1.</span><span class="o">/</span><span class="mf">10.</span><span class="p">,</span><span class="mf">0.</span><span class="p">],</span>\
                          <span class="p">[</span><span class="mf">0.</span><span class="p">,</span><span class="mf">0.</span><span class="p">,</span><span class="mf">0.</span><span class="p">,</span><span class="mf">0.</span><span class="p">,</span><span class="mf">0.</span><span class="p">,</span><span class="mf">0.</span><span class="p">,</span><span class="mf">0.</span><span class="p">,</span><span class="mf">0.</span><span class="p">,</span><span class="mf">0.</span><span class="p">,</span><span class="mf">0.</span><span class="p">,</span><span class="mf">0.</span><span class="p">,</span><span class="mf">0.</span><span class="p">],</span>\
                          <span class="p">[</span><span class="o">-</span><span class="mf">1.</span><span class="o">/</span><span class="mf">10.</span><span class="p">,</span><span class="mf">0.</span><span class="p">,</span><span class="mf">0.</span><span class="p">,</span><span class="mf">2.</span><span class="o">*</span><span class="n">h</span><span class="o">/</span><span class="mf">15.</span><span class="p">,</span><span class="mf">0.</span><span class="p">,</span><span class="mf">0.</span><span class="p">,</span><span class="mf">1.</span><span class="o">/</span><span class="mf">10.</span><span class="p">,</span><span class="mf">0.</span><span class="p">,</span><span class="mf">0.</span><span class="p">,</span><span class="o">-</span><span class="n">h</span><span class="o">/</span><span class="mf">30.</span><span class="p">,</span><span class="mf">0.</span><span class="p">,</span><span class="mf">0.</span><span class="p">],</span>\
                          <span class="p">[</span><span class="mf">0.</span><span class="p">,</span><span class="o">-</span><span class="mf">1.</span><span class="o">/</span><span class="mf">10.</span><span class="p">,</span><span class="mf">0.</span><span class="p">,</span><span class="mf">0.</span><span class="p">,</span><span class="mf">2.</span><span class="o">*</span><span class="n">h</span><span class="o">/</span><span class="mf">15.</span><span class="p">,</span><span class="mf">0.</span><span class="p">,</span><span class="mf">0.</span><span class="p">,</span><span class="mf">1.</span><span class="o">/</span><span class="mf">10.</span><span class="p">,</span><span class="mf">0.</span><span class="p">,</span><span class="mf">0.</span><span class="p">,</span><span class="o">-</span><span class="n">h</span><span class="o">/</span><span class="mf">30.</span><span class="p">,</span><span class="mf">0.</span><span class="p">],</span>\
                          <span class="p">[</span><span class="mf">0.</span><span class="p">,</span><span class="mf">0.</span><span class="p">,</span><span class="mf">0.</span><span class="p">,</span><span class="mf">0.</span><span class="p">,</span><span class="mf">0.</span><span class="p">,</span><span class="mf">0.</span><span class="p">,</span><span class="mf">0.</span><span class="p">,</span><span class="mf">0.</span><span class="p">,</span><span class="mf">0.</span><span class="p">,</span><span class="mf">0.</span><span class="p">,</span><span class="mf">0.</span><span class="p">,</span><span class="mf">0.</span><span class="p">],</span>\
                          <span class="p">[</span><span class="o">-</span><span class="mf">6.</span><span class="o">/</span><span class="p">(</span><span class="mf">5.</span><span class="o">*</span><span class="n">h</span><span class="p">),</span><span class="mf">0.</span><span class="p">,</span><span class="mf">0.</span><span class="p">,</span><span class="mf">1.</span><span class="o">/</span><span class="mf">10.</span><span class="p">,</span><span class="mf">0.</span><span class="p">,</span><span class="mf">0.</span><span class="p">,</span><span class="mf">6.</span><span class="o">/</span><span class="p">(</span><span class="mf">5.</span><span class="o">*</span><span class="n">h</span><span class="p">),</span><span class="mf">0.</span><span class="p">,</span><span class="mf">0.</span><span class="p">,</span><span class="mf">1.</span><span class="o">/</span><span class="mf">10.</span><span class="p">,</span><span class="mf">0.</span><span class="p">,</span><span class="mf">0.</span><span class="p">],</span>\
                          <span class="p">[</span><span class="mf">0.</span><span class="p">,</span><span class="o">-</span><span class="mf">6.</span><span class="o">/</span><span class="p">(</span><span class="mf">5.</span><span class="o">*</span><span class="n">h</span><span class="p">),</span><span class="mf">0.</span><span class="p">,</span><span class="mf">0.</span><span class="p">,</span><span class="mf">1.</span><span class="o">/</span><span class="mf">10.</span><span class="p">,</span><span class="mf">0.</span><span class="p">,</span><span class="mf">0.</span><span class="p">,</span><span class="mf">6.</span><span class="o">/</span><span class="p">(</span><span class="mf">5.</span><span class="o">*</span><span class="n">h</span><span class="p">),</span><span class="mf">0.</span><span class="p">,</span><span class="mf">0.</span><span class="p">,</span><span class="mf">1.</span><span class="o">/</span><span class="mf">10.</span><span class="p">,</span><span class="mf">0.</span><span class="p">],</span>\
                          <span class="p">[</span><span class="mf">0.</span><span class="p">,</span><span class="mf">0.</span><span class="p">,</span><span class="mf">0.</span><span class="p">,</span><span class="mf">0.</span><span class="p">,</span><span class="mf">0.</span><span class="p">,</span><span class="mf">0.</span><span class="p">,</span><span class="mf">0.</span><span class="p">,</span><span class="mf">0.</span><span class="p">,</span><span class="mf">0.</span><span class="p">,</span><span class="mf">0.</span><span class="p">,</span><span class="mf">0.</span><span class="p">,</span><span class="mf">0.</span><span class="p">],</span>\
                          <span class="p">[</span><span class="o">-</span><span class="mf">1.</span><span class="o">/</span><span class="mf">10.</span><span class="p">,</span><span class="mf">0.</span><span class="p">,</span><span class="mf">0.</span><span class="p">,</span><span class="o">-</span><span class="n">h</span><span class="o">/</span><span class="mf">30.</span><span class="p">,</span><span class="mf">0.</span><span class="p">,</span><span class="mf">0.</span><span class="p">,</span><span class="mf">1.</span><span class="o">/</span><span class="mf">10.</span><span class="p">,</span><span class="mf">0.</span><span class="p">,</span><span class="mf">0.</span><span class="p">,</span><span class="mf">2.</span><span class="o">*</span><span class="n">h</span><span class="o">/</span><span class="mf">15.</span><span class="p">,</span><span class="mf">0.</span><span class="p">,</span><span class="mf">0.</span><span class="p">],</span>\
                          <span class="p">[</span><span class="mf">0.</span><span class="p">,</span><span class="o">-</span><span class="mf">1.</span><span class="o">/</span><span class="mf">10.</span><span class="p">,</span><span class="mf">0.</span><span class="p">,</span><span class="mf">0.</span><span class="p">,</span><span class="o">-</span><span class="n">h</span><span class="o">/</span><span class="mf">30.</span><span class="p">,</span><span class="mf">0.</span><span class="p">,</span><span class="mf">0.</span><span class="p">,</span><span class="mf">1.</span><span class="o">/</span><span class="mf">10.</span><span class="p">,</span><span class="mf">0.</span><span class="p">,</span><span class="mf">0.</span><span class="p">,</span><span class="mf">2.</span><span class="o">*</span><span class="n">h</span><span class="o">/</span><span class="mf">15.</span><span class="p">,</span><span class="mf">0.</span><span class="p">],</span>\
                          <span class="p">[</span><span class="mf">0.</span><span class="p">,</span><span class="mf">0.</span><span class="p">,</span><span class="mf">0.</span><span class="p">,</span><span class="mf">0.</span><span class="p">,</span><span class="mf">0.</span><span class="p">,</span><span class="mf">0.</span><span class="p">,</span><span class="mf">0.</span><span class="p">,</span><span class="mf">0.</span><span class="p">,</span><span class="mf">0.</span><span class="p">,</span><span class="mf">0.</span><span class="p">,</span><span class="mf">0.</span><span class="p">,</span><span class="mf">0.</span><span class="p">]])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Keg</span> <span class="o">=</span> <span class="n">kgtmp</span>
        
<div class="viewcode-block" id="TBeam"><a class="viewcode-back" href="../../structures.html#AeroComBAT.Structures.TBeam">[docs]</a><span class="k">class</span> <span class="nc">TBeam</span><span class="p">(</span><span class="n">Beam</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Creates a Timoshenko beam finite element object.</span>
<span class="sd">    </span>
<span class="sd">    The primary beam finite element used by AeroComBAT, this beam element is</span>
<span class="sd">    similar to the Euler-Bernoulli beam finite element most are farmiliar with,</span>
<span class="sd">    with the exception that it has the ability to experience shear deformation</span>
<span class="sd">    in addition to just bending.</span>
<span class="sd">    </span>
<span class="sd">    :Attributes:</span>
<span class="sd">    </span>
<span class="sd">    - `type (str)`:String describing the type of beam element being used.</span>
<span class="sd">    - `U1 (dict)`: This dictionary contains the results of an analysis set. The</span>
<span class="sd">        keys are the string names of the analysis and the values stored are</span>
<span class="sd">        6x1 np.array[float] vectors containing the 3 displacements and</span>
<span class="sd">        3 rotations at the first node.</span>
<span class="sd">    - `U2 (dict)`: This dictionary contains the results of an analysis set. The</span>
<span class="sd">        keys are the string names of the analysis and the values stored are</span>
<span class="sd">        6x1 np.array[float] vectors containing the 3 displacements and</span>
<span class="sd">        3 rotations at the second node.</span>
<span class="sd">    - `Umode1 (dict)`: This dictionary contains the results of a modal analysis</span>
<span class="sd">        set. The keys are the string names of the analysis and the values</span>
<span class="sd">        stored are 6xN np.array[float]. The columns of the array are the</span>
<span class="sd">        displacements and rotations at the first node associated with the</span>
<span class="sd">        particular mode.</span>
<span class="sd">    - `Umode2 (dict)`: This dictionary contains the results of a modal analysis</span>
<span class="sd">        set. The keys are the string names of the analysis and the values</span>
<span class="sd">        stored are 6xN np.array[float]. The columns of the array are the</span>
<span class="sd">        displacements and rotations at the second node associated with the</span>
<span class="sd">        particular mode.</span>
<span class="sd">    - `F1 (dict)`: This dictionary contains the results of an analysis set. The</span>
<span class="sd">        keys are the string names of the analysis and the values stored are</span>
<span class="sd">        6x1 np.array[float] vectors containing the 3 internal forces and</span>
<span class="sd">        3 moments at the first node.</span>
<span class="sd">    - `F2 (dict)`: This dictionary contains the results of an analysis set. The</span>
<span class="sd">        keys are the string names of the analysis and the values stored are</span>
<span class="sd">        6x1 np.array[float] vectors containing the 3 internal forces and</span>
<span class="sd">        3 moments at the second node.</span>
<span class="sd">    - `Fmode1 (dict)`: This dictionary contains the results of a modal analysis</span>
<span class="sd">        set. The keys are the string names of the analysis and the values</span>
<span class="sd">        stored are 6xN np.array[float]. The columns of the array are the</span>
<span class="sd">        forces and moments at the first node associated with the</span>
<span class="sd">        particular mode.*</span>
<span class="sd">    - `Fmode2 (dict)`: This dictionary contains the results of a modal analysis</span>
<span class="sd">        set. The keys are the string names of the analysis and the values</span>
<span class="sd">        stored are 6xN np.array[float]. The columns of the array are the</span>
<span class="sd">        forces and moments at the second node associated with the</span>
<span class="sd">        particular mode.*</span>
<span class="sd">    - `xsect (obj)`: The cross-section object used to determine the beams</span>
<span class="sd">        stiffnesses.</span>
<span class="sd">    - `EID (int)`: The element ID of the beam.</span>
<span class="sd">    - `SBID (int)`: The associated Superbeam ID the beam object belongs to.</span>
<span class="sd">    - `n1 (obj)`: The first nodal object used by the beam.</span>
<span class="sd">    - `n2 (obj)`: The second nodal object used by the beam.</span>
<span class="sd">    - `Fe (12x1 np.array[float])`: The distributed force vector of the element</span>
<span class="sd">    - `Ke (12x12 np.array[float])`: The stiffness matrix of the beam.</span>
<span class="sd">    - `Keg (12x12 np.array[float])`: The geometric stiffness matrix of the</span>
<span class="sd">        beam. Used for beam buckling calculations.</span>
<span class="sd">    - `Me (12x12 np.array[float])`: The mass matrix of the beam.</span>
<span class="sd">    - `h (float)`: The magnitude length of the beam element.</span>
<span class="sd">    - `xbar (float)`: The unit vector pointing in the direction of the rigid</span>
<span class="sd">        beam.</span>
<span class="sd">    - `T (12x12 np.array[float])`:</span>
<span class="sd">        </span>
<span class="sd">    :Methods:</span>
<span class="sd">    </span>
<span class="sd">    - `printSummary`: This method prints out characteristic attributes of the</span>
<span class="sd">        beam finite element.</span>
<span class="sd">    - `plotRigidBeam`: Plots the the shape of the rigid beam element.</span>
<span class="sd">    - `plotDisplBeam`: Plots the deformed shape of the beam element.</span>
<span class="sd">    - `printInternalForce`: Prints the internal forces of the beam element for</span>
<span class="sd">        a given analysis set</span>
<span class="sd">        </span>
<span class="sd">    .. Note:: The force and moments in the Fmode1 and Fmode2 could be completely</span>
<span class="sd">    fictitious and be left as an artifact to fascilitate plotting of warped</span>
<span class="sd">    cross-sections. DO NOT rely on this information being meaningful.</span>
<span class="sd">    </span>
<span class="sd">    &quot;&quot;&quot;</span>
<div class="viewcode-block" id="TBeam.__init__"><a class="viewcode-back" href="../../structures.html#AeroComBAT.Structures.TBeam.__init__">[docs]</a>    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">EID</span><span class="p">,</span><span class="n">x1</span><span class="p">,</span><span class="n">x2</span><span class="p">,</span><span class="n">xsect</span><span class="p">,</span><span class="n">SBID</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">nid1</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">nid2</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">chordVec</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">1.</span><span class="p">,</span><span class="mf">0.</span><span class="p">,</span><span class="mf">0.</span><span class="p">])):</span>
        <span class="sd">&quot;&quot;&quot;Instantiates a timoshenko beam element.</span>
<span class="sd">        </span>
<span class="sd">        This method instatiates a finite element timoshenko beam element.</span>
<span class="sd">        Currently the beam must be oriented along the global y-axis, however</span>
<span class="sd">        full 3D orientation support for frames is in progress.</span>
<span class="sd">        </span>
<span class="sd">        :Args:</span>
<span class="sd">        </span>
<span class="sd">        - `x1 (1x3 np.array[float])`: The 3D coordinates of the first beam</span>
<span class="sd">            element node.</span>
<span class="sd">        - `x2 (1x3 np.array[float])`: The 3D coordinates of the second beam</span>
<span class="sd">            element node.</span>
<span class="sd">        - `xsect (obj)`: The cross-section object used to determine stiffnes</span>
<span class="sd">            and mass properties for the beam.</span>
<span class="sd">        - `EID (int)`: The integer identifier for the beam.</span>
<span class="sd">        - `SBID (int)`: The associated superbeam ID.</span>
<span class="sd">        - `nid1 (int)`: The first node ID</span>
<span class="sd">        - `nid2 (int)`: The second node ID</span>
<span class="sd">            </span>
<span class="sd">        :Returns:</span>
<span class="sd">        </span>
<span class="sd">        - None</span>
<span class="sd">            </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c"># Inherit from Beam class</span>
        <span class="n">Beam</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">xsect</span><span class="p">,</span><span class="n">EID</span><span class="p">,</span><span class="n">SBID</span><span class="p">)</span>
        <span class="c"># Initialize element type</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">type</span> <span class="o">=</span> <span class="s">&#39;Tbeam&#39;</span>
        <span class="c"># Verify properly dimensionalized coordinates are used to create the</span>
        <span class="c"># nodes.</span>
        <span class="k">if</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">x1</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">3</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">x2</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">3</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s">&#39;The nodal coordinates of the beam must be 3 dimensional.&#39;</span><span class="p">)</span>
        <span class="c"># Create the node objects</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">n1</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">nid1</span><span class="p">,</span><span class="n">x1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">n2</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">nid2</span><span class="p">,</span><span class="n">x2</span><span class="p">)</span>
        <span class="c"># Solve for the length of the beam</span>
        <span class="n">h</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">x2</span><span class="o">-</span><span class="n">x1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">h</span> <span class="o">=</span> <span class="n">h</span>
        <span class="c"># Solve for the beam unit vector</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">xbar</span> <span class="o">=</span> <span class="p">(</span><span class="n">x2</span><span class="o">-</span><span class="n">x1</span><span class="p">)</span><span class="o">/</span><span class="n">h</span>
        <span class="c"># Determine the Transformation Matrix</span>
        <span class="n">zVec</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">xbar</span>
        <span class="n">yVec</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cross</span><span class="p">(</span><span class="n">zVec</span><span class="p">,</span><span class="n">chordVec</span><span class="p">)</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">cross</span><span class="p">(</span><span class="n">zVec</span><span class="p">,</span><span class="n">chordVec</span><span class="p">))</span>
        <span class="n">xVec</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cross</span><span class="p">(</span><span class="n">yVec</span><span class="p">,</span><span class="n">zVec</span><span class="p">)</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">cross</span><span class="p">(</span><span class="n">yVec</span><span class="p">,</span><span class="n">zVec</span><span class="p">))</span>
        <span class="n">Tsubmat</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">((</span><span class="n">xVec</span><span class="p">,</span><span class="n">yVec</span><span class="p">,</span><span class="n">zVec</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">T</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">3</span><span class="p">,</span><span class="mi">0</span><span class="p">:</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="n">Tsubmat</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">T</span><span class="p">[</span><span class="mi">3</span><span class="p">:</span><span class="mi">6</span><span class="p">,</span><span class="mi">3</span><span class="p">:</span><span class="mi">6</span><span class="p">]</span> <span class="o">=</span> <span class="n">Tsubmat</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">T</span><span class="p">[</span><span class="mi">6</span><span class="p">:</span><span class="mi">9</span><span class="p">,</span><span class="mi">6</span><span class="p">:</span><span class="mi">9</span><span class="p">]</span> <span class="o">=</span> <span class="n">Tsubmat</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">T</span><span class="p">[</span><span class="mi">9</span><span class="p">:</span><span class="mi">12</span><span class="p">,</span><span class="mi">9</span><span class="p">:</span><span class="mi">12</span><span class="p">]</span> <span class="o">=</span> <span class="n">Tsubmat</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">xsect</span> <span class="o">=</span> <span class="n">xsect</span>
        <span class="c"># Create a local reference to the cross-section stiffness matrix</span>
        <span class="n">K</span> <span class="o">=</span> <span class="n">xsect</span><span class="o">.</span><span class="n">K</span>
        <span class="c"># Lines below not needed, there for visual neatness</span>
        <span class="n">C11</span> <span class="o">=</span> <span class="n">K</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">];</span><span class="n">C12</span> <span class="o">=</span> <span class="n">K</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">];</span><span class="n">C13</span> <span class="o">=</span> <span class="n">K</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">];</span><span class="n">C14</span> <span class="o">=</span> <span class="n">K</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">3</span><span class="p">];</span><span class="n">C15</span> <span class="o">=</span> <span class="n">K</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">4</span><span class="p">];</span><span class="n">C16</span> <span class="o">=</span> <span class="n">K</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">5</span><span class="p">]</span>
        <span class="n">C22</span> <span class="o">=</span> <span class="n">K</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">];</span><span class="n">C23</span> <span class="o">=</span> <span class="n">K</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">];</span><span class="n">C24</span> <span class="o">=</span> <span class="n">K</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">];</span><span class="n">C25</span> <span class="o">=</span> <span class="n">K</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span><span class="p">];</span><span class="n">C26</span> <span class="o">=</span> <span class="n">K</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">5</span><span class="p">]</span>
        <span class="n">C33</span> <span class="o">=</span> <span class="n">K</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">];</span><span class="n">C34</span> <span class="o">=</span> <span class="n">K</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">];</span><span class="n">C35</span> <span class="o">=</span> <span class="n">K</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">4</span><span class="p">];</span><span class="n">C36</span> <span class="o">=</span> <span class="n">K</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">5</span><span class="p">]</span>
        <span class="n">C44</span> <span class="o">=</span> <span class="n">K</span><span class="p">[</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">];</span><span class="n">C45</span> <span class="o">=</span> <span class="n">K</span><span class="p">[</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">];</span><span class="n">C46</span> <span class="o">=</span> <span class="n">K</span><span class="p">[</span><span class="mi">3</span><span class="p">,</span><span class="mi">5</span><span class="p">]</span>
        <span class="n">C55</span> <span class="o">=</span> <span class="n">K</span><span class="p">[</span><span class="mi">4</span><span class="p">,</span><span class="mi">4</span><span class="p">];</span><span class="n">C56</span> <span class="o">=</span> <span class="n">K</span><span class="p">[</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">]</span>
        <span class="n">C66</span> <span class="o">=</span> <span class="n">K</span><span class="p">[</span><span class="mi">5</span><span class="p">,</span><span class="mi">5</span><span class="p">]</span>
        <span class="c"># Initialize the Element Stiffness Matrix</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Kel</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="n">C11</span><span class="o">/</span><span class="n">h</span><span class="p">,</span><span class="n">C12</span><span class="o">/</span><span class="n">h</span><span class="p">,</span><span class="n">C13</span><span class="o">/</span><span class="n">h</span><span class="p">,</span><span class="o">-</span><span class="n">C12</span><span class="o">/</span><span class="mi">2</span><span class="o">+</span><span class="n">C14</span><span class="o">/</span><span class="n">h</span><span class="p">,</span><span class="n">C11</span><span class="o">/</span><span class="mi">2</span><span class="o">+</span><span class="n">C15</span><span class="o">/</span><span class="n">h</span><span class="p">,</span><span class="n">C16</span><span class="o">/</span><span class="n">h</span><span class="p">,</span><span class="o">-</span><span class="n">C11</span><span class="o">/</span><span class="n">h</span><span class="p">,</span><span class="o">-</span><span class="n">C12</span><span class="o">/</span><span class="n">h</span><span class="p">,</span><span class="o">-</span><span class="n">C13</span><span class="o">/</span><span class="n">h</span><span class="p">,</span><span class="o">-</span><span class="n">C12</span><span class="o">/</span><span class="mi">2</span><span class="o">-</span><span class="n">C14</span><span class="o">/</span><span class="n">h</span><span class="p">,</span><span class="n">C11</span><span class="o">/</span><span class="mi">2</span><span class="o">-</span><span class="n">C15</span><span class="o">/</span><span class="n">h</span><span class="p">,</span><span class="o">-</span><span class="n">C16</span><span class="o">/</span><span class="n">h</span><span class="p">],</span>\
                          <span class="p">[</span><span class="n">C12</span><span class="o">/</span><span class="n">h</span><span class="p">,</span><span class="n">C22</span><span class="o">/</span><span class="n">h</span><span class="p">,</span><span class="n">C23</span><span class="o">/</span><span class="n">h</span><span class="p">,</span><span class="o">-</span><span class="n">C22</span><span class="o">/</span><span class="mi">2</span><span class="o">+</span><span class="n">C24</span><span class="o">/</span><span class="n">h</span><span class="p">,</span><span class="n">C12</span><span class="o">/</span><span class="mi">2</span><span class="o">+</span><span class="n">C25</span><span class="o">/</span><span class="n">h</span><span class="p">,</span><span class="n">C26</span><span class="o">/</span><span class="n">h</span><span class="p">,</span><span class="o">-</span><span class="n">C12</span><span class="o">/</span><span class="n">h</span><span class="p">,</span><span class="o">-</span><span class="n">C22</span><span class="o">/</span><span class="n">h</span><span class="p">,</span><span class="o">-</span><span class="n">C23</span><span class="o">/</span><span class="n">h</span><span class="p">,</span><span class="o">-</span><span class="n">C22</span><span class="o">/</span><span class="mi">2</span><span class="o">-</span><span class="n">C24</span><span class="o">/</span><span class="n">h</span><span class="p">,</span><span class="n">C12</span><span class="o">/</span><span class="mi">2</span><span class="o">-</span><span class="n">C25</span><span class="o">/</span><span class="n">h</span><span class="p">,</span><span class="o">-</span><span class="n">C26</span><span class="o">/</span><span class="n">h</span><span class="p">],</span>\
                          <span class="p">[</span><span class="n">C13</span><span class="o">/</span><span class="n">h</span><span class="p">,</span><span class="n">C23</span><span class="o">/</span><span class="n">h</span><span class="p">,</span><span class="n">C33</span><span class="o">/</span><span class="n">h</span><span class="p">,</span><span class="o">-</span><span class="n">C23</span><span class="o">/</span><span class="mi">2</span><span class="o">+</span><span class="n">C34</span><span class="o">/</span><span class="n">h</span><span class="p">,</span><span class="n">C13</span><span class="o">/</span><span class="mi">2</span><span class="o">+</span><span class="n">C35</span><span class="o">/</span><span class="n">h</span><span class="p">,</span><span class="n">C36</span><span class="o">/</span><span class="n">h</span><span class="p">,</span><span class="o">-</span><span class="n">C13</span><span class="o">/</span><span class="n">h</span><span class="p">,</span><span class="o">-</span><span class="n">C23</span><span class="o">/</span><span class="n">h</span><span class="p">,</span><span class="o">-</span><span class="n">C33</span><span class="o">/</span><span class="n">h</span><span class="p">,</span><span class="o">-</span><span class="n">C23</span><span class="o">/</span><span class="mi">2</span><span class="o">-</span><span class="n">C34</span><span class="o">/</span><span class="n">h</span><span class="p">,</span><span class="n">C13</span><span class="o">/</span><span class="mi">2</span><span class="o">-</span><span class="n">C35</span><span class="o">/</span><span class="n">h</span><span class="p">,</span><span class="o">-</span><span class="n">C36</span><span class="o">/</span><span class="n">h</span><span class="p">],</span>\
                          <span class="p">[</span><span class="o">-</span><span class="n">C12</span><span class="o">/</span><span class="mi">2</span><span class="o">+</span><span class="n">C14</span><span class="o">/</span><span class="n">h</span><span class="p">,</span><span class="o">-</span><span class="n">C22</span><span class="o">/</span><span class="mi">2</span><span class="o">+</span><span class="n">C24</span><span class="o">/</span><span class="n">h</span><span class="p">,</span><span class="o">-</span><span class="n">C23</span><span class="o">/</span><span class="mi">2</span><span class="o">+</span><span class="n">C34</span><span class="o">/</span><span class="n">h</span><span class="p">,</span><span class="o">-</span><span class="n">C24</span><span class="o">+</span><span class="n">C44</span><span class="o">/</span><span class="n">h</span><span class="o">+</span><span class="n">C22</span><span class="o">*</span><span class="n">h</span><span class="o">/</span><span class="mi">4</span><span class="p">,</span><span class="n">C14</span><span class="o">/</span><span class="mi">2</span><span class="o">-</span><span class="n">C25</span><span class="o">/</span><span class="mi">2</span><span class="o">+</span><span class="n">C45</span><span class="o">/</span><span class="n">h</span><span class="o">-</span><span class="n">C12</span><span class="o">*</span><span class="n">h</span><span class="o">/</span><span class="mi">4</span><span class="p">,</span><span class="o">-</span><span class="n">C26</span><span class="o">/</span><span class="mi">2</span><span class="o">+</span><span class="n">C46</span><span class="o">/</span><span class="n">h</span><span class="p">,</span><span class="n">C12</span><span class="o">/</span><span class="mi">2</span><span class="o">-</span><span class="n">C14</span><span class="o">/</span><span class="n">h</span><span class="p">,</span><span class="n">C22</span><span class="o">/</span><span class="mi">2</span><span class="o">-</span><span class="n">C24</span><span class="o">/</span><span class="n">h</span><span class="p">,</span><span class="n">C23</span><span class="o">/</span><span class="mi">2</span><span class="o">-</span><span class="n">C34</span><span class="o">/</span><span class="n">h</span><span class="p">,</span><span class="o">-</span><span class="n">C44</span><span class="o">/</span><span class="n">h</span><span class="o">+</span><span class="n">C22</span><span class="o">*</span><span class="n">h</span><span class="o">/</span><span class="mi">4</span><span class="p">,</span><span class="n">C14</span><span class="o">/</span><span class="mi">2</span><span class="o">+</span><span class="n">C25</span><span class="o">/</span><span class="mi">2</span><span class="o">-</span><span class="n">C45</span><span class="o">/</span><span class="n">h</span><span class="o">-</span><span class="n">C12</span><span class="o">*</span><span class="n">h</span><span class="o">/</span><span class="mi">4</span><span class="p">,</span><span class="n">C26</span><span class="o">/</span><span class="mi">2</span><span class="o">-</span><span class="n">C46</span><span class="o">/</span><span class="n">h</span><span class="p">],</span>\
                          <span class="p">[</span><span class="n">C11</span><span class="o">/</span><span class="mi">2</span><span class="o">+</span><span class="n">C15</span><span class="o">/</span><span class="n">h</span><span class="p">,</span><span class="n">C12</span><span class="o">/</span><span class="mi">2</span><span class="o">+</span><span class="n">C25</span><span class="o">/</span><span class="n">h</span><span class="p">,</span><span class="n">C13</span><span class="o">/</span><span class="mi">2</span><span class="o">+</span><span class="n">C35</span><span class="o">/</span><span class="n">h</span><span class="p">,</span><span class="n">C14</span><span class="o">/</span><span class="mi">2</span><span class="o">-</span><span class="n">C25</span><span class="o">/</span><span class="mi">2</span><span class="o">+</span><span class="n">C45</span><span class="o">/</span><span class="n">h</span><span class="o">-</span><span class="n">C12</span><span class="o">*</span><span class="n">h</span><span class="o">/</span><span class="mi">4</span><span class="p">,</span><span class="n">C15</span><span class="o">+</span><span class="n">C55</span><span class="o">/</span><span class="n">h</span><span class="o">+</span><span class="n">C11</span><span class="o">*</span><span class="n">h</span><span class="o">/</span><span class="mi">4</span><span class="p">,</span><span class="n">C16</span><span class="o">/</span><span class="mi">2</span><span class="o">+</span><span class="n">C56</span><span class="o">/</span><span class="n">h</span><span class="p">,</span><span class="o">-</span><span class="n">C11</span><span class="o">/</span><span class="mi">2</span><span class="o">-</span><span class="n">C15</span><span class="o">/</span><span class="n">h</span><span class="p">,</span><span class="o">-</span><span class="n">C12</span><span class="o">/</span><span class="mi">2</span><span class="o">-</span><span class="n">C25</span><span class="o">/</span><span class="n">h</span><span class="p">,</span><span class="o">-</span><span class="n">C13</span><span class="o">/</span><span class="mi">2</span><span class="o">-</span><span class="n">C35</span><span class="o">/</span><span class="n">h</span><span class="p">,</span><span class="o">-</span><span class="n">C14</span><span class="o">/</span><span class="mi">2</span><span class="o">-</span><span class="n">C25</span><span class="o">/</span><span class="mi">2</span><span class="o">-</span><span class="n">C45</span><span class="o">/</span><span class="n">h</span><span class="o">-</span><span class="n">C12</span><span class="o">*</span><span class="n">h</span><span class="o">/</span><span class="mi">4</span><span class="p">,</span><span class="o">-</span><span class="n">C55</span><span class="o">/</span><span class="n">h</span><span class="o">+</span><span class="n">C11</span><span class="o">*</span><span class="n">h</span><span class="o">/</span><span class="mi">4</span><span class="p">,</span><span class="o">-</span><span class="n">C16</span><span class="o">/</span><span class="mi">2</span><span class="o">-</span><span class="n">C56</span><span class="o">/</span><span class="n">h</span><span class="p">],</span>\
                          <span class="p">[</span><span class="n">C16</span><span class="o">/</span><span class="n">h</span><span class="p">,</span><span class="n">C26</span><span class="o">/</span><span class="n">h</span><span class="p">,</span><span class="n">C36</span><span class="o">/</span><span class="n">h</span><span class="p">,</span><span class="o">-</span><span class="n">C26</span><span class="o">/</span><span class="mi">2</span><span class="o">+</span><span class="n">C46</span><span class="o">/</span><span class="n">h</span><span class="p">,</span><span class="n">C16</span><span class="o">/</span><span class="mi">2</span><span class="o">+</span><span class="n">C56</span><span class="o">/</span><span class="n">h</span><span class="p">,</span><span class="n">C66</span><span class="o">/</span><span class="n">h</span><span class="p">,</span><span class="o">-</span><span class="n">C16</span><span class="o">/</span><span class="n">h</span><span class="p">,</span><span class="o">-</span><span class="n">C26</span><span class="o">/</span><span class="n">h</span><span class="p">,</span><span class="o">-</span><span class="n">C36</span><span class="o">/</span><span class="n">h</span><span class="p">,</span><span class="o">-</span><span class="n">C26</span><span class="o">/</span><span class="mi">2</span><span class="o">-</span><span class="n">C46</span><span class="o">/</span><span class="n">h</span><span class="p">,</span><span class="n">C16</span><span class="o">/</span><span class="mi">2</span><span class="o">-</span><span class="n">C56</span><span class="o">/</span><span class="n">h</span><span class="p">,</span><span class="o">-</span><span class="n">C66</span><span class="o">/</span><span class="n">h</span><span class="p">],</span>\
                          <span class="p">[</span><span class="o">-</span><span class="n">C11</span><span class="o">/</span><span class="n">h</span><span class="p">,</span><span class="o">-</span><span class="n">C12</span><span class="o">/</span><span class="n">h</span><span class="p">,</span><span class="o">-</span><span class="n">C13</span><span class="o">/</span><span class="n">h</span><span class="p">,</span><span class="n">C12</span><span class="o">/</span><span class="mi">2</span><span class="o">-</span><span class="n">C14</span><span class="o">/</span><span class="n">h</span><span class="p">,</span><span class="o">-</span><span class="n">C11</span><span class="o">/</span><span class="mi">2</span><span class="o">-</span><span class="n">C15</span><span class="o">/</span><span class="n">h</span><span class="p">,</span><span class="o">-</span><span class="n">C16</span><span class="o">/</span><span class="n">h</span><span class="p">,</span><span class="n">C11</span><span class="o">/</span><span class="n">h</span><span class="p">,</span><span class="n">C12</span><span class="o">/</span><span class="n">h</span><span class="p">,</span><span class="n">C13</span><span class="o">/</span><span class="n">h</span><span class="p">,</span><span class="n">C12</span><span class="o">/</span><span class="mi">2</span><span class="o">+</span><span class="n">C14</span><span class="o">/</span><span class="n">h</span><span class="p">,</span><span class="o">-</span><span class="n">C11</span><span class="o">/</span><span class="mi">2</span><span class="o">+</span><span class="n">C15</span><span class="o">/</span><span class="n">h</span><span class="p">,</span><span class="n">C16</span><span class="o">/</span><span class="n">h</span><span class="p">],</span>\
                          <span class="p">[</span><span class="o">-</span><span class="n">C12</span><span class="o">/</span><span class="n">h</span><span class="p">,</span><span class="o">-</span><span class="n">C22</span><span class="o">/</span><span class="n">h</span><span class="p">,</span><span class="o">-</span><span class="n">C23</span><span class="o">/</span><span class="n">h</span><span class="p">,</span><span class="n">C22</span><span class="o">/</span><span class="mi">2</span><span class="o">-</span><span class="n">C24</span><span class="o">/</span><span class="n">h</span><span class="p">,</span><span class="o">-</span><span class="n">C12</span><span class="o">/</span><span class="mi">2</span><span class="o">-</span><span class="n">C25</span><span class="o">/</span><span class="n">h</span><span class="p">,</span><span class="o">-</span><span class="n">C26</span><span class="o">/</span><span class="n">h</span><span class="p">,</span><span class="n">C12</span><span class="o">/</span><span class="n">h</span><span class="p">,</span><span class="n">C22</span><span class="o">/</span><span class="n">h</span><span class="p">,</span><span class="n">C23</span><span class="o">/</span><span class="n">h</span><span class="p">,</span><span class="n">C22</span><span class="o">/</span><span class="mi">2</span><span class="o">+</span><span class="n">C24</span><span class="o">/</span><span class="n">h</span><span class="p">,</span><span class="o">-</span><span class="n">C12</span><span class="o">/</span><span class="mi">2</span><span class="o">+</span><span class="n">C25</span><span class="o">/</span><span class="n">h</span><span class="p">,</span><span class="n">C26</span><span class="o">/</span><span class="n">h</span><span class="p">],</span>\
                          <span class="p">[</span><span class="o">-</span><span class="n">C13</span><span class="o">/</span><span class="n">h</span><span class="p">,</span><span class="o">-</span><span class="n">C23</span><span class="o">/</span><span class="n">h</span><span class="p">,</span><span class="o">-</span><span class="n">C33</span><span class="o">/</span><span class="n">h</span><span class="p">,</span><span class="n">C23</span><span class="o">/</span><span class="mi">2</span><span class="o">-</span><span class="n">C34</span><span class="o">/</span><span class="n">h</span><span class="p">,</span><span class="o">-</span><span class="n">C13</span><span class="o">/</span><span class="mi">2</span><span class="o">-</span><span class="n">C35</span><span class="o">/</span><span class="n">h</span><span class="p">,</span><span class="o">-</span><span class="n">C36</span><span class="o">/</span><span class="n">h</span><span class="p">,</span><span class="n">C13</span><span class="o">/</span><span class="n">h</span><span class="p">,</span><span class="n">C23</span><span class="o">/</span><span class="n">h</span><span class="p">,</span><span class="n">C33</span><span class="o">/</span><span class="n">h</span><span class="p">,</span><span class="n">C23</span><span class="o">/</span><span class="mi">2</span><span class="o">+</span><span class="n">C34</span><span class="o">/</span><span class="n">h</span><span class="p">,</span><span class="o">-</span><span class="n">C13</span><span class="o">/</span><span class="mi">2</span><span class="o">+</span><span class="n">C35</span><span class="o">/</span><span class="n">h</span><span class="p">,</span><span class="n">C36</span><span class="o">/</span><span class="n">h</span><span class="p">],</span>\
                          <span class="p">[</span><span class="o">-</span><span class="n">C12</span><span class="o">/</span><span class="mi">2</span><span class="o">-</span><span class="n">C14</span><span class="o">/</span><span class="n">h</span><span class="p">,</span><span class="o">-</span><span class="n">C22</span><span class="o">/</span><span class="mi">2</span><span class="o">-</span><span class="n">C24</span><span class="o">/</span><span class="n">h</span><span class="p">,</span><span class="o">-</span><span class="n">C23</span><span class="o">/</span><span class="mi">2</span><span class="o">-</span><span class="n">C34</span><span class="o">/</span><span class="n">h</span><span class="p">,</span><span class="o">-</span><span class="n">C44</span><span class="o">/</span><span class="n">h</span><span class="o">+</span><span class="n">C22</span><span class="o">*</span><span class="n">h</span><span class="o">/</span><span class="mi">4</span><span class="p">,</span><span class="o">-</span><span class="n">C14</span><span class="o">/</span><span class="mi">2</span><span class="o">-</span><span class="n">C25</span><span class="o">/</span><span class="mi">2</span><span class="o">-</span><span class="n">C45</span><span class="o">/</span><span class="n">h</span><span class="o">-</span><span class="n">C12</span><span class="o">*</span><span class="n">h</span><span class="o">/</span><span class="mi">4</span><span class="p">,</span><span class="o">-</span><span class="n">C26</span><span class="o">/</span><span class="mi">2</span><span class="o">-</span><span class="n">C46</span><span class="o">/</span><span class="n">h</span><span class="p">,</span><span class="n">C12</span><span class="o">/</span><span class="mi">2</span><span class="o">+</span><span class="n">C14</span><span class="o">/</span><span class="n">h</span><span class="p">,</span><span class="n">C22</span><span class="o">/</span><span class="mi">2</span><span class="o">+</span><span class="n">C24</span><span class="o">/</span><span class="n">h</span><span class="p">,</span><span class="n">C23</span><span class="o">/</span><span class="mi">2</span><span class="o">+</span><span class="n">C34</span><span class="o">/</span><span class="n">h</span><span class="p">,</span><span class="n">C24</span><span class="o">+</span><span class="n">C44</span><span class="o">/</span><span class="n">h</span><span class="o">+</span><span class="n">C22</span><span class="o">*</span><span class="n">h</span><span class="o">/</span><span class="mi">4</span><span class="p">,</span><span class="o">-</span><span class="n">C14</span><span class="o">/</span><span class="mi">2</span><span class="o">+</span><span class="n">C25</span><span class="o">/</span><span class="mi">2</span><span class="o">+</span><span class="n">C45</span><span class="o">/</span><span class="n">h</span><span class="o">-</span><span class="n">C12</span><span class="o">*</span><span class="n">h</span><span class="o">/</span><span class="mi">4</span><span class="p">,</span><span class="n">C26</span><span class="o">/</span><span class="mi">2</span><span class="o">+</span><span class="n">C46</span><span class="o">/</span><span class="n">h</span><span class="p">],</span>\
                          <span class="p">[</span><span class="n">C11</span><span class="o">/</span><span class="mi">2</span><span class="o">-</span><span class="n">C15</span><span class="o">/</span><span class="n">h</span><span class="p">,</span><span class="n">C12</span><span class="o">/</span><span class="mi">2</span><span class="o">-</span><span class="n">C25</span><span class="o">/</span><span class="n">h</span><span class="p">,</span><span class="n">C13</span><span class="o">/</span><span class="mi">2</span><span class="o">-</span><span class="n">C35</span><span class="o">/</span><span class="n">h</span><span class="p">,</span><span class="n">C14</span><span class="o">/</span><span class="mi">2</span><span class="o">+</span><span class="n">C25</span><span class="o">/</span><span class="mi">2</span><span class="o">-</span><span class="n">C45</span><span class="o">/</span><span class="n">h</span><span class="o">-</span><span class="n">C12</span><span class="o">*</span><span class="n">h</span><span class="o">/</span><span class="mi">4</span><span class="p">,</span><span class="o">-</span><span class="n">C55</span><span class="o">/</span><span class="n">h</span><span class="o">+</span><span class="n">C11</span><span class="o">*</span><span class="n">h</span><span class="o">/</span><span class="mi">4</span><span class="p">,</span><span class="n">C16</span><span class="o">/</span><span class="mi">2</span><span class="o">-</span><span class="n">C56</span><span class="o">/</span><span class="n">h</span><span class="p">,</span><span class="o">-</span><span class="n">C11</span><span class="o">/</span><span class="mi">2</span><span class="o">+</span><span class="n">C15</span><span class="o">/</span><span class="n">h</span><span class="p">,</span><span class="o">-</span><span class="n">C12</span><span class="o">/</span><span class="mi">2</span><span class="o">+</span><span class="n">C25</span><span class="o">/</span><span class="n">h</span><span class="p">,</span><span class="o">-</span><span class="n">C13</span><span class="o">/</span><span class="mi">2</span><span class="o">+</span><span class="n">C35</span><span class="o">/</span><span class="n">h</span><span class="p">,</span><span class="o">-</span><span class="n">C14</span><span class="o">/</span><span class="mi">2</span><span class="o">+</span><span class="n">C25</span><span class="o">/</span><span class="mi">2</span><span class="o">+</span><span class="n">C45</span><span class="o">/</span><span class="n">h</span><span class="o">-</span><span class="n">C12</span><span class="o">*</span><span class="n">h</span><span class="o">/</span><span class="mi">4</span><span class="p">,</span><span class="o">-</span><span class="n">C15</span><span class="o">+</span><span class="n">C55</span><span class="o">/</span><span class="n">h</span><span class="o">+</span><span class="n">C11</span><span class="o">*</span><span class="n">h</span><span class="o">/</span><span class="mi">4</span><span class="p">,</span><span class="o">-</span><span class="n">C16</span><span class="o">/</span><span class="mi">2</span><span class="o">+</span><span class="n">C56</span><span class="o">/</span><span class="n">h</span><span class="p">],</span>\
                          <span class="p">[</span><span class="o">-</span><span class="n">C16</span><span class="o">/</span><span class="n">h</span><span class="p">,</span><span class="o">-</span><span class="n">C26</span><span class="o">/</span><span class="n">h</span><span class="p">,</span><span class="o">-</span><span class="n">C36</span><span class="o">/</span><span class="n">h</span><span class="p">,</span><span class="n">C26</span><span class="o">/</span><span class="mi">2</span><span class="o">-</span><span class="n">C46</span><span class="o">/</span><span class="n">h</span><span class="p">,</span><span class="o">-</span><span class="n">C16</span><span class="o">/</span><span class="mi">2</span><span class="o">-</span><span class="n">C56</span><span class="o">/</span><span class="n">h</span><span class="p">,</span><span class="o">-</span><span class="n">C66</span><span class="o">/</span><span class="n">h</span><span class="p">,</span><span class="n">C16</span><span class="o">/</span><span class="n">h</span><span class="p">,</span><span class="n">C26</span><span class="o">/</span><span class="n">h</span><span class="p">,</span><span class="n">C36</span><span class="o">/</span><span class="n">h</span><span class="p">,</span><span class="n">C26</span><span class="o">/</span><span class="mi">2</span><span class="o">+</span><span class="n">C46</span><span class="o">/</span><span class="n">h</span><span class="p">,</span><span class="o">-</span><span class="n">C16</span><span class="o">/</span><span class="mi">2</span><span class="o">+</span><span class="n">C56</span><span class="o">/</span><span class="n">h</span><span class="p">,</span><span class="n">C66</span><span class="o">/</span><span class="n">h</span><span class="p">]])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Ke</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">T</span><span class="o">.</span><span class="n">T</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Kel</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">T</span><span class="p">))</span>
        <span class="c"># Initialize the element distributed load vector</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Fe</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">12</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
        <span class="c"># Initialize the Geometric Stiffness Matrix</span>
        <span class="n">kgtmp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">12</span><span class="p">,</span><span class="mi">12</span><span class="p">),</span><span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
        <span class="n">kgtmp</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">kgtmp</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">kgtmp</span><span class="p">[</span><span class="mi">6</span><span class="p">,</span><span class="mi">6</span><span class="p">]</span> <span class="o">=</span> <span class="n">kgtmp</span><span class="p">[</span><span class="mi">7</span><span class="p">,</span><span class="mi">7</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1.</span><span class="o">/</span><span class="n">h</span>
        <span class="n">kgtmp</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">6</span><span class="p">]</span> <span class="o">=</span> <span class="n">kgtmp</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">7</span><span class="p">]</span> <span class="o">=</span> <span class="n">kgtmp</span><span class="p">[</span><span class="mi">6</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">kgtmp</span><span class="p">[</span><span class="mi">7</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1.</span><span class="o">/</span><span class="n">h</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Kegl</span> <span class="o">=</span> <span class="n">kgtmp</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Keg</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">T</span><span class="o">.</span><span class="n">T</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Kegl</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">T</span><span class="p">))</span>
        <span class="c"># Initialize the mass matrix</span>
        <span class="c"># Create local reference of cross-section mass matrix</span>
        <span class="n">M</span> <span class="o">=</span> <span class="n">xsect</span><span class="o">.</span><span class="n">M</span>
        <span class="n">M11</span> <span class="o">=</span> <span class="n">M</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">M16</span> <span class="o">=</span> <span class="n">M</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">5</span><span class="p">]</span>
        <span class="n">M26</span> <span class="o">=</span> <span class="n">M</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">5</span><span class="p">]</span>
        <span class="n">M44</span> <span class="o">=</span> <span class="n">M</span><span class="p">[</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">]</span>
        <span class="n">M45</span> <span class="o">=</span> <span class="n">M</span><span class="p">[</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">]</span>
        <span class="n">M55</span> <span class="o">=</span> <span class="n">M</span><span class="p">[</span><span class="mi">4</span><span class="p">,</span><span class="mi">4</span><span class="p">]</span>
        <span class="n">M66</span> <span class="o">=</span> <span class="n">M</span><span class="p">[</span><span class="mi">5</span><span class="p">,</span><span class="mi">5</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Mel</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="n">h</span><span class="o">*</span><span class="n">M11</span><span class="o">/</span><span class="mf">3.</span><span class="p">,</span><span class="mf">0.</span><span class="p">,</span><span class="mf">0.</span><span class="p">,</span><span class="mf">0.</span><span class="p">,</span><span class="mf">0.</span><span class="p">,</span><span class="n">h</span><span class="o">*</span><span class="n">M16</span><span class="o">/</span><span class="mf">3.</span><span class="p">,</span><span class="n">h</span><span class="o">*</span><span class="n">M11</span><span class="o">/</span><span class="mf">6.</span><span class="p">,</span><span class="mf">0.</span><span class="p">,</span><span class="mf">0.</span><span class="p">,</span><span class="mf">0.</span><span class="p">,</span><span class="mf">0.</span><span class="p">,</span><span class="n">h</span><span class="o">*</span><span class="n">M16</span><span class="o">/</span><span class="mf">6.</span><span class="p">],</span>\
                            <span class="p">[</span><span class="mf">0.</span><span class="p">,</span><span class="n">h</span><span class="o">*</span><span class="n">M11</span><span class="o">/</span><span class="mf">3.</span><span class="p">,</span><span class="mf">0.</span><span class="p">,</span><span class="mf">0.</span><span class="p">,</span><span class="mf">0.</span><span class="p">,</span><span class="n">h</span><span class="o">*</span><span class="n">M26</span><span class="o">/</span><span class="mf">3.</span><span class="p">,</span><span class="mf">0.</span><span class="p">,</span><span class="n">h</span><span class="o">*</span><span class="n">M11</span><span class="o">/</span><span class="mf">6.</span><span class="p">,</span><span class="mf">0.</span><span class="p">,</span><span class="mf">0.</span><span class="p">,</span><span class="mf">0.</span><span class="p">,</span><span class="n">h</span><span class="o">*</span><span class="n">M26</span><span class="o">/</span><span class="mf">6.</span><span class="p">],</span>\
                            <span class="p">[</span><span class="mf">0.</span><span class="p">,</span><span class="mf">0.</span><span class="p">,</span><span class="n">h</span><span class="o">*</span><span class="n">M11</span><span class="o">/</span><span class="mf">3.</span><span class="p">,</span><span class="o">-</span><span class="n">h</span><span class="o">*</span><span class="n">M16</span><span class="o">/</span><span class="mf">3.</span><span class="p">,</span><span class="o">-</span><span class="n">h</span><span class="o">*</span><span class="n">M26</span><span class="o">/</span><span class="mf">3.</span><span class="p">,</span><span class="mf">0.</span><span class="p">,</span><span class="mf">0.</span><span class="p">,</span><span class="mf">0.</span><span class="p">,</span><span class="n">h</span><span class="o">*</span><span class="n">M11</span><span class="o">/</span><span class="mf">6.</span><span class="p">,</span><span class="o">-</span><span class="n">h</span><span class="o">*</span><span class="n">M16</span><span class="o">/</span><span class="mf">6.</span><span class="p">,</span><span class="o">-</span><span class="n">h</span><span class="o">*</span><span class="n">M26</span><span class="o">/</span><span class="mf">6.</span><span class="p">,</span><span class="mf">0.</span><span class="p">],</span>\
                            <span class="p">[</span><span class="mf">0.</span><span class="p">,</span><span class="mf">0.</span><span class="p">,</span><span class="o">-</span><span class="n">h</span><span class="o">*</span><span class="n">M16</span><span class="o">/</span><span class="mf">3.</span><span class="p">,</span><span class="n">h</span><span class="o">*</span><span class="n">M44</span><span class="o">/</span><span class="mf">3.</span><span class="p">,</span><span class="n">h</span><span class="o">*</span><span class="n">M45</span><span class="o">/</span><span class="mf">3.</span><span class="p">,</span><span class="mf">0.</span><span class="p">,</span><span class="mf">0.</span><span class="p">,</span><span class="mf">0.</span><span class="p">,</span><span class="o">-</span><span class="n">h</span><span class="o">*</span><span class="n">M16</span><span class="o">/</span><span class="mf">6.</span><span class="p">,</span><span class="n">h</span><span class="o">*</span><span class="n">M44</span><span class="o">/</span><span class="mf">6.</span><span class="p">,</span><span class="n">h</span><span class="o">*</span><span class="n">M45</span><span class="o">/</span><span class="mf">6.</span><span class="p">,</span><span class="mf">0.</span><span class="p">],</span>\
                            <span class="p">[</span><span class="mf">0.</span><span class="p">,</span><span class="mf">0.</span><span class="p">,</span><span class="o">-</span><span class="n">h</span><span class="o">*</span><span class="n">M26</span><span class="o">/</span><span class="mf">3.</span><span class="p">,</span><span class="n">h</span><span class="o">*</span><span class="n">M45</span><span class="o">/</span><span class="mf">3.</span><span class="p">,</span><span class="n">h</span><span class="o">*</span><span class="n">M55</span><span class="o">/</span><span class="mf">3.</span><span class="p">,</span><span class="mf">0.</span><span class="p">,</span><span class="mf">0.</span><span class="p">,</span><span class="mf">0.</span><span class="p">,</span><span class="o">-</span><span class="n">h</span><span class="o">*</span><span class="n">M26</span><span class="o">/</span><span class="mf">6.</span><span class="p">,</span><span class="n">h</span><span class="o">*</span><span class="n">M45</span><span class="o">/</span><span class="mf">6.</span><span class="p">,</span><span class="n">h</span><span class="o">*</span><span class="n">M55</span><span class="o">/</span><span class="mf">6.</span><span class="p">,</span><span class="mf">0.</span><span class="p">],</span>\
                            <span class="p">[</span><span class="n">h</span><span class="o">*</span><span class="n">M16</span><span class="o">/</span><span class="mf">3.</span><span class="p">,</span><span class="n">h</span><span class="o">*</span><span class="n">M26</span><span class="o">/</span><span class="mf">3.</span><span class="p">,</span><span class="mf">0.</span><span class="p">,</span><span class="mf">0.</span><span class="p">,</span><span class="mf">0.</span><span class="p">,</span><span class="n">h</span><span class="o">*</span><span class="n">M66</span><span class="o">/</span><span class="mf">3.</span><span class="p">,</span><span class="n">h</span><span class="o">*</span><span class="n">M16</span><span class="o">/</span><span class="mf">6.</span><span class="p">,</span><span class="n">h</span><span class="o">*</span><span class="n">M26</span><span class="o">/</span><span class="mf">6.</span><span class="p">,</span><span class="mf">0.</span><span class="p">,</span><span class="mf">0.</span><span class="p">,</span><span class="mf">0.</span><span class="p">,</span><span class="n">h</span><span class="o">*</span><span class="n">M66</span><span class="o">/</span><span class="mf">6.</span><span class="p">],</span>\
                            <span class="p">[</span><span class="n">h</span><span class="o">*</span><span class="n">M11</span><span class="o">/</span><span class="mf">6.</span><span class="p">,</span><span class="mf">0.</span><span class="p">,</span><span class="mf">0.</span><span class="p">,</span><span class="mf">0.</span><span class="p">,</span><span class="mf">0.</span><span class="p">,</span><span class="n">h</span><span class="o">*</span><span class="n">M16</span><span class="o">/</span><span class="mf">6.</span><span class="p">,</span><span class="n">h</span><span class="o">*</span><span class="n">M11</span><span class="o">/</span><span class="mf">3.</span><span class="p">,</span><span class="mf">0.</span><span class="p">,</span><span class="mf">0.</span><span class="p">,</span><span class="mf">0.</span><span class="p">,</span><span class="mf">0.</span><span class="p">,</span><span class="n">h</span><span class="o">*</span><span class="n">M16</span><span class="o">/</span><span class="mf">6.</span><span class="p">],</span>\
                            <span class="p">[</span><span class="mf">0.</span><span class="p">,</span><span class="n">h</span><span class="o">*</span><span class="n">M11</span><span class="o">/</span><span class="mf">6.</span><span class="p">,</span><span class="mf">0.</span><span class="p">,</span><span class="mf">0.</span><span class="p">,</span><span class="mf">0.</span><span class="p">,</span><span class="n">h</span><span class="o">*</span><span class="n">M26</span><span class="o">/</span><span class="mf">6.</span><span class="p">,</span><span class="mf">0.</span><span class="p">,</span><span class="n">h</span><span class="o">*</span><span class="n">M11</span><span class="o">/</span><span class="mf">3.</span><span class="p">,</span><span class="mf">0.</span><span class="p">,</span><span class="mf">0.</span><span class="p">,</span><span class="mf">0.</span><span class="p">,</span><span class="n">h</span><span class="o">*</span><span class="n">M26</span><span class="o">/</span><span class="mf">3.</span><span class="p">],</span>\
                            <span class="p">[</span><span class="mf">0.</span><span class="p">,</span><span class="mf">0.</span><span class="p">,</span><span class="n">h</span><span class="o">*</span><span class="n">M11</span><span class="o">/</span><span class="mf">6.</span><span class="p">,</span><span class="o">-</span><span class="n">h</span><span class="o">*</span><span class="n">M16</span><span class="o">/</span><span class="mf">6.</span><span class="p">,</span><span class="o">-</span><span class="n">h</span><span class="o">*</span><span class="n">M26</span><span class="o">/</span><span class="mf">6.</span><span class="p">,</span><span class="mf">0.</span><span class="p">,</span><span class="mf">0.</span><span class="p">,</span><span class="mf">0.</span><span class="p">,</span><span class="n">h</span><span class="o">*</span><span class="n">M11</span><span class="o">/</span><span class="mf">3.</span><span class="p">,</span><span class="o">-</span><span class="n">h</span><span class="o">*</span><span class="n">M16</span><span class="o">/</span><span class="mf">3.</span><span class="p">,</span><span class="o">-</span><span class="n">h</span><span class="o">*</span><span class="n">M26</span><span class="o">/</span><span class="mf">3.</span><span class="p">,</span><span class="mf">0.</span><span class="p">],</span>\
                            <span class="p">[</span><span class="mf">0.</span><span class="p">,</span><span class="mf">0.</span><span class="p">,</span><span class="o">-</span><span class="n">h</span><span class="o">*</span><span class="n">M16</span><span class="o">/</span><span class="mf">6.</span><span class="p">,</span><span class="n">h</span><span class="o">*</span><span class="n">M44</span><span class="o">/</span><span class="mf">6.</span><span class="p">,</span><span class="n">h</span><span class="o">*</span><span class="n">M45</span><span class="o">/</span><span class="mf">6.</span><span class="p">,</span><span class="mf">0.</span><span class="p">,</span><span class="mf">0.</span><span class="p">,</span><span class="mf">0.</span><span class="p">,</span><span class="o">-</span><span class="n">h</span><span class="o">*</span><span class="n">M16</span><span class="o">/</span><span class="mf">3.</span><span class="p">,</span><span class="n">h</span><span class="o">*</span><span class="n">M44</span><span class="o">/</span><span class="mf">3.</span><span class="p">,</span><span class="n">h</span><span class="o">*</span><span class="n">M45</span><span class="o">/</span><span class="mf">3.</span><span class="p">,</span><span class="mf">0.</span><span class="p">],</span>\
                            <span class="p">[</span><span class="mf">0.</span><span class="p">,</span><span class="mf">0.</span><span class="p">,</span><span class="o">-</span><span class="n">h</span><span class="o">*</span><span class="n">M26</span><span class="o">/</span><span class="mf">6.</span><span class="p">,</span><span class="n">h</span><span class="o">*</span><span class="n">M45</span><span class="o">/</span><span class="mf">6.</span><span class="p">,</span><span class="n">h</span><span class="o">*</span><span class="n">M55</span><span class="o">/</span><span class="mf">6.</span><span class="p">,</span><span class="mf">0.</span><span class="p">,</span><span class="mf">0.</span><span class="p">,</span><span class="mf">0.</span><span class="p">,</span><span class="o">-</span><span class="n">h</span><span class="o">*</span><span class="n">M26</span><span class="o">/</span><span class="mf">3.</span><span class="p">,</span><span class="n">h</span><span class="o">*</span><span class="n">M45</span><span class="o">/</span><span class="mf">3.</span><span class="p">,</span><span class="n">h</span><span class="o">*</span><span class="n">M55</span><span class="o">/</span><span class="mf">3.</span><span class="p">,</span><span class="mf">0.</span><span class="p">],</span>\
                            <span class="p">[</span><span class="n">h</span><span class="o">*</span><span class="n">M16</span><span class="o">/</span><span class="mf">6.</span><span class="p">,</span><span class="n">h</span><span class="o">*</span><span class="n">M26</span><span class="o">/</span><span class="mf">6.</span><span class="p">,</span><span class="mf">0.</span><span class="p">,</span><span class="mf">0.</span><span class="p">,</span><span class="mf">0.</span><span class="p">,</span><span class="n">h</span><span class="o">*</span><span class="n">M66</span><span class="o">/</span><span class="mf">6.</span><span class="p">,</span><span class="n">h</span><span class="o">*</span><span class="n">M16</span><span class="o">/</span><span class="mf">3.</span><span class="p">,</span><span class="n">h</span><span class="o">*</span><span class="n">M26</span><span class="o">/</span><span class="mf">3.</span><span class="p">,</span><span class="mf">0.</span><span class="p">,</span><span class="mf">0.</span><span class="p">,</span><span class="mf">0.</span><span class="p">,</span><span class="n">h</span><span class="o">*</span><span class="n">M66</span><span class="o">/</span><span class="mf">3.</span><span class="p">]])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Me</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">T</span><span class="o">.</span><span class="n">T</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Mel</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">T</span><span class="p">))</span></div>
    <span class="k">def</span> <span class="nf">applyDistributedLoad</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">fx</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Applies distributed load to the element.</span>
<span class="sd">        </span>
<span class="sd">        Intended primarily as a private method but left public, this method,</span>
<span class="sd">        applies a distributed load to the finite element. Due to the nature of</span>
<span class="sd">        the timoshenko beam, you cannot apply a distributed moment, however you</span>
<span class="sd">        can apply distributed forces.</span>
<span class="sd">        </span>
<span class="sd">        :Args:</span>
<span class="sd">        </span>
<span class="sd">        - `fx (1x6 np.array[float])`: The constant distributed load applied</span>
<span class="sd">            over the length of the beam.</span>
<span class="sd">            </span>
<span class="sd">        :Returns:</span>
<span class="sd">        </span>
<span class="sd">        - None</span>
<span class="sd">            </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">h</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">h</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Fe</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">h</span><span class="o">*</span><span class="n">fx</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span><span class="n">h</span><span class="o">*</span><span class="n">fx</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span>\
                            <span class="n">h</span><span class="o">*</span><span class="n">fx</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span><span class="n">h</span><span class="o">*</span><span class="n">fx</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span><span class="n">h</span><span class="o">*</span><span class="n">fx</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span><span class="n">h</span><span class="o">*</span><span class="n">fx</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span>\
                            <span class="n">h</span><span class="o">*</span><span class="n">fx</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span><span class="n">h</span><span class="o">*</span><span class="n">fx</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span><span class="n">h</span><span class="o">*</span><span class="n">fx</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span><span class="n">h</span><span class="o">*</span><span class="n">fx</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span><span class="n">h</span><span class="o">*</span><span class="n">fx</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span>\
                            <span class="n">h</span><span class="o">*</span><span class="n">fx</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span><span class="o">/</span><span class="mi">2</span><span class="p">]),(</span><span class="mi">12</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span>
<div class="viewcode-block" id="TBeam.plotRigidBeam"><a class="viewcode-back" href="../../structures.html#AeroComBAT.Structures.TBeam.plotRigidBeam">[docs]</a>    <span class="k">def</span> <span class="nf">plotRigidBeam</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Plots the rigid beam in 3D space.</span>
<span class="sd">        </span>
<span class="sd">        This method plots the beam finite element in 3D space. It is not</span>
<span class="sd">        typically called by the beam object but by a SuperBeam object or</span>
<span class="sd">        even a WingSection object.</span>
<span class="sd">        </span>
<span class="sd">        :Args:</span>
<span class="sd">        </span>
<span class="sd">        - `environment (str)`: Determines what environment is to be used to</span>
<span class="sd">            plot the beam in 3D space. Currently only mayavi is supported.</span>
<span class="sd">        - `figName (str)`: The name of the figure in which the beam will apear.</span>
<span class="sd">        - `clr (1x3 touple(float))`: This touple contains three floats running</span>
<span class="sd">            from 0 to 1 in order to generate a color mayavi can plot.</span>
<span class="sd">                </span>
<span class="sd">        :Returns:</span>
<span class="sd">        </span>
<span class="sd">        - `(fig)`: The mayavi figure of the beam.</span>
<span class="sd">        </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c"># Select the plotting environment you&#39;d like to choose</span>
        <span class="n">environment</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s">&#39;environment&#39;</span><span class="p">,</span><span class="s">&#39;mayavi&#39;</span><span class="p">)</span>
        <span class="c"># Initialize the name of the figure</span>
        <span class="n">figName</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s">&#39;figName&#39;</span><span class="p">,</span><span class="s">&#39;Figure&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">()</span><span class="o">*</span><span class="mi">100</span><span class="p">)))</span>
        <span class="c"># Initialize the figure for plotting</span>
        <span class="n">mlab</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figure</span><span class="o">=</span><span class="n">figName</span><span class="p">)</span>
        <span class="c"># Chose the color of the beam, defaults to black, accepts tuple</span>
        <span class="n">clr</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s">&#39;clr&#39;</span><span class="p">,(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(),</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(),</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">()))</span>
        <span class="c"># Determine the rigid coordiates of the beam</span>
        <span class="n">x1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">n1</span><span class="o">.</span><span class="n">x</span>
        <span class="n">x2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">n2</span><span class="o">.</span><span class="n">x</span>
        <span class="c"># Determine the tube radius:</span>
        <span class="n">tube_radius</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">([</span><span class="n">x2</span><span class="o">-</span><span class="n">x1</span><span class="p">])</span><span class="o">/</span><span class="mi">4</span>
        <span class="c"># Create arrays of the coordinates for mayavi to plot</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">x1</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">x2</span><span class="p">[</span><span class="mi">0</span><span class="p">]])</span>
        <span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">x1</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">x2</span><span class="p">[</span><span class="mi">1</span><span class="p">]])</span>
        <span class="n">z</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">x1</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span><span class="n">x2</span><span class="p">[</span><span class="mi">2</span><span class="p">]])</span>
        <span class="c"># Plot the beam</span>
        <span class="k">if</span> <span class="n">environment</span><span class="o">==</span><span class="s">&#39;mayavi&#39;</span><span class="p">:</span>
            <span class="n">mlab</span><span class="o">.</span><span class="n">plot3d</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="n">clr</span><span class="p">,</span><span class="n">tube_radius</span><span class="o">=</span><span class="n">tube_radius</span><span class="p">)</span></div>
    <span class="k">def</span> <span class="nf">saveNodalDispl</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">U1</span><span class="p">,</span><span class="n">U2</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Saves applied displacements and rotations solutions if the beam.</span>
<span class="sd">        </span>
<span class="sd">        Intended primarily as a private method but left public, this method,</span>
<span class="sd">        save the solutions of the displacements and rotations of the beam in</span>
<span class="sd">        the U1 and U2 dictionary attributes. This method also calculates the</span>
<span class="sd">        internal forces and moments experienced by the beam under the U1 and U2</span>
<span class="sd">        displacements.</span>
<span class="sd">        </span>
<span class="sd">        :Args:</span>
<span class="sd">        </span>
<span class="sd">        - `U1 (MxN np.array[float])`: If N=1, this are the displacements and</span>
<span class="sd">            rotations of an analysis at the first node. Otherwise, this</span>
<span class="sd">            corresponds to the eigenvector displacements and rotations</span>
<span class="sd">            at the first node.</span>
<span class="sd">        - `U2 (MxN np.array[float])`: If N=1, this are the displacements and</span>
<span class="sd">            rotations of an analysis at the second node. Otherwise, this</span>
<span class="sd">            corresponds to the eigenvector displacements and rotations</span>
<span class="sd">            at the second node.</span>
<span class="sd">        - `analysis_name (str)`: The string of the analysis correpsonding to</span>
<span class="sd">            the displacement and rotation solution vector.</span>
<span class="sd">                </span>
<span class="sd">        :Returns:</span>
<span class="sd">        </span>
<span class="sd">        - None</span>
<span class="sd">        </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c"># Initialize the analysis name for the analysis set</span>
        <span class="n">analysis_name</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s">&#39;analysis_name&#39;</span><span class="p">,</span><span class="s">&#39;analysis_untitled&#39;</span><span class="p">)</span>
        <span class="c"># Check to see if modal displacements and rotations are being saved</span>
        <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">size</span><span class="p">(</span><span class="n">U1</span><span class="p">,</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">==</span><span class="mi">1</span><span class="p">:</span>
            <span class="c"># Save the nodal displacements for plotting purposes:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">U1</span><span class="p">[</span><span class="n">analysis_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">U1</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">U2</span><span class="p">[</span><span class="n">analysis_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">U2</span>
            <span class="n">tmpdisp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">((</span><span class="n">U1</span><span class="p">,</span><span class="n">U2</span><span class="p">))</span>
            <span class="c"># Solve and save the beam internal forces and moments</span>
            <span class="n">Ktop</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Ke</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">6</span><span class="p">,:]</span>
            <span class="n">Kbot</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Ke</span><span class="p">[</span><span class="mi">6</span><span class="p">:,:]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">F1</span><span class="p">[</span><span class="n">analysis_name</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">Ktop</span><span class="p">,</span><span class="n">tmpdisp</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">F2</span><span class="p">[</span><span class="n">analysis_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">Kbot</span><span class="p">,</span><span class="n">tmpdisp</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c"># Save the nodal displacements for plotting purposes:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">Umode1</span><span class="p">[</span><span class="n">analysis_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">U1</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">Umode2</span><span class="p">[</span><span class="n">analysis_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">U2</span>
            <span class="n">tmpdisp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">((</span><span class="n">U1</span><span class="p">,</span><span class="n">U2</span><span class="p">))</span>
            <span class="c"># Solve and save the beam internal forces and moments</span>
            <span class="n">Ktop</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Ke</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">6</span><span class="p">,:]</span>
            <span class="n">Kbot</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Ke</span><span class="p">[</span><span class="mi">6</span><span class="p">:,:]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">Fmode1</span><span class="p">[</span><span class="n">analysis_name</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">Ktop</span><span class="p">,</span><span class="n">tmpdisp</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">Fmode2</span><span class="p">[</span><span class="n">analysis_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">Kbot</span><span class="p">,</span><span class="n">tmpdisp</span><span class="p">)</span>
        <span class="c"># Save analysis name in the analysis_names attribute</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">analysis_names</span><span class="o">+=</span><span class="p">[</span><span class="n">analysis_name</span><span class="p">]</span>
<div class="viewcode-block" id="TBeam.plotDisplBeam"><a class="viewcode-back" href="../../structures.html#AeroComBAT.Structures.TBeam.plotDisplBeam">[docs]</a>    <span class="k">def</span> <span class="nf">plotDisplBeam</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Plots the displaced beam in 3D space.</span>
<span class="sd">        </span>
<span class="sd">        This method plots the deformed beam finite element in 3D space. It is</span>
<span class="sd">        not typically called by the beam object but by a SuperBeam object</span>
<span class="sd">        or even a WingSection object.</span>
<span class="sd">        </span>
<span class="sd">        :Args:</span>
<span class="sd">        </span>
<span class="sd">        - `environment (str)`: Determines what environment is to be used to</span>
<span class="sd">            plot the beam in 3D space. Currently only mayavi is supported.</span>
<span class="sd">        - `figName (str)`: The name of the figure in which the beam will apear.</span>
<span class="sd">        - `clr (1x3 touple(float))`: This touple contains three floats running</span>
<span class="sd">            from 0 to 1 in order to generate a color mayavi can plot.</span>
<span class="sd">        - `displScale (float)`: The scaling factor for the deformation</span>
<span class="sd">            experienced by the beam.</span>
<span class="sd">        - `mode (int)`: Determines what mode to plot. By default the mode is 0</span>
<span class="sd">            implying a non-eigenvalue solution should be plotted.</span>
<span class="sd">                </span>
<span class="sd">        :Returns:</span>
<span class="sd">        </span>
<span class="sd">        - `(fig)`: The mayavi figure of the beam.</span>
<span class="sd">        </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">analysis_name</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s">&#39;analysis_name&#39;</span><span class="p">,</span><span class="s">&#39;analysis_untitled&#39;</span><span class="p">)</span>
        <span class="c"># Select the plotting environment you&#39;d like to choose</span>
        <span class="n">environment</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s">&#39;environment&#39;</span><span class="p">,</span><span class="s">&#39;mayavi&#39;</span><span class="p">)</span>
        <span class="n">figName</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s">&#39;figName&#39;</span><span class="p">,</span><span class="s">&#39;Figure&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">()</span><span class="o">*</span><span class="mi">100</span><span class="p">)))</span>
        <span class="n">mlab</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figure</span><span class="o">=</span><span class="n">figName</span><span class="p">)</span>
        <span class="c"># Chose the color of the beam, defaults to black, accepts tuple</span>
        <span class="n">clr</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s">&#39;clr&#39;</span><span class="p">,</span><span class="nb">tuple</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">3</span><span class="p">)))</span>
        <span class="c"># Establish Beam displacement scaling</span>
        <span class="n">displScale</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s">&#39;displScale&#39;</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
        <span class="c"># Determine what mode to plot:</span>
        <span class="n">mode</span><span class="o">=</span><span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s">&#39;mode&#39;</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
        <span class="n">plots</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s">&#39;plots&#39;</span><span class="p">,[])</span>
        <span class="n">x1r</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">n1</span><span class="o">.</span><span class="n">x</span>
        <span class="n">x2r</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">n2</span><span class="o">.</span><span class="n">x</span>
        <span class="c"># Determine the tube radius:</span>
        <span class="n">tube_radius</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">([</span><span class="n">x2r</span><span class="o">-</span><span class="n">x1r</span><span class="p">])</span><span class="o">/</span><span class="mi">4</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">analysis_name</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">F1</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">Fmode1</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span>
            <span class="k">print</span><span class="p">(</span><span class="s">&#39;Warning, the analysis name for the results you are trying&#39;</span><span class="o">+</span>
            <span class="s">&#39;to plot does not exist. The rigid beam will instead be plotted&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">plotRigidBeam</span><span class="p">(</span><span class="n">environment</span><span class="o">=</span><span class="n">environment</span><span class="p">,</span><span class="n">clr</span><span class="o">=</span><span class="n">clr</span><span class="p">,</span><span class="n">figName</span><span class="o">=</span><span class="n">figName</span>\
                <span class="p">,</span><span class="n">tube_radius</span><span class="o">=</span><span class="n">tube_radius</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">mode</span><span class="p">:</span>
                <span class="n">x1disp</span> <span class="o">=</span> <span class="n">displScale</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">Umode1</span><span class="p">[</span><span class="n">analysis_name</span><span class="p">][:,</span><span class="n">mode</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
                <span class="n">x1disp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">x1disp</span><span class="p">,(</span><span class="mi">6</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span>
                <span class="n">x2disp</span> <span class="o">=</span> <span class="n">displScale</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">Umode2</span><span class="p">[</span><span class="n">analysis_name</span><span class="p">][:,</span><span class="n">mode</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
                <span class="n">x2disp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">x2disp</span><span class="p">,(</span><span class="mi">6</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">x1disp</span> <span class="o">=</span> <span class="n">displScale</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">U1</span><span class="p">[</span><span class="n">analysis_name</span><span class="p">]</span>
                <span class="n">x2disp</span> <span class="o">=</span> <span class="n">displScale</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">U2</span><span class="p">[</span><span class="n">analysis_name</span><span class="p">]</span>
            <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">x1r</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="n">x1disp</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">x2r</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="n">x2disp</span><span class="p">[</span><span class="mi">0</span><span class="p">]])</span>
            <span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">x1r</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="n">x1disp</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">x2r</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="n">x2disp</span><span class="p">[</span><span class="mi">1</span><span class="p">]])</span>
            <span class="n">z</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">x1r</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">+</span><span class="n">x1disp</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span><span class="n">x2r</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">+</span><span class="n">x2disp</span><span class="p">[</span><span class="mi">2</span><span class="p">]])</span>
            <span class="k">if</span> <span class="n">environment</span><span class="o">==</span><span class="s">&#39;mayavi&#39;</span><span class="p">:</span>
                <span class="n">line</span> <span class="o">=</span> <span class="n">mlab</span><span class="o">.</span><span class="n">plot3d</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="n">clr</span><span class="p">,</span><span class="n">tube_radius</span><span class="o">=</span><span class="n">tube_radius</span><span class="p">)</span>
                <span class="n">plots</span> <span class="o">+=</span> <span class="p">[</span><span class="n">line</span><span class="p">]</span></div>
<div class="viewcode-block" id="TBeam.printInternalForce"><a class="viewcode-back" href="../../structures.html#AeroComBAT.Structures.TBeam.printInternalForce">[docs]</a>    <span class="k">def</span> <span class="nf">printInternalForce</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Prints the internal forces and moments in the beam.</span>
<span class="sd">        </span>
<span class="sd">        For a particular analysis set, this method prints out the force and</span>
<span class="sd">        moment resultants at both nodes of the beam.</span>
<span class="sd">        </span>
<span class="sd">        :Args:</span>
<span class="sd">        </span>
<span class="sd">        - `analysis_name (str)`: The analysis name for which the forces are</span>
<span class="sd">            being surveyed.</span>
<span class="sd">            </span>
<span class="sd">        :Returns:</span>
<span class="sd">        </span>
<span class="sd">        - `(str)`: This is a print out of the internal forces and moments</span>
<span class="sd">            within the beam element.</span>
<span class="sd">            </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">analysis_name</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s">&#39;analysis_name&#39;</span><span class="p">,</span><span class="s">&#39;analysis_untitled&#39;</span><span class="p">)</span>
        <span class="n">F1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">F1</span><span class="p">[</span><span class="n">analysis_name</span><span class="p">]</span>
        <span class="n">F2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">F2</span><span class="p">[</span><span class="n">analysis_name</span><span class="p">]</span>
        <span class="n">headers</span> <span class="o">=</span> <span class="p">(</span><span class="s">&#39;Fx&#39;</span><span class="p">,</span><span class="s">&#39;Fy&#39;</span><span class="p">,</span><span class="s">&#39;Fz&#39;</span><span class="p">,</span><span class="s">&#39;My&#39;</span><span class="p">,</span><span class="s">&#39;Mx&#39;</span><span class="p">,</span><span class="s">&#39;Mz&#39;</span><span class="p">)</span>
        <span class="k">print</span><span class="p">(</span><span class="s">&#39;Beam </span><span class="si">%05d</span><span class="s">, type=</span><span class="si">%s</span><span class="s">&#39;</span> <span class="o">%</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">EID</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">type</span><span class="p">))</span>
        <span class="k">print</span><span class="p">(</span><span class="s">&#39;Forces at first node:&#39;</span><span class="p">)</span>
        <span class="k">print</span><span class="p">(</span><span class="n">tabulate</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">around</span><span class="p">(</span><span class="n">F1</span><span class="p">,</span><span class="n">decimals</span><span class="o">=</span><span class="mi">1</span><span class="p">)),</span><span class="n">headers</span><span class="p">,</span><span class="n">tablefmt</span><span class="o">=</span><span class="s">&quot;fancy_grid&quot;</span><span class="p">))</span>
        <span class="k">print</span><span class="p">(</span><span class="s">&#39;Forces at second node:&#39;</span><span class="p">)</span>
        <span class="k">print</span><span class="p">(</span><span class="n">tabulate</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">around</span><span class="p">(</span><span class="n">F2</span><span class="p">,</span><span class="n">decimals</span><span class="o">=</span><span class="mi">1</span><span class="p">)),</span><span class="n">headers</span><span class="p">,</span><span class="n">tablefmt</span><span class="o">=</span><span class="s">&quot;fancy_grid&quot;</span><span class="p">))</span></div>
    <span class="k">def</span> <span class="nf">plotWarpedXSect</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Plots a warped cross-section anywhere in a beam element.</span>
<span class="sd">        </span>
<span class="sd">        Intended primarily as a private method but left public, this method</span>
<span class="sd">        calculates the displacements and rotations as well as the force and</span>
<span class="sd">        moment resultants at any location within the beam. Once calculated,</span>
<span class="sd">        this method calls the beam&#39;s cross-section method calcWarpEffects to</span>
<span class="sd">        save the warping displacements, strains and stresses, and then calls</span>
<span class="sd">        the plotWarped method to plot those warping displacements, strains and</span>
<span class="sd">        stresses.</span>
<span class="sd">        </span>
<span class="sd">        :Args:</span>
<span class="sd">        </span>
<span class="sd">        - `x (float)`: The non-dimensional loation within the beam.</span>
<span class="sd">        - `figName (str)`: The string name of the figure</span>
<span class="sd">        - `contour (str)`: The contour to be plotted on the cross-section.  By</span>
<span class="sd">            default the Von Mises stress is returned. Currently supported</span>
<span class="sd">            options include: Von Mises (&#39;VonMis&#39;), maximum principle stress</span>
<span class="sd">            (&#39;MaxPrin&#39;), the minimum principle stress (&#39;MinPrin&#39;), and the</span>
<span class="sd">            local cross-section stress states &#39;sig_xx&#39; where the subindeces can</span>
<span class="sd">            go from 1-3. The keyword &#39;none&#39; is also an option.</span>
<span class="sd">        - `contLim (1x2 array[float])`: The lower and upper limits of the</span>
<span class="sd">            contour scale.</span>
<span class="sd">        - `warpScale (float)`: The scaling factor applied to all warping</span>
<span class="sd">            displacements within the cross-section.</span>
<span class="sd">        - `displScale (float)`: The scaling factor applied to all beam</span>
<span class="sd">            displacements and rotations.</span>
<span class="sd">        - `analysis_name (str)`: The string identifier associated with the</span>
<span class="sd">            analysis results being plotted.</span>
<span class="sd">        - `mode (int)`: Determines what mode to plot. By default the mode is 0</span>
<span class="sd">            implying a non-eigenvalue solution should be plotted.</span>
<span class="sd">            </span>
<span class="sd">        :Returns:</span>
<span class="sd">        </span>
<span class="sd">        - None</span>
<span class="sd">        </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s">&#39;x&#39;</span><span class="p">,</span><span class="mf">0.</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">x</span><span class="o">&gt;</span><span class="mf">1.</span> <span class="ow">or</span> <span class="n">x</span><span class="o">&lt;</span><span class="mf">0.</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s">&#39;The non-dimensional position &quot;x&quot; within the &#39;</span>\
                <span class="s">&#39;element must be between 0. and 1.&#39;</span><span class="p">)</span>
        <span class="n">figName</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s">&#39;figName&#39;</span><span class="p">,</span><span class="s">&#39;Figure&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">()</span><span class="o">*</span><span class="mi">100</span><span class="p">)))</span>
        <span class="c"># Show a contour</span>
        <span class="n">contour</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s">&#39;contour&#39;</span><span class="p">,</span><span class="s">&#39;VonMis&#39;</span><span class="p">)</span>
        <span class="c"># Contour Limits</span>
        <span class="n">contLim</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s">&#39;contLim&#39;</span><span class="p">,[</span><span class="mf">0.</span><span class="p">,</span><span class="mf">1.</span><span class="p">])</span>
        <span class="c"># Establish the warping scaling factor</span>
        <span class="n">warpScale</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s">&#39;warpScale&#39;</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
        <span class="c"># Select Displacement Scale</span>
        <span class="n">displScale</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s">&#39;displScale&#39;</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
        <span class="c"># Analysis set name</span>
        <span class="n">analysis_name</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s">&#39;analysis_name&#39;</span><span class="p">,</span><span class="s">&#39;analysis_untitled&#39;</span><span class="p">)</span>
        <span class="c"># Determine what mode to plot</span>
        <span class="n">mode</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s">&#39;mode&#39;</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
        <span class="n">plots</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s">&#39;plots&#39;</span><span class="p">,[])</span>
        <span class="c"># If &#39;analysis_untitled&#39; is not a results key plot rigid xsect</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">analysis_name</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">F1</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">Fmode1</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span>
            <span class="n">x_global</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">n1</span><span class="o">.</span><span class="n">x</span><span class="o">*</span><span class="p">(</span><span class="mf">1.</span><span class="o">-</span><span class="n">x</span><span class="p">)</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">n2</span><span class="o">.</span><span class="n">x</span><span class="o">*</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">xsect</span><span class="o">.</span><span class="n">plotRigid</span><span class="p">(</span><span class="n">figName</span><span class="o">=</span><span class="n">figName</span><span class="p">,</span><span class="n">beam_axis</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">xbar</span><span class="p">,</span><span class="n">x</span><span class="o">=</span><span class="n">x_global</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">mode</span><span class="p">:</span>
                <span class="c"># Determine internal force at non-dimensional location</span>
                <span class="n">force</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Fmode1</span><span class="p">[</span><span class="n">analysis_name</span><span class="p">][:,</span><span class="n">mode</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="mf">1.</span><span class="o">-</span><span class="n">x</span><span class="p">)</span><span class="o">+</span>\
                    <span class="bp">self</span><span class="o">.</span><span class="n">Fmode2</span><span class="p">[</span><span class="n">analysis_name</span><span class="p">][:,</span><span class="n">mode</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
                <span class="c"># Determine internal displacement at non-dimensional location</span>
                <span class="n">disp</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Umode1</span><span class="p">[</span><span class="n">analysis_name</span><span class="p">][:,</span><span class="n">mode</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="mf">1.</span><span class="o">-</span><span class="n">x</span><span class="p">)</span><span class="o">+</span>\
                    <span class="bp">self</span><span class="o">.</span><span class="n">Umode2</span><span class="p">[</span><span class="n">analysis_name</span><span class="p">][:,</span><span class="n">mode</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="c"># Determine internal force at non-dimensional location</span>
                <span class="n">force</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">F1</span><span class="p">[</span><span class="n">analysis_name</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="mf">1.</span><span class="o">-</span><span class="n">x</span><span class="p">)</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">F2</span><span class="p">[</span><span class="n">analysis_name</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
                <span class="c"># Determine internal displacement at non-dimensional location</span>
                <span class="n">disp</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">U1</span><span class="p">[</span><span class="n">analysis_name</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="mf">1.</span><span class="o">-</span><span class="n">x</span><span class="p">)</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">U2</span><span class="p">[</span><span class="n">analysis_name</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
            <span class="c"># Rotate the force in the beam from the global frame to the local</span>
            <span class="c"># frame in order to recover stress and strain</span>
            <span class="n">force</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">T</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">6</span><span class="p">,</span><span class="mi">0</span><span class="p">:</span><span class="mi">6</span><span class="p">]</span><span class="o">.</span><span class="n">T</span><span class="p">,</span><span class="n">force</span><span class="p">),(</span><span class="mi">6</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span>
            <span class="n">disp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">disp</span><span class="p">,(</span><span class="mi">6</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span>
            <span class="n">x_global</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">n1</span><span class="o">.</span><span class="n">x</span><span class="o">*</span><span class="p">(</span><span class="mf">1.</span><span class="o">-</span><span class="n">x</span><span class="p">)</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">n2</span><span class="o">.</span><span class="n">x</span><span class="o">*</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">xsect</span><span class="o">.</span><span class="n">calcWarpEffects</span><span class="p">(</span><span class="n">force</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">T</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">6</span><span class="p">,</span><span class="mi">0</span><span class="p">:</span><span class="mi">6</span><span class="p">]</span><span class="o">.</span><span class="n">T</span><span class="p">,</span><span class="n">force</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">xsect</span><span class="o">.</span><span class="n">plotWarped</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">x_global</span><span class="p">,</span><span class="n">U</span><span class="o">=</span><span class="n">disp</span><span class="p">,</span><span class="n">RotMat</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">T</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">3</span><span class="p">,</span><span class="mi">0</span><span class="p">:</span><span class="mi">3</span><span class="p">],</span>\
                <span class="n">figName</span><span class="o">=</span><span class="n">figName</span><span class="p">,</span><span class="n">contour</span><span class="o">=</span><span class="n">contour</span><span class="p">,</span><span class="n">contLim</span><span class="o">=</span><span class="n">contLim</span><span class="p">,</span>\
                <span class="n">displScale</span><span class="o">=</span><span class="n">displScale</span><span class="p">,</span><span class="n">warpScale</span><span class="o">=</span><span class="n">warpScale</span><span class="p">,</span><span class="n">plots</span><span class="o">=</span><span class="n">plots</span><span class="p">)</span></div>
<div class="viewcode-block" id="SuperBeam"><a class="viewcode-back" href="../../structures.html#AeroComBAT.Structures.SuperBeam">[docs]</a><span class="k">class</span> <span class="nc">SuperBeam</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Create a superbeam object.</span>
<span class="sd">    </span>
<span class="sd">    The superbeam object is mainly to fascilitate creating a whole series of</span>
<span class="sd">    beam objects along  the same line.</span>
<span class="sd">    </span>
<span class="sd">    :Attributes:</span>
<span class="sd">    </span>
<span class="sd">    - `type (str)`: The object type, a &#39;SuperBeam&#39;.</span>
<span class="sd">    - `btype (str)`: The beam element type of the elements in the superbeam.</span>
<span class="sd">    - `SBID (int)`: The integer identifier for the superbeam.</span>
<span class="sd">    - `sNID (int)`: The starting NID of the superbeam.</span>
<span class="sd">    - `enid (int)`: The ending NID of the superbeam.</span>
<span class="sd">    - `xsect (obj)`: The cross-section object referenced by the beam elements</span>
<span class="sd">        in the superbeam.</span>
<span class="sd">    - `noe (int)`: Number of elements in the beam.</span>
<span class="sd">    - `NIDs2EIDs (dict)`: Mapping of NIDs to beam EIDs within the superbeam</span>
<span class="sd">    - `x1 (1x3 np.array[float])`: The 3D coordinate of the first point on the</span>
<span class="sd">        superbeam.</span>
<span class="sd">    - `x2 (1x3 np.array[float])`: The 3D coordinate of the last point on the</span>
<span class="sd">        superbeam.</span>
<span class="sd">    - `sEID (int)`: The integer identifier for the first beam element in the</span>
<span class="sd">        superbeam.</span>
<span class="sd">    - `elems (dict)`: A dictionary of all beam elements within the superbeam.</span>
<span class="sd">        The keys are the EIDs and the values are the corresponding beam</span>
<span class="sd">        elements.</span>
<span class="sd">    - `xbar (1x3 np.array[float])`: The vector pointing along the axis of the</span>
<span class="sd">        superbeam.</span>
<span class="sd">        </span>
<span class="sd">    :Methods:</span>
<span class="sd">    </span>
<span class="sd">    - `getBeamCoord`: Returns the 3D coordinate of a point along the superbeam.</span>
<span class="sd">    - `printInternalForce`: Prints all internal forces and moments at every</span>
<span class="sd">        node in the superbeam.</span>
<span class="sd">    - `writeDisplacements`: Writes all displacements and rotations in the</span>
<span class="sd">        superbeam to a .csv</span>
<span class="sd">    - `getEIDatx`: Provided a non-dimensional point along the superbeam, this</span>
<span class="sd">        method returns the local element EID and the non-dimensional</span>
<span class="sd">        coordinate within that element.</span>
<span class="sd">    - `printSummary`: Prints all of the elements and node IDs within the beam</span>
<span class="sd">        as well as the coordinates of those nodes.</span>
<span class="sd">        </span>
<span class="sd">    &quot;&quot;&quot;</span>
<div class="viewcode-block" id="SuperBeam.__init__"><a class="viewcode-back" href="../../structures.html#AeroComBAT.Structures.SuperBeam.__init__">[docs]</a>    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">SBID</span><span class="p">,</span><span class="n">x1</span><span class="p">,</span><span class="n">x2</span><span class="p">,</span><span class="n">xsect</span><span class="p">,</span><span class="n">noe</span><span class="p">,</span><span class="n">btype</span><span class="o">=</span><span class="s">&#39;Tbeam&#39;</span><span class="p">,</span><span class="n">sNID</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">sEID</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Creates a superelement object.</span>
<span class="sd">        </span>
<span class="sd">        This method instantiates a superelement. What it effectively does is</span>
<span class="sd">        mesh a line provided the starting and ending points along that line.</span>
<span class="sd">        Keep in mind that for now, only beams running parallel to the z-axis</span>
<span class="sd">        are supported.</span>
<span class="sd">        </span>
<span class="sd">        :Args:</span>
<span class="sd">        </span>
<span class="sd">        - `x1 (1x3 np.array[float])`: The starting coordinate of the beam.</span>
<span class="sd">        - `x2 (1x3 np.array[float])`: The ending coordinate of the beam.</span>
<span class="sd">        - `xsect (obj)`: The cross-section used throught the superbeam.</span>
<span class="sd">        - `noe (int)`: The number of elements along the beam.</span>
<span class="sd">        - `SBID (int)`: The integer identifier for the superbeam.</span>
<span class="sd">        - `btype (str)`: The beam type to be meshed. Currently only Tbeam types</span>
<span class="sd">            are supported.</span>
<span class="sd">        - `sNID (int)`: The starting NID for the superbeam.</span>
<span class="sd">        - `sEID (int)`: The starting EID for the superbeam.</span>
<span class="sd">            </span>
<span class="sd">        :Returns:</span>
<span class="sd">        </span>
<span class="sd">        - None</span>
<span class="sd">        </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">chordVec</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s">&#39;chordVec&#39;</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">1.</span><span class="p">,</span><span class="mf">0.</span><span class="p">,</span><span class="mf">0.</span><span class="p">]))</span>
        <span class="c"># Initialize the object type</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">type</span> <span class="o">=</span> <span class="s">&#39;SuperBeam&#39;</span>
        <span class="c"># Save the beam element type used within the superbeam.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">btype</span> <span class="o">=</span> <span class="n">btype</span>
        <span class="c"># Save the SBID</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">SBID</span> <span class="o">=</span> <span class="n">SBID</span>
        <span class="c"># Check to make sure that the superbeam length is at least 1.</span>
        <span class="k">if</span> <span class="n">noe</span><span class="o">&lt;</span><span class="mi">1</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s">&#39;The beam super-element must contain at least 1 beam element.&#39;</span><span class="p">)</span>
        <span class="c"># Store the starting NID</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sNID</span> <span class="o">=</span> <span class="n">sNID</span>
        <span class="c"># Store the cross-section</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">xsect</span> <span class="o">=</span> <span class="n">xsect</span>
        <span class="c"># Store the number of elements</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">noe</span> <span class="o">=</span> <span class="n">noe</span>
        <span class="c"># Store the ending node ID</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">enid</span> <span class="o">=</span> <span class="n">sNID</span><span class="o">+</span><span class="n">noe</span>
        <span class="c"># Initialize a dictionary with EIDs as the keys and the associated NIDs</span>
        <span class="c"># as the stored values.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">NIDs2EIDs</span> <span class="o">=</span> <span class="n">coll</span><span class="o">.</span><span class="n">defaultdict</span><span class="p">(</span><span class="nb">list</span><span class="p">)</span>
        <span class="c"># Create an empty element dictionary</span>
        <span class="n">elems</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="c"># Parameterize the non-dimensional length of the beam</span>
        <span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">noe</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
        <span class="c"># Store the SuperBeam starting coordinate</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">x1</span> <span class="o">=</span> <span class="n">x1</span>
        <span class="c"># Store the SuperBeam ending coordinate</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">x2</span> <span class="o">=</span> <span class="n">x2</span>
        <span class="c"># Determine the &#39;slope&#39; of the superbeam</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">m</span> <span class="o">=</span> <span class="n">x2</span><span class="o">-</span><span class="n">x1</span>
        <span class="c"># Store the starting element ID</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sEID</span> <span class="o">=</span> <span class="n">sEID</span>
        <span class="n">tmpsnidb</span> <span class="o">=</span> <span class="n">sNID</span>
        <span class="c"># Check which beam type is to be used:</span>
        <span class="k">if</span> <span class="n">btype</span> <span class="o">==</span> <span class="s">&#39;Tbeam&#39;</span><span class="p">:</span>
            <span class="n">tmpsnide</span> <span class="o">=</span> <span class="n">sNID</span><span class="o">+</span><span class="mi">1</span>
            <span class="c"># Create all the elements in the superbeam</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">noe</span><span class="p">):</span>
                <span class="n">x0</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getBeamCoord</span><span class="p">(</span><span class="n">t</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
                <span class="n">xi</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getBeamCoord</span><span class="p">(</span><span class="n">t</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">])</span>
                <span class="c"># Store the element in the superbeam elem dictionary</span>
                <span class="n">elems</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="n">sEID</span><span class="p">]</span> <span class="o">=</span> <span class="n">TBeam</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="n">sEID</span><span class="p">,</span><span class="n">x0</span><span class="p">,</span><span class="n">xi</span><span class="p">,</span><span class="n">xsect</span><span class="p">,</span><span class="n">SBID</span><span class="o">=</span><span class="n">SBID</span><span class="p">,</span>\
                    <span class="n">nid1</span><span class="o">=</span><span class="n">tmpsnidb</span><span class="p">,</span><span class="n">nid2</span><span class="o">=</span><span class="n">tmpsnide</span><span class="p">,</span><span class="n">chordVec</span><span class="o">=</span><span class="n">chordVec</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">NIDs2EIDs</span><span class="p">[</span><span class="n">tmpsnidb</span><span class="p">]</span> <span class="o">+=</span> <span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="n">sEID</span><span class="p">]</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">NIDs2EIDs</span><span class="p">[</span><span class="n">tmpsnide</span><span class="p">]</span> <span class="o">+=</span> <span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="n">sEID</span><span class="p">]</span>
                <span class="n">tmpsnidb</span> <span class="o">=</span> <span class="n">tmpsnide</span>
                <span class="n">tmpsnide</span> <span class="o">=</span> <span class="n">tmpsnidb</span><span class="o">+</span><span class="mi">1</span>
        <span class="k">elif</span> <span class="n">btype</span> <span class="o">==</span> <span class="s">&#39;EBbeam&#39;</span><span class="p">:</span>
            <span class="n">tmpsnide</span> <span class="o">=</span> <span class="n">sNID</span><span class="o">+</span><span class="mi">1</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">noe</span><span class="p">):</span>
                <span class="n">x0</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getBeamCoord</span><span class="p">(</span><span class="n">t</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
                <span class="n">xi</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getBeamCoord</span><span class="p">(</span><span class="n">t</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">])</span>
                <span class="n">elems</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="n">sEID</span><span class="p">]</span> <span class="o">=</span> <span class="n">EBBeam</span><span class="p">(</span><span class="n">x0</span><span class="p">,</span><span class="n">xi</span><span class="p">,</span><span class="n">xsect</span><span class="p">,</span><span class="n">i</span><span class="o">+</span><span class="n">sEID</span><span class="p">,</span><span class="n">SBID</span><span class="p">,</span><span class="n">nid1</span><span class="o">=</span><span class="n">tmpsnidb</span><span class="p">,</span><span class="n">nid2</span><span class="o">=</span><span class="n">tmpsnide</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">NIDs2EIDs</span><span class="p">[</span><span class="n">tmpsnidb</span><span class="p">]</span> <span class="o">+=</span> <span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="n">sEID</span><span class="p">]</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">NIDs2EIDs</span><span class="p">[</span><span class="n">tmpsnide</span><span class="p">]</span> <span class="o">+=</span> <span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="n">sEID</span><span class="p">]</span>
                <span class="n">tmpsnidb</span> <span class="o">=</span> <span class="n">tmpsnide</span>
                <span class="n">tmpsnide</span> <span class="o">=</span> <span class="n">tmpsnidb</span><span class="o">+</span><span class="mi">1</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s">&#39;You have entered an invalid beam type.&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">elems</span> <span class="o">=</span> <span class="n">elems</span>
        <span class="c"># Save the unit vector pointing along the length of the beam</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">xbar</span> <span class="o">=</span> <span class="n">elems</span><span class="p">[</span><span class="n">sEID</span><span class="p">]</span><span class="o">.</span><span class="n">xbar</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">RotMat</span> <span class="o">=</span> <span class="n">elems</span><span class="p">[</span><span class="n">sEID</span><span class="p">]</span><span class="o">.</span><span class="n">T</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">3</span><span class="p">,</span><span class="mi">0</span><span class="p">:</span><span class="mi">3</span><span class="p">]</span>
        <span class="n">nodes</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">noe</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
            <span class="n">x0</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getBeamCoord</span><span class="p">(</span><span class="n">t</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
            <span class="n">nodes</span><span class="p">[</span><span class="n">sNID</span><span class="o">+</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">sNID</span><span class="o">+</span><span class="n">i</span><span class="p">,</span><span class="n">x0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">nodes</span> <span class="o">=</span> <span class="n">nodes</span></div>
<div class="viewcode-block" id="SuperBeam.getBeamCoord"><a class="viewcode-back" href="../../structures.html#AeroComBAT.Structures.SuperBeam.getBeamCoord">[docs]</a>    <span class="k">def</span> <span class="nf">getBeamCoord</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">x_nd</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Determine the global coordinate along superbeam.</span>
<span class="sd">        </span>
<span class="sd">        Provided the non-dimensional coordinate along the beam, this method</span>
<span class="sd">        returns the global coordinate at that point.</span>
<span class="sd">        </span>
<span class="sd">        :Args:</span>
<span class="sd">        </span>
<span class="sd">        - `x_nd (float)`: The non-dimensional coordinate along the beam. Note</span>
<span class="sd">            that x_nd must be between zero and one.</span>
<span class="sd">            </span>
<span class="sd">        :Returns:</span>
<span class="sd">        </span>
<span class="sd">        - `(1x3 np.array[float])`: The global coordinate corresponding to x_nd</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c"># Check that x_nd is between 0 and 1</span>
        <span class="k">if</span> <span class="n">x_nd</span><span class="o">&lt;</span><span class="mf">0.</span> <span class="ow">or</span> <span class="n">x_nd</span><span class="o">&gt;</span><span class="mf">1.</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s">&#39;The non-dimensional position along the beam can&#39;</span>\
                <span class="s">&#39;only vary between 0 and 1&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">x1</span><span class="o">+</span><span class="n">x_nd</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">m</span></div>
<div class="viewcode-block" id="SuperBeam.printInternalForce"><a class="viewcode-back" href="../../structures.html#AeroComBAT.Structures.SuperBeam.printInternalForce">[docs]</a>    <span class="k">def</span> <span class="nf">printInternalForce</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Prints the internal forces and moments in the superbeam.</span>
<span class="sd">        </span>
<span class="sd">        For every node within the superbeam, this method will print out the</span>
<span class="sd">        internal forces and moments at those nodes.</span>
<span class="sd">        </span>
<span class="sd">        :Args:</span>
<span class="sd">        </span>
<span class="sd">        - `analysis_name (str)`: The name of the analysis for which the forces</span>
<span class="sd">            and moments are being surveyed.</span>
<span class="sd">        </span>
<span class="sd">        :Returns:</span>
<span class="sd">        </span>
<span class="sd">        - `(str)`: Printed output expressing all forces and moments.</span>
<span class="sd">        </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">analysis_name</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s">&#39;analysis_name&#39;</span><span class="p">,</span><span class="s">&#39;analysis_untitled&#39;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">EID</span><span class="p">,</span> <span class="n">elem</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">elems</span><span class="o">.</span><span class="n">iteritems</span><span class="p">():</span>
            <span class="n">elem</span><span class="o">.</span><span class="n">printInternalForce</span><span class="p">(</span><span class="n">analysis_name</span><span class="o">=</span><span class="n">analysis_name</span><span class="p">)</span></div>
<div class="viewcode-block" id="SuperBeam.writeDisplacements"><a class="viewcode-back" href="../../structures.html#AeroComBAT.Structures.SuperBeam.writeDisplacements">[docs]</a>    <span class="k">def</span> <span class="nf">writeDisplacements</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Write internal displacements and rotations to file.</span>
<span class="sd">        </span>
<span class="sd">        For every node within the superbeam, this method will tabulate all of</span>
<span class="sd">        the displacements and rotations and then write them to a file.</span>
<span class="sd">        </span>
<span class="sd">        :Args:</span>
<span class="sd">        </span>
<span class="sd">        - `fileName (str)`: The name of the file where the data will be written.</span>
<span class="sd">        - `analysis_name (str)`: The name of the analysis for which the</span>
<span class="sd">            displacements and rotations are being surveyed.</span>
<span class="sd">        </span>
<span class="sd">        :Returns:</span>
<span class="sd">        </span>
<span class="sd">        - `fileName (file)`: This method doesn&#39;t actually return a file, rather</span>
<span class="sd">            it writes the data to a file named &quot;fileName&quot; and saves it to the</span>
<span class="sd">            working directory.</span>
<span class="sd">            </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c"># Load default value for file name</span>
        <span class="n">fileName</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s">&#39;fileName&#39;</span><span class="p">,</span><span class="s">&#39;displacements.csv&#39;</span><span class="p">)</span>
        <span class="n">analysis_name</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s">&#39;analysis_name&#39;</span><span class="p">,</span><span class="s">&#39;analysis_untitled&#39;</span><span class="p">)</span>
        <span class="n">Return</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s">&#39;Return&#39;</span><span class="p">,</span><span class="bp">False</span><span class="p">)</span>
        <span class="n">NID</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">elems</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">));</span>
        <span class="n">nodeX</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">elems</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">));</span>
        <span class="n">nodeDisp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">elems</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="mi">6</span><span class="p">));</span>
        <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">NIDs</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">EID</span><span class="p">,</span> <span class="n">elem</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">elems</span><span class="o">.</span><span class="n">iteritems</span><span class="p">():</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">elem</span><span class="o">.</span><span class="n">n1</span><span class="o">.</span><span class="n">NID</span> <span class="ow">in</span> <span class="n">NIDs</span><span class="p">:</span>
                <span class="n">NIDs</span><span class="o">+=</span><span class="p">[</span><span class="n">elem</span><span class="o">.</span><span class="n">n1</span><span class="o">.</span><span class="n">NID</span><span class="p">]</span>
                <span class="n">NID</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">elem</span><span class="o">.</span><span class="n">n1</span><span class="o">.</span><span class="n">NID</span>
                <span class="n">nodeX</span><span class="p">[</span><span class="n">i</span><span class="p">,:]</span> <span class="o">=</span> <span class="n">elem</span><span class="o">.</span><span class="n">n1</span><span class="o">.</span><span class="n">x</span>
                <span class="n">nodeDisp</span><span class="p">[</span><span class="n">i</span><span class="p">,:]</span> <span class="o">=</span> <span class="n">elem</span><span class="o">.</span><span class="n">U1</span><span class="p">[</span><span class="n">analysis_name</span><span class="p">]</span><span class="o">.</span><span class="n">T</span>
                <span class="n">i</span><span class="o">+=</span><span class="mi">1</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">elem</span><span class="o">.</span><span class="n">n2</span><span class="o">.</span><span class="n">NID</span> <span class="ow">in</span> <span class="n">NIDs</span><span class="p">:</span>
                <span class="n">NIDs</span><span class="o">+=</span><span class="p">[</span><span class="n">elem</span><span class="o">.</span><span class="n">n2</span><span class="o">.</span><span class="n">NID</span><span class="p">]</span>
                <span class="n">NID</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">elem</span><span class="o">.</span><span class="n">n2</span><span class="o">.</span><span class="n">NID</span>
                <span class="n">nodeX</span><span class="p">[</span><span class="n">i</span><span class="p">,:]</span> <span class="o">=</span> <span class="n">elem</span><span class="o">.</span><span class="n">n2</span><span class="o">.</span><span class="n">x</span>
                <span class="n">nodeDisp</span><span class="p">[</span><span class="n">i</span><span class="p">,:]</span> <span class="o">=</span> <span class="n">elem</span><span class="o">.</span><span class="n">U2</span><span class="p">[</span><span class="n">analysis_name</span><span class="p">]</span><span class="o">.</span><span class="n">T</span>
                <span class="n">i</span><span class="o">+=</span><span class="mi">1</span>
        <span class="n">writeData</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">hstack</span><span class="p">((</span><span class="n">NID</span><span class="p">,</span><span class="n">nodeX</span><span class="p">,</span><span class="n">nodeDisp</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">Return</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">writeData</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">np</span><span class="o">.</span><span class="n">savetxt</span><span class="p">(</span><span class="n">fileName</span><span class="p">,</span><span class="n">writeData</span><span class="p">,</span><span class="n">delimiter</span><span class="o">=</span><span class="s">&#39;,&#39;</span><span class="p">)</span></div>
<div class="viewcode-block" id="SuperBeam.writeForcesMoments"><a class="viewcode-back" href="../../structures.html#AeroComBAT.Structures.SuperBeam.writeForcesMoments">[docs]</a>    <span class="k">def</span> <span class="nf">writeForcesMoments</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Write internal force and moments to file.</span>
<span class="sd">        </span>
<span class="sd">        For every node within the superbeam, this method will tabulate all of</span>
<span class="sd">        the forces and moments and then write them to a file.</span>
<span class="sd">        </span>
<span class="sd">        :Args:</span>
<span class="sd">        </span>
<span class="sd">        - `fileName (str)`: The name of the file where the data will be written.</span>
<span class="sd">        - `analysis_name (str)`: The name of the analysis for which the</span>
<span class="sd">            forces and moments are being surveyed.</span>
<span class="sd">        </span>
<span class="sd">        :Returns:</span>
<span class="sd">        </span>
<span class="sd">        - `fileName (file)`: This method doesn&#39;t actually return a file, rather</span>
<span class="sd">            it writes the data to a file named &quot;fileName&quot; and saves it to the</span>
<span class="sd">            working directory.</span>
<span class="sd">            </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">fileName</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s">&#39;fileName&#39;</span><span class="p">,</span><span class="s">&#39;forcesMoments.csv&#39;</span><span class="p">)</span>
        <span class="n">analysis_name</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s">&#39;analysis_name&#39;</span><span class="p">,</span><span class="s">&#39;analysis_untitled&#39;</span><span class="p">)</span>
        <span class="n">Return</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s">&#39;Return&#39;</span><span class="p">,</span><span class="bp">False</span><span class="p">)</span>
        <span class="n">NID</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">elems</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">));</span>
        <span class="n">nodeX</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">elems</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">));</span>
        <span class="n">nodeForce</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">elems</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="mi">6</span><span class="p">));</span>
        <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">NIDs</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">EID</span><span class="p">,</span> <span class="n">elem</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">elems</span><span class="o">.</span><span class="n">iteritems</span><span class="p">():</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">elem</span><span class="o">.</span><span class="n">n1</span><span class="o">.</span><span class="n">NID</span> <span class="ow">in</span> <span class="n">NIDs</span><span class="p">:</span>
                <span class="n">NIDs</span><span class="o">+=</span><span class="p">[</span><span class="n">elem</span><span class="o">.</span><span class="n">n1</span><span class="o">.</span><span class="n">NID</span><span class="p">]</span>
                <span class="n">NID</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">elem</span><span class="o">.</span><span class="n">n1</span><span class="o">.</span><span class="n">NID</span>
                <span class="n">nodeX</span><span class="p">[</span><span class="n">i</span><span class="p">,:]</span> <span class="o">=</span> <span class="n">elem</span><span class="o">.</span><span class="n">n1</span><span class="o">.</span><span class="n">x</span>
                <span class="n">nodeForce</span><span class="p">[</span><span class="n">i</span><span class="p">,:]</span> <span class="o">=</span> <span class="n">elem</span><span class="o">.</span><span class="n">F1</span><span class="p">[</span><span class="n">analysis_name</span><span class="p">]</span><span class="o">.</span><span class="n">T</span>
                <span class="n">i</span><span class="o">+=</span><span class="mi">1</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">elem</span><span class="o">.</span><span class="n">n2</span><span class="o">.</span><span class="n">NID</span> <span class="ow">in</span> <span class="n">NIDs</span><span class="p">:</span>
                <span class="n">NIDs</span><span class="o">+=</span><span class="p">[</span><span class="n">elem</span><span class="o">.</span><span class="n">n2</span><span class="o">.</span><span class="n">NID</span><span class="p">]</span>
                <span class="n">NID</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">elem</span><span class="o">.</span><span class="n">n2</span><span class="o">.</span><span class="n">NID</span>
                <span class="n">nodeX</span><span class="p">[</span><span class="n">i</span><span class="p">,:]</span> <span class="o">=</span> <span class="n">elem</span><span class="o">.</span><span class="n">n2</span><span class="o">.</span><span class="n">x</span>
                <span class="n">nodeForce</span><span class="p">[</span><span class="n">i</span><span class="p">,:]</span> <span class="o">=</span> <span class="n">elem</span><span class="o">.</span><span class="n">F2</span><span class="p">[</span><span class="n">analysis_name</span><span class="p">]</span><span class="o">.</span><span class="n">T</span>
                <span class="n">i</span><span class="o">+=</span><span class="mi">1</span>
        <span class="n">writeData</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">hstack</span><span class="p">((</span><span class="n">NID</span><span class="p">,</span><span class="n">nodeX</span><span class="p">,</span><span class="n">nodeForce</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">Return</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">writeData</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">np</span><span class="o">.</span><span class="n">savetxt</span><span class="p">(</span><span class="n">fileName</span><span class="p">,</span><span class="n">writeData</span><span class="p">,</span><span class="n">delimiter</span><span class="o">=</span><span class="s">&#39;,&#39;</span><span class="p">)</span></div>
<div class="viewcode-block" id="SuperBeam.getEIDatx"><a class="viewcode-back" href="../../structures.html#AeroComBAT.Structures.SuperBeam.getEIDatx">[docs]</a>    <span class="k">def</span> <span class="nf">getEIDatx</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">x</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns the beam EID at a non-dimensional x-location in the superbeam.</span>
<span class="sd">        </span>
<span class="sd">        Provided the non-dimensional coordinate along the beam, this method</span>
<span class="sd">        returns the global beam element EID, as well as the local non-</span>
<span class="sd">        dimensional coordinate within the specific beam element.</span>
<span class="sd">        </span>
<span class="sd">        :Args:</span>
<span class="sd">        </span>
<span class="sd">        - `x (float)`: The non-dimensional coordinate within the super-beam</span>
<span class="sd">        </span>
<span class="sd">        :Returns:</span>
<span class="sd">        </span>
<span class="sd">        - `EID (int)`: The EID of the element containing the non-dimensional</span>
<span class="sd">            coordinate provided.</span>
<span class="sd">        - `local_x_nd (float)`: The non-dimensional coordinate within the beam</span>
<span class="sd">            element associated with the provided non-dimensional coordinate</span>
<span class="sd">            within the beam.</span>
<span class="sd">            </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="sd">&#39;&#39;&#39;n = len(self.elems)</span>
<span class="sd">        local_x_nd = 1.</span>
<span class="sd">        EID = max(self.elems.keys())</span>
<span class="sd">        for i in range(0,n):</span>
<span class="sd">            if x&lt;=(float(i)/float(n)):</span>
<span class="sd">                EID = self.sEID+i</span>
<span class="sd">                local_x_nd = 1+i-n*x</span>
<span class="sd">                break&#39;&#39;&#39;</span>
        <span class="n">totalLen</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">x2</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">x1</span><span class="p">)</span>
        <span class="n">xDim</span> <span class="o">=</span> <span class="n">x</span><span class="o">*</span><span class="n">totalLen</span>
        <span class="k">for</span> <span class="n">locEID</span><span class="p">,</span> <span class="n">elem</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">elems</span><span class="o">.</span><span class="n">iteritems</span><span class="p">():</span>
            <span class="n">localElemDim</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">elem</span><span class="o">.</span><span class="n">n2</span><span class="o">.</span><span class="n">x</span><span class="p">)</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">x1</span><span class="p">))</span>
            <span class="k">if</span> <span class="n">xDim</span><span class="o">&lt;=</span><span class="n">localElemDim</span><span class="p">:</span>
                <span class="n">EID</span> <span class="o">=</span> <span class="n">locEID</span>
                <span class="n">local_x_nd</span> <span class="o">=</span> <span class="p">(</span><span class="n">xDim</span><span class="o">-</span><span class="p">(</span><span class="n">localElemDim</span><span class="o">-</span><span class="n">elem</span><span class="o">.</span><span class="n">h</span><span class="p">))</span><span class="o">/</span><span class="n">elem</span><span class="o">.</span><span class="n">h</span>
                <span class="k">break</span>
        <span class="k">return</span> <span class="n">EID</span><span class="p">,</span> <span class="n">local_x_nd</span></div>
<div class="viewcode-block" id="SuperBeam.printSummary"><a class="viewcode-back" href="../../structures.html#AeroComBAT.Structures.SuperBeam.printSummary">[docs]</a>    <span class="k">def</span> <span class="nf">printSummary</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">decimals</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Prints out characteristic information about the super beam.</span>
<span class="sd">        </span>
<span class="sd">        This method by default prints out the EID, XID, SBID and the NIDs along</span>
<span class="sd">        with the nodes associated coordinates. Upon request, it can also print</span>
<span class="sd">        out the beam element stiffness, geometric stiffness, mass matricies and</span>
<span class="sd">        distributed force vector.</span>
<span class="sd">        </span>
<span class="sd">        :Args:</span>
<span class="sd">        </span>
<span class="sd">        - `nodeCoord (bool)`: A boolean to determine if the node coordinate</span>
<span class="sd">            information should also be printed.</span>
<span class="sd">        - `Ke (bool)`: A boolean to determine if the element stiffness matrix</span>
<span class="sd">            should be printed.</span>
<span class="sd">        - `Keg (bool)`: A boolean to determine if the element gemoetric</span>
<span class="sd">            stiffness matrix should be printed.</span>
<span class="sd">        - `Me (bool)`: A boolean to determine if the element mass matrix</span>
<span class="sd">            should be printed.</span>
<span class="sd">        - `Fe (bool)`: A boolean to determine if the element distributed force</span>
<span class="sd">            and moment vector should be printed.</span>
<span class="sd">            </span>
<span class="sd">        :Returns:</span>
<span class="sd">        </span>
<span class="sd">        - `(str)`: Printed summary of the requested attributes.</span>
<span class="sd">        </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c"># Print the associated xsect ID</span>
        <span class="n">XID</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s">&#39;XID&#39;</span><span class="p">,</span><span class="bp">False</span><span class="p">)</span>
        <span class="c"># Print the number of beam elements in the superbeam</span>
        <span class="n">numElements</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s">&#39;numElements&#39;</span><span class="p">,</span><span class="bp">False</span><span class="p">)</span>
        <span class="c"># Determine if node coordinates should also be printed</span>
        <span class="n">nodeCoord</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s">&#39;nodeCoord&#39;</span><span class="p">,</span><span class="bp">True</span><span class="p">)</span>
        <span class="c"># Print the stiffness matrix</span>
        <span class="n">Ke</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s">&#39;Ke&#39;</span><span class="p">,</span><span class="bp">False</span><span class="p">)</span>
        <span class="c"># Print the geometric stiffness matrix</span>
        <span class="n">Keg</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s">&#39;Keg&#39;</span><span class="p">,</span><span class="bp">False</span><span class="p">)</span>
        <span class="c"># Print the mass matrix</span>
        <span class="n">Me</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s">&#39;Me&#39;</span><span class="p">,</span><span class="bp">False</span><span class="p">)</span>
        <span class="c"># Print the distributed force vector</span>
        <span class="n">Fe</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s">&#39;Fe&#39;</span><span class="p">,</span><span class="bp">False</span><span class="p">)</span>
        <span class="c"># Print the element summaries</span>
        
        <span class="c"># Print the SBID</span>
        <span class="k">print</span><span class="p">(</span><span class="s">&#39;Superbeam: </span><span class="si">%d</span><span class="s">&#39;</span> <span class="o">%</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">SBID</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">XID</span><span class="p">:</span>
            <span class="k">print</span><span class="p">(</span><span class="s">&#39;Cross-section: </span><span class="si">%d</span><span class="s">&#39;</span> <span class="o">%</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">XID</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">numElements</span><span class="p">:</span>
            <span class="k">print</span><span class="p">(</span><span class="s">&#39;There are </span><span class="si">%d</span><span class="s"> elements in this super-beam.&#39;</span> <span class="o">%</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">elems</span><span class="p">)))</span>
        <span class="k">for</span> <span class="n">EID</span><span class="p">,</span> <span class="n">elem</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">elems</span><span class="o">.</span><span class="n">iteritems</span><span class="p">():</span>
            <span class="n">elem</span><span class="o">.</span><span class="n">printSummary</span><span class="p">(</span><span class="n">nodeCoord</span><span class="o">=</span><span class="n">nodeCoord</span><span class="p">,</span><span class="n">Ke</span><span class="o">=</span><span class="n">Ke</span><span class="p">,</span><span class="n">Keg</span><span class="o">=</span><span class="n">Keg</span><span class="p">,</span><span class="n">Me</span><span class="o">=</span><span class="n">Me</span><span class="p">,</span><span class="n">Fe</span><span class="o">=</span><span class="n">Fe</span><span class="p">)</span>
            </div></div>
<div class="viewcode-block" id="WingSection"><a class="viewcode-back" href="../../structures.html#AeroComBAT.Structures.WingSection">[docs]</a><span class="k">class</span> <span class="nc">WingSection</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Creates a wing section object.</span>
<span class="sd">    </span>
<span class="sd">    This class instantiates a wing section object which is intended to</span>
<span class="sd">    represent the section of a wing enclosed by two ribs. This allows primarily</span>
<span class="sd">    for two different things: it allows the user to vary the cross-section</span>
<span class="sd">    design of the wing by enabling different designs in each wing section, as</span>
<span class="sd">    well as enabling the user to estimate the static stability of the laminates</span>
<span class="sd">    that make up the wing-section design.</span>
<span class="sd">    </span>
<span class="sd">    :Attributes:</span>
<span class="sd">    </span>
<span class="sd">    - `Airfoils (Array[obj])`: This array contains all of the airfoils used</span>
<span class="sd">        over the wing section. This attribute exists primarily to fascilitate</span>
<span class="sd">        the meshing process and is subject to change.</span>
<span class="sd">    - `XSects (Array[obj])`: This array contains all of the cross-section</span>
<span class="sd">        objects used in the wing section. If the cross-section is constant</span>
<span class="sd">        along the length of the wing section, this array length is 1.</span>
<span class="sd">    - `SuperBeams (Array[obj])`: This array contains all of the superbeam</span>
<span class="sd">        objects used in the wing section. If the cross-section is constant</span>
<span class="sd">        along the length of the wing section, this array length is 1.</span>
<span class="sd">    - `xdim (1x2 Array[float])`: This array contains the non-dimensional</span>
<span class="sd">        starting and ending points of the wing section spar. They are</span>
<span class="sd">        non-dimensionalized by the chord length.</span>
<span class="sd">    - `Laminates (Array[obj])`: This array contains the laminate objects used</span>
<span class="sd">        by the cross-sections in the wing section.</span>
<span class="sd">    - `x1 (1x3 np.array[float])`: The starting coordinate of the wing section.</span>
<span class="sd">    - `x2 (1x3 np.array[float])`: The ending coordinate of the wing section.</span>
<span class="sd">    - `XIDs (Array[int])`: This array containts the integer cross-section IDs</span>
<span class="sd">    </span>
<span class="sd">    :Methods:</span>
<span class="sd">    </span>
<span class="sd">    - `plotRigid`: This method plots the rigid wing section in 3D space.</span>
<span class="sd">    - `plotDispl`: Provided an analysis name, this method will deformed state</span>
<span class="sd">        of the wing section. It is also capable of plotting cross-section</span>
<span class="sd">        criteria, such as displacement, stress, strain, or failure criteria.</span>
<span class="sd">        </span>
<span class="sd">    </span>
<span class="sd">    </span>
<span class="sd">    .. Warning:: While it is possible to use multiple cross-section within the</span>
<span class="sd">        wing section, this capability is only to be utilized for tapering cross</span>
<span class="sd">        sections, not changing the cross-section type or design (such as by</span>
<span class="sd">        changing the laminates used to make the cross-sections). Doing so would</span>
<span class="sd">        invalidate the ritz method buckling solutions applied to the laminate</span>
<span class="sd">        objects.</span>
<span class="sd">    </span>
<span class="sd">    &quot;&quot;&quot;</span>
<div class="viewcode-block" id="WingSection.__init__"><a class="viewcode-back" href="../../structures.html#AeroComBAT.Structures.WingSection.__init__">[docs]</a>    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">x1</span><span class="p">,</span><span class="n">x2</span><span class="p">,</span><span class="n">chord</span><span class="p">,</span><span class="n">name</span><span class="p">,</span><span class="n">x0_spar</span><span class="p">,</span><span class="n">xf_spar</span><span class="p">,</span><span class="n">laminates</span><span class="p">,</span><span class="n">matLib</span><span class="p">,</span><span class="n">noe</span><span class="p">,</span><span class="n">SSBID</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">SNID</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">SEID</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Creates a wing section object</span>
<span class="sd">        </span>
<span class="sd">        This wing section object is in some way an organizational object. It</span>
<span class="sd">        holds a collection of superbeam objects which in general could all use</span>
<span class="sd">        different cross-sections. One could for example use several super-beams</span>
<span class="sd">        in order to simlate a taper within a wing section descretely. These</span>
<span class="sd">        objects will also be used in order to determine the buckling span of</span>
<span class="sd">        the laminate objects held within the cross-section.</span>
<span class="sd">        </span>
<span class="sd">        :Args:</span>
<span class="sd">        </span>
<span class="sd">        - `x1 (1x3 np.array[float])`: The starting coordinate of the wing</span>
<span class="sd">            section.</span>
<span class="sd">        - `x2 (1x3 np.array[float])`: The ending coordinate of the wing</span>
<span class="sd">            section.</span>
<span class="sd">        - `chord (func)`: A function that returns the chord length along a wing</span>
<span class="sd">            provided the scalar length from the wing origin to the desired</span>
<span class="sd">            point.</span>
<span class="sd">        - `name (str)`: The name of the airfoil to be used to mesh the</span>
<span class="sd">            cross-section. This is subject to change since the meshing process</span>
<span class="sd">            is only a placeholder.</span>
<span class="sd">        - `x0_spar (float)`: The non-dimensional starting location of the cross</span>
<span class="sd">            section. This value is non-dimensionalized by the local chord</span>
<span class="sd">            length.</span>
<span class="sd">        - `xf_spar (float)`: The non-dimensional ending location of the cross</span>
<span class="sd">            section. This value is non-dimensionalized by the local chord</span>
<span class="sd">            length.</span>
<span class="sd">        - `laminates (Array[obj])`: This array contains the laminate objects to</span>
<span class="sd">            be used in order to mesh the cross-section.</span>
<span class="sd">        - `matLib (obj)`: This material library object contains all of the</span>
<span class="sd">            materials to be used in meshing the cross-sections used by the</span>
<span class="sd">            wing section.</span>
<span class="sd">        - `noe (float)`: The number of beam elements to be used in the wing per</span>
<span class="sd">            unit length.</span>
<span class="sd">        - `SSBID (int)`: The starting superbeam ID in the wing section.</span>
<span class="sd">        - `SNID (int)`: The starting node ID in the wing section.</span>
<span class="sd">        - `SEID (int)`: The starting element ID in the wing section.</span>
<span class="sd">        - `SXID (int)`: The starting cross-section ID in the wing section.</span>
<span class="sd">        - `numSupBeams (int)`: The number of different superbeams to be used</span>
<span class="sd">            in the wing section.</span>
<span class="sd">        - `typeXSect (str)`: The type of cross-section used by the wing</span>
<span class="sd">            section.</span>
<span class="sd">        - `meshSize (int)`: The maximum aspect ratio an element can have within</span>
<span class="sd">            the cross-sections used by the wing sections.</span>
<span class="sd">        - `ref_ax (str)`: The reference axis used by the cross-section. This is</span>
<span class="sd">            axis about which the loads will be applied on the wing section.</span>
<span class="sd">        </span>
<span class="sd">        .. Note:: The chord function could take the shape of: </span>
<span class="sd">            chord = lambda y: (ctip-croot)*y/b_s+croot</span>
<span class="sd">            </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Airfoils</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">XSects</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">SuperBeams</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">xdim</span> <span class="o">=</span> <span class="p">[</span><span class="n">x0_spar</span><span class="p">,</span><span class="n">xf_spar</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">laminates</span> <span class="o">=</span> <span class="n">laminates</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">x1</span> <span class="o">=</span> <span class="n">x1</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">x2</span> <span class="o">=</span> <span class="n">x2</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">XIDs</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">numSupBeams</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s">&#39;numSuperBeams&#39;</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">typeXSect</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s">&#39;typeXSect&#39;</span><span class="p">,</span><span class="s">&#39;box&#39;</span><span class="p">)</span>
        <span class="n">meshSize</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s">&#39;meshSize&#39;</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span>
        <span class="n">SXID</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s">&#39;SXID&#39;</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
        <span class="n">ref_ax</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s">&#39;ref_ax&#39;</span><span class="p">,</span><span class="s">&#39;shearCntr&#39;</span><span class="p">)</span>
        <span class="n">chordVec</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s">&#39;chordVec&#39;</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">1.</span><span class="p">,</span><span class="mf">0.</span><span class="p">,</span><span class="mf">0.</span><span class="p">]))</span>
        <span class="n">t_vec</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">numSupBeams</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">xs</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">t_vec</span><span class="p">:</span>
            <span class="n">xs</span><span class="o">+=</span><span class="p">[</span><span class="n">x1</span><span class="o">+</span><span class="n">t</span><span class="o">*</span><span class="p">(</span><span class="n">x2</span><span class="o">-</span><span class="n">x1</span><span class="p">)]</span>
        <span class="n">tmpsnid1</span> <span class="o">=</span> <span class="n">SNID</span>
        <span class="n">tmpsEID</span> <span class="o">=</span> <span class="n">SEID</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">numSupBeams</span><span class="p">):</span>
            <span class="n">sbeam_mid</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">((</span><span class="n">xs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">+</span><span class="n">xs</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">])</span><span class="o">/</span><span class="mf">2.</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">Airfoils</span> <span class="o">+=</span> <span class="p">[</span><span class="n">Airfoil</span><span class="p">(</span><span class="n">chord</span><span class="p">(</span><span class="n">sbeam_mid</span><span class="p">),</span><span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">)]</span>
            <span class="n">tmpXsect</span> <span class="o">=</span> <span class="n">XSect</span><span class="p">(</span><span class="n">SXID</span><span class="o">+</span><span class="n">i</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">Airfoils</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="bp">self</span><span class="o">.</span><span class="n">xdim</span><span class="p">,</span>\
                <span class="n">laminates</span><span class="p">,</span><span class="n">matLib</span><span class="p">,</span><span class="n">typeXSect</span><span class="o">=</span><span class="n">typeXSect</span><span class="p">,</span><span class="n">meshSize</span><span class="o">=</span><span class="n">meshSize</span><span class="p">)</span>
            <span class="n">tmpXsect</span><span class="o">.</span><span class="n">xSectionAnalysis</span><span class="p">(</span><span class="n">ref_ax</span><span class="o">=</span><span class="n">ref_ax</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">XSects</span> <span class="o">+=</span> <span class="p">[</span><span class="n">tmpXsect</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">XIDs</span> <span class="o">+=</span> <span class="p">[</span><span class="n">tmpXsect</span><span class="o">.</span><span class="n">XID</span><span class="p">]</span>
            <span class="n">sbeam_len</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">xs</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">xs</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
            <span class="n">noe</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">noe</span><span class="o">*</span><span class="n">sbeam_len</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">SuperBeams</span> <span class="o">+=</span> <span class="p">[</span><span class="n">SuperBeam</span><span class="p">(</span><span class="n">SSBID</span><span class="o">+</span><span class="n">i</span><span class="p">,</span><span class="n">xs</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">xs</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">],</span><span class="bp">self</span><span class="o">.</span><span class="n">XSects</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>\
                <span class="p">,</span><span class="n">noe</span><span class="p">,</span><span class="n">sNID</span><span class="o">=</span><span class="n">tmpsnid1</span><span class="p">,</span><span class="n">sEID</span><span class="o">=</span><span class="n">tmpsEID</span><span class="p">,</span><span class="n">chordVec</span><span class="o">=</span><span class="n">chordVec</span><span class="p">)]</span>
            <span class="n">tmpsnid1</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">SuperBeams</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">nodes</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
            <span class="n">tmpsEID</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">SuperBeams</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">elems</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span><span class="o">+</span><span class="mi">1</span></div>
<div class="viewcode-block" id="WingSection.plotRigid"><a class="viewcode-back" href="../../structures.html#AeroComBAT.Structures.WingSection.plotRigid">[docs]</a>    <span class="k">def</span> <span class="nf">plotRigid</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Plots the rigid wing section object in 3D space.</span>
<span class="sd">        </span>
<span class="sd">        This method is exceptionally helpful when building up a model and</span>
<span class="sd">        debugging it.</span>
<span class="sd">        </span>
<span class="sd">        :Args:</span>
<span class="sd">        </span>
<span class="sd">        - `figName (str)`: The name of the plot to be generated. If one is not</span>
<span class="sd">            provided a semi-random name will be generated.</span>
<span class="sd">        - `environment (str)`: The name of the environment to be used when</span>
<span class="sd">            plotting. Currently only the &#39;mayavi&#39; environment is supported.</span>
<span class="sd">        - `clr (1x3 tuple(int))`: This tuple represents the RGB values that the</span>
<span class="sd">            beam reference axis will be colored with.</span>
<span class="sd">        - `numXSects (int)`: This is the number of cross-sections that will be</span>
<span class="sd">            plotted and evenly distributed throughout the beam.</span>
<span class="sd">        </span>
<span class="sd">        :Returns:</span>
<span class="sd">        </span>
<span class="sd">        - `(figure)`: This method returns a 3D plot of the rigid wing section.</span>
<span class="sd">        </span>
<span class="sd">        .. Warning:: In order to limit the size of data stored in memory, the</span>
<span class="sd">            local cross-sectional data is not stored. As a result, for every</span>
<span class="sd">            additional cross-section that is plotted, the time required to plot</span>
<span class="sd">            will increase substantially.</span>
<span class="sd">        </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">figName</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s">&#39;figName&#39;</span><span class="p">,</span><span class="s">&#39;Figure&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">()</span><span class="o">*</span><span class="mi">100</span><span class="p">)))</span>
        <span class="c"># Select the plotting environment you&#39;d like to choose</span>
        <span class="n">environment</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s">&#39;environment&#39;</span><span class="p">,</span><span class="s">&#39;mayavi&#39;</span><span class="p">)</span>
        <span class="c"># Chose the color of the beam, defaults to black, accepts tuple</span>
        <span class="n">clr</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s">&#39;color&#39;</span><span class="p">,(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">))</span>
        <span class="c"># Chose the number of cross-sections to be plotted. By default this is 2</span>
        <span class="c"># One at the beggining and one at the end of the super beam</span>
        <span class="n">numXSects</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s">&#39;numXSects&#39;</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">environment</span><span class="o">==</span><span class="s">&#39;mayavi&#39;</span><span class="p">:</span>
            <span class="n">mlab</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figure</span><span class="o">=</span><span class="n">figName</span><span class="p">)</span>
            <span class="c"># Plot the rigid Beam Axes:</span>
            <span class="k">for</span> <span class="n">sbeam</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">SuperBeams</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">EID</span><span class="p">,</span> <span class="n">elem</span> <span class="ow">in</span> <span class="n">sbeam</span><span class="o">.</span><span class="n">elems</span><span class="o">.</span><span class="n">iteritems</span><span class="p">():</span>
                    <span class="n">elem</span><span class="o">.</span><span class="n">plotRigidBeam</span><span class="p">(</span><span class="n">environment</span><span class="o">=</span><span class="n">environment</span><span class="p">,</span><span class="n">clr</span><span class="o">=</span><span class="n">clr</span><span class="p">,</span><span class="n">figName</span><span class="o">=</span><span class="n">figName</span><span class="p">)</span>
                <span class="c">#nids = sbeam.nodes.keys()</span>
                <span class="c"># For numXSects nodes evenly spaced in the beam</span>
                <span class="n">x_nd</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">numXSects</span><span class="p">)</span>
                <span class="n">RotMat</span> <span class="o">=</span> <span class="n">sbeam</span><span class="o">.</span><span class="n">RotMat</span>
                <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">numXSects</span><span class="p">):</span>
                    <span class="c"># Determine the rigid location of the node with NID i</span>
                    <span class="n">xtmp</span> <span class="o">=</span> <span class="n">sbeam</span><span class="o">.</span><span class="n">getBeamCoord</span><span class="p">(</span><span class="n">x_nd</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
                    <span class="c"># The below lines are for loaded/displaced beams:</span>
                    <span class="n">sbeam</span><span class="o">.</span><span class="n">xsect</span><span class="o">.</span><span class="n">plotRigid</span><span class="p">(</span><span class="n">figName</span><span class="o">=</span><span class="n">figName</span><span class="p">,</span><span class="n">RotMat</span><span class="o">=</span><span class="n">RotMat</span><span class="p">,</span><span class="n">x</span><span class="o">=</span><span class="n">xtmp</span><span class="p">)</span></div>
<div class="viewcode-block" id="WingSection.plotDispl"><a class="viewcode-back" href="../../structures.html#AeroComBAT.Structures.WingSection.plotDispl">[docs]</a>    <span class="k">def</span> <span class="nf">plotDispl</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Plots the deformed wing section object in 3D space.</span>
<span class="sd">        </span>
<span class="sd">        Provided an analysis name, this method will plot the results from the</span>
<span class="sd">        corresponding analysis including beam/cross-section deformation, and</span>
<span class="sd">        stress, strain, or failure criteria within the sampled cross-sections.</span>
<span class="sd">        </span>
<span class="sd">        :Args:</span>
<span class="sd">        </span>
<span class="sd">        - `figName (str)`: The name of the plot to be generated. If one is not</span>
<span class="sd">            provided a semi-random name will be generated.</span>
<span class="sd">        - `environment (str)`: The name of the environment to be used when</span>
<span class="sd">            plotting. Currently only the &#39;mayavi&#39; environment is supported.</span>
<span class="sd">        - `clr (1x3 tuple(int))`: This tuple represents the RGB values that the</span>
<span class="sd">            beam reference axis will be colored with.</span>
<span class="sd">        - `numXSects (int)`: This is the number of cross-sections that will be</span>
<span class="sd">            plotted and evenly distributed throughout the beam.</span>
<span class="sd">        - `contour (str)`: The contour to be plotted on the sampled cross</span>
<span class="sd">            sections.</span>
<span class="sd">        - `contLim (1x2 Array[float])`: The lower and upper limits for the</span>
<span class="sd">            contour color plot.</span>
<span class="sd">        - `warpScale (float)`: The visual multiplication factor to be applied</span>
<span class="sd">            to the cross-sectional warping displacement.</span>
<span class="sd">        - `displScale (float)`: The visual multiplication factor to be applied</span>
<span class="sd">            to the beam displacements and rotations.</span>
<span class="sd">        - `analysis_name (str)`: The analysis name corresponding to the results</span>
<span class="sd">            to pe visualized.</span>
<span class="sd">        - `mode (int)`: For modal analysis, this corresponds to the mode-shape</span>
<span class="sd">            which is desired to be plotted.</span>
<span class="sd">            </span>
<span class="sd">        :Returns:</span>
<span class="sd">        </span>
<span class="sd">        - `(figure)`: This method returns a 3D plot of the rigid wing section.</span>
<span class="sd">            </span>
<span class="sd">        .. Warning:: In order to limit the size of data stored in memory, the</span>
<span class="sd">            local cross-sectional data is not stored. As a result, for every</span>
<span class="sd">            additional cross-section that is plotted, the time required to plot</span>
<span class="sd">            will increase substantially.</span>
<span class="sd">            </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">figName</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s">&#39;figName&#39;</span><span class="p">,</span><span class="s">&#39;Figure&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">()</span><span class="o">*</span><span class="mi">100</span><span class="p">)))</span>
        <span class="c"># Select the plotting environment you&#39;d like to choose</span>
        <span class="n">environment</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s">&#39;environment&#39;</span><span class="p">,</span><span class="s">&#39;mayavi&#39;</span><span class="p">)</span>
        <span class="c"># Chose the color of the beam, defaults to black, accepts tuple</span>
        <span class="n">clr</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s">&#39;color&#39;</span><span class="p">,(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">))</span>
        <span class="c"># Chose the number of cross-sections to be plotted. By default this is 2</span>
        <span class="c"># One at the beggining and one at the end of the super beam</span>
        <span class="n">numXSects</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s">&#39;numXSects&#39;</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
        <span class="c"># Show a contour</span>
        <span class="n">contour</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s">&#39;contour&#39;</span><span class="p">,</span><span class="s">&#39;VonMis&#39;</span><span class="p">)</span>
        <span class="c"># Contour Limits</span>
        <span class="n">contLim</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s">&#39;contLim&#39;</span><span class="p">,[</span><span class="mf">0.</span><span class="p">,</span><span class="mf">1.</span><span class="p">])</span>
        <span class="c"># Establish the warping scaling factor</span>
        <span class="n">warpScale</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s">&#39;warpScale&#39;</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
        <span class="c"># Select Displacement Scale</span>
        <span class="n">displScale</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s">&#39;displScale&#39;</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
        <span class="c"># Analysis set name</span>
        <span class="n">analysis_name</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s">&#39;analysis_name&#39;</span><span class="p">,</span><span class="s">&#39;analysis_untitled&#39;</span><span class="p">)</span>
        <span class="c"># Determine what to plot</span>
        <span class="n">mode</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s">&#39;mode&#39;</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
        <span class="n">plots</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s">&#39;plots&#39;</span><span class="p">,[])</span>
        <span class="k">if</span> <span class="n">environment</span><span class="o">==</span><span class="s">&#39;mayavi&#39;</span><span class="p">:</span>
            <span class="n">mlab</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figure</span><span class="o">=</span><span class="n">figName</span><span class="p">)</span>
            <span class="c"># Plot the rigid Beam Axes:</span>
            <span class="k">for</span> <span class="n">sbeam</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">SuperBeams</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">EID</span><span class="p">,</span> <span class="n">elem</span> <span class="ow">in</span> <span class="n">sbeam</span><span class="o">.</span><span class="n">elems</span><span class="o">.</span><span class="n">iteritems</span><span class="p">():</span>
                    <span class="n">elem</span><span class="o">.</span><span class="n">plotDisplBeam</span><span class="p">(</span><span class="n">environment</span><span class="o">=</span><span class="n">environment</span><span class="p">,</span><span class="n">clr</span><span class="o">=</span><span class="n">clr</span><span class="p">,</span><span class="n">figName</span><span class="o">=</span><span class="n">figName</span><span class="p">,</span>\
                        <span class="n">displScale</span><span class="o">=</span><span class="n">displScale</span><span class="p">,</span><span class="n">analysis_name</span><span class="o">=</span><span class="n">analysis_name</span><span class="p">,</span><span class="n">mode</span><span class="o">=</span><span class="n">mode</span><span class="p">,</span>\
                        <span class="n">plots</span><span class="o">=</span><span class="n">plots</span><span class="p">)</span>
                <span class="n">x_nd</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">numXSects</span><span class="p">)</span>
                <span class="c"># For numXSects nodes evenly spaced in the beam</span>
                <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">numXSects</span><span class="p">):</span>
                    <span class="n">tmpEID</span><span class="p">,</span><span class="n">tmpx</span> <span class="o">=</span> <span class="n">sbeam</span><span class="o">.</span><span class="n">getEIDatx</span><span class="p">(</span><span class="n">x_nd</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
                    <span class="n">tmpElem</span> <span class="o">=</span> <span class="n">sbeam</span><span class="o">.</span><span class="n">elems</span><span class="p">[</span><span class="n">tmpEID</span><span class="p">]</span>
                    <span class="n">tmpElem</span><span class="o">.</span><span class="n">plotWarpedXSect</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">tmpx</span><span class="p">,</span><span class="n">figName</span><span class="o">=</span><span class="n">figName</span><span class="p">,</span><span class="n">contLim</span><span class="o">=</span><span class="n">contLim</span><span class="p">,</span>\
                        <span class="n">contour</span><span class="o">=</span><span class="n">contour</span><span class="p">,</span><span class="n">warpScale</span><span class="o">=</span><span class="n">warpScale</span><span class="p">,</span><span class="n">displScale</span><span class="o">=</span><span class="n">displScale</span><span class="p">,</span>\
                        <span class="n">analysis_name</span><span class="o">=</span><span class="n">analysis_name</span><span class="p">,</span><span class="n">mode</span><span class="o">=</span><span class="n">mode</span><span class="p">,</span><span class="n">plots</span><span class="o">=</span><span class="n">plots</span><span class="p">)</span>
                        <span class="c"># Test</span></div></div>
</pre></div>

          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../index.html">AeroComBAT 1.0 documentation</a> &raquo;</li>
          <li class="nav-item nav-item-1"><a href="../index.html" >Module code</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &copy; Copyright 2016, Ben Names.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.3.1.
    </div>
  </body>
</html>